[0m14:48:21.502007 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1055c8c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d23d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d23ed0>]}


============================== 14:48:21.504928 | 6a59d796-252e-47d4-b1a4-6ec8d4d9ef72 ==============================
[0m14:48:21.504928 [info ] [MainThread]: Running with dbt=1.8.8
[0m14:48:21.505326 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jandytenedora/.dbt', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/jandytenedora/Interview/python-interview-gpt-question/dbt/ecommerce_dbt/logs', 'warn_error': 'None', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'invocation_command': 'dbt test', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:48:21.507323 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'ecommerce_dbt'
[0m14:48:21.508339 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 0.044496458, "process_user_time": 0.723324, "process_kernel_time": 0.079484, "process_mem_max_rss": "96993280", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:48:21.508642 [debug] [MainThread]: Command `dbt test` failed at 14:48:21.508576 after 0.04 seconds
[0m14:48:21.508851 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107d423f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107a6b530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107ca8f30>]}
[0m14:48:21.509054 [debug] [MainThread]: Flushing usage events
[0m14:48:42.298721 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104cb0c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065b7d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065b7ed0>]}


============================== 14:48:42.301499 | e5fc14e3-09f3-4f86-8147-d2c6b27852de ==============================
[0m14:48:42.301499 [info ] [MainThread]: Running with dbt=1.8.8
[0m14:48:42.301873 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/jandytenedora/Interview/python-interview-gpt-question/dbt/ecommerce_dbt/logs', 'profiles_dir': '/Users/jandytenedora/.dbt', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m14:48:42.303808 [error] [MainThread]: Encountered an error:
Runtime Error
  Could not find profile named 'dev'
[0m14:48:42.304791 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 0.04263946, "process_user_time": 0.725862, "process_kernel_time": 0.077997, "process_mem_max_rss": "96419840", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:48:42.305088 [debug] [MainThread]: Command `dbt test` failed at 14:48:42.305027 after 0.04 seconds
[0m14:48:42.305300 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065d23f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106303530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10653cf30>]}
[0m14:48:42.305510 [debug] [MainThread]: Flushing usage events
[0m14:50:42.385277 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1030bcc20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049c7d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1049c7ed0>]}


============================== 14:50:42.388356 | f2204a4e-1a61-40ed-9e0d-b76cce9d8f55 ==============================
[0m14:50:42.388356 [info ] [MainThread]: Running with dbt=1.8.8
[0m14:50:42.388753 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jandytenedora/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/jandytenedora/Interview/python-interview-gpt-question/dbt/ecommerce_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt test', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:50:43.517808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'f2204a4e-1a61-40ed-9e0d-b76cce9d8f55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113fb15b0>]}
[0m14:50:43.548784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'f2204a4e-1a61-40ed-9e0d-b76cce9d8f55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113e79f20>]}
[0m14:50:43.549214 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m14:50:43.563752 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m14:50:43.564487 [info ] [MainThread]: Unable to do partial parsing because saved manifest not found. Starting full parse.
[0m14:50:43.564729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'f2204a4e-1a61-40ed-9e0d-b76cce9d8f55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x113e4f350>]}
[0m14:50:44.291043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'f2204a4e-1a61-40ed-9e0d-b76cce9d8f55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1149b97c0>]}
[0m14:50:44.357327 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'f2204a4e-1a61-40ed-9e0d-b76cce9d8f55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x115009010>]}
[0m14:50:44.357661 [info ] [MainThread]: Found 2 models, 4 data tests, 482 macros
[0m14:50:44.357868 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f2204a4e-1a61-40ed-9e0d-b76cce9d8f55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114cf7ee0>]}
[0m14:50:44.359009 [info ] [MainThread]: 
[0m14:50:44.359350 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:50:44.362093 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_terraform-tutorial-430708_dbt_tutorial'
[0m14:50:44.362344 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:50:45.129879 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'f2204a4e-1a61-40ed-9e0d-b76cce9d8f55', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114fe8a10>]}
[0m14:50:45.131284 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:50:45.132464 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:50:45.132993 [info ] [MainThread]: 
[0m14:50:45.137698 [debug] [Thread-1 (]: Began running node test.ecommerce_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m14:50:45.138254 [debug] [Thread-3 (]: Began running node test.ecommerce_dbt.unique_my_first_dbt_model_id.16e066b321
[0m14:50:45.138716 [debug] [Thread-4 (]: Began running node test.ecommerce_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m14:50:45.139138 [debug] [Thread-2 (]: Began running node test.ecommerce_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m14:50:45.139571 [info ] [Thread-1 (]: 1 of 4 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m14:50:45.140008 [info ] [Thread-3 (]: 3 of 4 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m14:50:45.140412 [info ] [Thread-4 (]: 4 of 4 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m14:50:45.140781 [info ] [Thread-2 (]: 2 of 4 START test not_null_my_second_dbt_model_id .............................. [RUN]
[0m14:50:45.141260 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_terraform-tutorial-430708_dbt_tutorial, now test.ecommerce_dbt.not_null_my_first_dbt_model_id.5fb22c2710)
[0m14:50:45.141743 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.ecommerce_dbt.unique_my_first_dbt_model_id.16e066b321'
[0m14:50:45.142166 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.ecommerce_dbt.unique_my_second_dbt_model_id.57a0f8c493'
[0m14:50:45.142534 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.ecommerce_dbt.not_null_my_second_dbt_model_id.151b76d778'
[0m14:50:45.142832 [debug] [Thread-1 (]: Began compiling node test.ecommerce_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m14:50:45.143121 [debug] [Thread-3 (]: Began compiling node test.ecommerce_dbt.unique_my_first_dbt_model_id.16e066b321
[0m14:50:45.143396 [debug] [Thread-4 (]: Began compiling node test.ecommerce_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m14:50:45.143884 [debug] [Thread-2 (]: Began compiling node test.ecommerce_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m14:50:45.161242 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m14:50:45.165768 [debug] [Thread-3 (]: Writing injected SQL for node "test.ecommerce_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m14:50:45.168713 [debug] [Thread-4 (]: Writing injected SQL for node "test.ecommerce_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m14:50:45.171085 [debug] [Thread-2 (]: Writing injected SQL for node "test.ecommerce_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m14:50:45.172140 [debug] [Thread-1 (]: Began executing node test.ecommerce_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m14:50:45.172397 [debug] [Thread-2 (]: Began executing node test.ecommerce_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m14:50:45.177857 [debug] [Thread-4 (]: Began executing node test.ecommerce_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m14:50:45.183805 [debug] [Thread-3 (]: Began executing node test.ecommerce_dbt.unique_my_first_dbt_model_id.16e066b321
[0m14:50:45.186663 [debug] [Thread-2 (]: Writing runtime sql for node "test.ecommerce_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m14:50:45.187475 [debug] [Thread-1 (]: Writing runtime sql for node "test.ecommerce_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m14:50:45.188676 [debug] [Thread-4 (]: Writing runtime sql for node "test.ecommerce_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m14:50:45.190001 [debug] [Thread-3 (]: Writing runtime sql for node "test.ecommerce_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m14:50:45.190987 [debug] [Thread-1 (]: On test.ecommerce_dbt.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "test.ecommerce_dbt.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from `terraform-tutorial-430708`.`dbt_tutorial`.`my_first_dbt_model`
where id is null



      
    ) dbt_internal_test
[0m14:50:45.191312 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:50:45.191571 [debug] [Thread-2 (]: On test.ecommerce_dbt.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "test.ecommerce_dbt.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from `terraform-tutorial-430708`.`dbt_tutorial`.`my_second_dbt_model`
where id is null



      
    ) dbt_internal_test
[0m14:50:45.191844 [debug] [Thread-4 (]: On test.ecommerce_dbt.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "test.ecommerce_dbt.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `terraform-tutorial-430708`.`dbt_tutorial`.`my_second_dbt_model`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m14:50:45.192726 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:50:45.193019 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:50:45.193473 [debug] [Thread-3 (]: On test.ecommerce_dbt.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "test.ecommerce_dbt.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `terraform-tutorial-430708`.`dbt_tutorial`.`my_first_dbt_model`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m14:50:45.194476 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:50:45.832308 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=terraform-tutorial-430708&j=bq:EU:75ff632e-4d8e-423a-89c1-c57a467b5b63&page=queryresults
[0m14:50:45.895311 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=terraform-tutorial-430708&j=bq:EU:85b5258d-8f23-4e75-aa45-5225801bcd25&page=queryresults
[0m14:50:45.940896 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=terraform-tutorial-430708&j=bq:EU:371b4f6f-9bb7-42d8-a1c1-db591517dea4&page=queryresults
[0m14:50:46.053048 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=terraform-tutorial-430708&j=bq:EU:1fd08bfc-7f8e-4701-8101-5381db39f12e&page=queryresults
[0m14:50:46.310967 [info ] [Thread-3 (]: 3 of 4 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 1.17s]
[0m14:50:46.311467 [error] [Thread-1 (]: 1 of 4 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 1.17s]
[0m14:50:46.311876 [debug] [Thread-3 (]: Finished running node test.ecommerce_dbt.unique_my_first_dbt_model_id.16e066b321
[0m14:50:46.312217 [debug] [Thread-1 (]: Finished running node test.ecommerce_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m14:50:46.351196 [info ] [Thread-2 (]: 2 of 4 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 1.21s]
[0m14:50:46.352004 [debug] [Thread-2 (]: Finished running node test.ecommerce_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m14:50:46.452620 [info ] [Thread-4 (]: 4 of 4 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 1.31s]
[0m14:50:46.453681 [debug] [Thread-4 (]: Finished running node test.ecommerce_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m14:50:46.455666 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:50:46.456445 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:50:46.456838 [debug] [MainThread]: Connection 'test.ecommerce_dbt.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m14:50:46.457182 [debug] [MainThread]: Connection 'test.ecommerce_dbt.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m14:50:46.457492 [debug] [MainThread]: Connection 'test.ecommerce_dbt.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m14:50:46.457797 [debug] [MainThread]: Connection 'test.ecommerce_dbt.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
[0m14:50:46.458187 [info ] [MainThread]: 
[0m14:50:46.458524 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 2.10 seconds (2.10s).
[0m14:50:46.459627 [debug] [MainThread]: Command end result
[0m14:50:46.486665 [info ] [MainThread]: 
[0m14:50:46.487009 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:50:46.487200 [info ] [MainThread]: 
[0m14:50:46.487444 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
[0m14:50:46.487656 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m14:50:46.487812 [info ] [MainThread]: 
[0m14:50:46.488012 [info ] [MainThread]:   compiled code at target/compiled/ecommerce_dbt/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
[0m14:50:46.488175 [info ] [MainThread]: 
[0m14:50:46.488363 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m14:50:46.490760 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 4.1449723, "process_user_time": 2.143037, "process_kernel_time": 0.299335, "process_mem_max_rss": "212566016", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:50:46.491145 [debug] [MainThread]: Command `dbt test` failed at 14:50:46.491073 after 4.15 seconds
[0m14:50:46.491427 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x114fbf1d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1150479d0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1150472f0>]}
[0m14:50:46.491667 [debug] [MainThread]: Flushing usage events
[0m14:55:03.433630 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106e84c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10878fd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10878fed0>]}


============================== 14:55:03.437256 | b536ad70-68b6-448a-82cb-73c6bb55420b ==============================
[0m14:55:03.437256 [info ] [MainThread]: Running with dbt=1.8.8
[0m14:55:03.437729 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/jandytenedora/Interview/python-interview-gpt-question/dbt/ecommerce_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/jandytenedora/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'invocation_command': 'dbt test', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:55:04.235647 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b536ad70-68b6-448a-82cb-73c6bb55420b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1186b15b0>]}
[0m14:55:04.266136 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b536ad70-68b6-448a-82cb-73c6bb55420b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118579f20>]}
[0m14:55:04.266532 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m14:55:04.280757 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m14:55:04.360110 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:55:04.360574 [debug] [MainThread]: Partial parsing: updated file: ecommerce_dbt://models/example/my_first_dbt_model.sql
[0m14:55:04.574501 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b536ad70-68b6-448a-82cb-73c6bb55420b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1187afa50>]}
[0m14:55:04.640189 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b536ad70-68b6-448a-82cb-73c6bb55420b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118bbf4d0>]}
[0m14:55:04.640536 [info ] [MainThread]: Found 2 models, 4 data tests, 482 macros
[0m14:55:04.640742 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b536ad70-68b6-448a-82cb-73c6bb55420b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118c952b0>]}
[0m14:55:04.641927 [info ] [MainThread]: 
[0m14:55:04.642285 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:55:04.644629 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_terraform-tutorial-430708_dbt_tutorial'
[0m14:55:04.644865 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:55:05.443010 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b536ad70-68b6-448a-82cb-73c6bb55420b', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118a30e20>]}
[0m14:55:05.444273 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:55:05.445214 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:55:05.445712 [info ] [MainThread]: 
[0m14:55:05.450360 [debug] [Thread-3 (]: Began running node test.ecommerce_dbt.unique_my_first_dbt_model_id.16e066b321
[0m14:55:05.451084 [debug] [Thread-4 (]: Began running node test.ecommerce_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m14:55:05.451592 [debug] [Thread-1 (]: Began running node test.ecommerce_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m14:55:05.451985 [debug] [Thread-2 (]: Began running node test.ecommerce_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m14:55:05.452430 [info ] [Thread-3 (]: 3 of 4 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m14:55:05.452875 [info ] [Thread-4 (]: 4 of 4 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m14:55:05.453261 [info ] [Thread-1 (]: 1 of 4 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m14:55:05.453609 [info ] [Thread-2 (]: 2 of 4 START test not_null_my_second_dbt_model_id .............................. [RUN]
[0m14:55:05.454117 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.ecommerce_dbt.unique_my_first_dbt_model_id.16e066b321'
[0m14:55:05.454518 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.ecommerce_dbt.unique_my_second_dbt_model_id.57a0f8c493'
[0m14:55:05.454868 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_terraform-tutorial-430708_dbt_tutorial, now test.ecommerce_dbt.not_null_my_first_dbt_model_id.5fb22c2710)
[0m14:55:05.455244 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.ecommerce_dbt.not_null_my_second_dbt_model_id.151b76d778'
[0m14:55:05.455552 [debug] [Thread-3 (]: Began compiling node test.ecommerce_dbt.unique_my_first_dbt_model_id.16e066b321
[0m14:55:05.455838 [debug] [Thread-4 (]: Began compiling node test.ecommerce_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m14:55:05.456112 [debug] [Thread-1 (]: Began compiling node test.ecommerce_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m14:55:05.456380 [debug] [Thread-2 (]: Began compiling node test.ecommerce_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m14:55:05.472941 [debug] [Thread-3 (]: Writing injected SQL for node "test.ecommerce_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m14:55:05.473579 [debug] [Thread-4 (]: Writing injected SQL for node "test.ecommerce_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m14:55:05.480125 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m14:55:05.482965 [debug] [Thread-2 (]: Writing injected SQL for node "test.ecommerce_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m14:55:05.483578 [debug] [Thread-3 (]: Began executing node test.ecommerce_dbt.unique_my_first_dbt_model_id.16e066b321
[0m14:55:05.490401 [debug] [Thread-4 (]: Began executing node test.ecommerce_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m14:55:05.500656 [debug] [Thread-3 (]: Writing runtime sql for node "test.ecommerce_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m14:55:05.500961 [debug] [Thread-1 (]: Began executing node test.ecommerce_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m14:55:05.503028 [debug] [Thread-4 (]: Writing runtime sql for node "test.ecommerce_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m14:55:05.504240 [debug] [Thread-1 (]: Writing runtime sql for node "test.ecommerce_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m14:55:05.504560 [debug] [Thread-2 (]: Began executing node test.ecommerce_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m14:55:05.504843 [debug] [Thread-3 (]: On test.ecommerce_dbt.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "test.ecommerce_dbt.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `terraform-tutorial-430708`.`dbt_tutorial`.`my_first_dbt_model`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m14:55:05.506464 [debug] [Thread-2 (]: Writing runtime sql for node "test.ecommerce_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m14:55:05.506899 [debug] [Thread-4 (]: On test.ecommerce_dbt.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "test.ecommerce_dbt.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `terraform-tutorial-430708`.`dbt_tutorial`.`my_second_dbt_model`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m14:55:05.507178 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:55:05.507519 [debug] [Thread-1 (]: On test.ecommerce_dbt.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "test.ecommerce_dbt.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from `terraform-tutorial-430708`.`dbt_tutorial`.`my_first_dbt_model`
where id is null



      
    ) dbt_internal_test
[0m14:55:05.507815 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:55:05.508723 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:05.508974 [debug] [Thread-2 (]: On test.ecommerce_dbt.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "test.ecommerce_dbt.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from `terraform-tutorial-430708`.`dbt_tutorial`.`my_second_dbt_model`
where id is null



      
    ) dbt_internal_test
[0m14:55:05.510360 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:55:05.955735 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=terraform-tutorial-430708&j=bq:EU:370b9322-6ba2-490b-9796-8e1a495c7c2c&page=queryresults
[0m14:55:05.958237 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=terraform-tutorial-430708&j=bq:EU:34517701-b6a8-4854-9476-9671a745eeba&page=queryresults
[0m14:55:06.158921 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=terraform-tutorial-430708&j=bq:EU:ae7a5d51-e931-4639-9099-e50126b5df62&page=queryresults
[0m14:55:06.162118 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=terraform-tutorial-430708&j=bq:EU:e5b2f1d3-ce42-431d-9dd4-177515957b36&page=queryresults
[0m14:55:06.379525 [info ] [Thread-3 (]: 3 of 4 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 0.93s]
[0m14:55:06.380359 [debug] [Thread-3 (]: Finished running node test.ecommerce_dbt.unique_my_first_dbt_model_id.16e066b321
[0m14:55:06.435778 [error] [Thread-1 (]: 1 of 4 FAIL 1 not_null_my_first_dbt_model_id ................................... [[31mFAIL 1[0m in 0.98s]
[0m14:55:06.437450 [debug] [Thread-1 (]: Finished running node test.ecommerce_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m14:55:06.534264 [info ] [Thread-4 (]: 4 of 4 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 1.08s]
[0m14:55:06.535223 [debug] [Thread-4 (]: Finished running node test.ecommerce_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m14:55:06.544799 [info ] [Thread-2 (]: 2 of 4 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 1.09s]
[0m14:55:06.545544 [debug] [Thread-2 (]: Finished running node test.ecommerce_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m14:55:06.547293 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:55:06.548028 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:55:06.548391 [debug] [MainThread]: Connection 'test.ecommerce_dbt.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m14:55:06.548719 [debug] [MainThread]: Connection 'test.ecommerce_dbt.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m14:55:06.549029 [debug] [MainThread]: Connection 'test.ecommerce_dbt.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m14:55:06.549352 [debug] [MainThread]: Connection 'test.ecommerce_dbt.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
[0m14:55:06.549670 [info ] [MainThread]: 
[0m14:55:06.549998 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 1.91 seconds (1.91s).
[0m14:55:06.551089 [debug] [MainThread]: Command end result
[0m14:55:06.578467 [info ] [MainThread]: 
[0m14:55:06.578826 [info ] [MainThread]: [31mCompleted with 1 error and 0 warnings:[0m
[0m14:55:06.579018 [info ] [MainThread]: 
[0m14:55:06.579260 [error] [MainThread]: [31mFailure in test not_null_my_first_dbt_model_id (models/example/schema.yml)[0m
[0m14:55:06.579478 [error] [MainThread]:   Got 1 result, configured to fail if != 0
[0m14:55:06.579636 [info ] [MainThread]: 
[0m14:55:06.579831 [info ] [MainThread]:   compiled code at target/compiled/ecommerce_dbt/models/example/schema.yml/not_null_my_first_dbt_model_id.sql
[0m14:55:06.580004 [info ] [MainThread]: 
[0m14:55:06.580198 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=1 SKIP=0 TOTAL=4
[0m14:55:06.582687 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 3.1919298, "process_user_time": 1.726857, "process_kernel_time": 0.307269, "process_mem_max_rss": "212189184", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:55:06.583044 [debug] [MainThread]: Command `dbt test` failed at 14:55:06.582974 after 3.19 seconds
[0m14:55:06.583325 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086c1190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a111230>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11a111390>]}
[0m14:55:06.583553 [debug] [MainThread]: Flushing usage events
[0m14:55:22.867228 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10717cc20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fe7d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108fe7ed0>]}


============================== 14:55:22.870004 | d4fdb3d6-a74c-4a5e-9b4f-400612469b67 ==============================
[0m14:55:22.870004 [info ] [MainThread]: Running with dbt=1.8.8
[0m14:55:22.870406 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jandytenedora/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/jandytenedora/Interview/python-interview-gpt-question/dbt/ecommerce_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'introspect': 'True', 'log_format': 'default', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:55:23.445686 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd4fdb3d6-a74c-4a5e-9b4f-400612469b67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118dad5b0>]}
[0m14:55:23.476751 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd4fdb3d6-a74c-4a5e-9b4f-400612469b67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118c79f20>]}
[0m14:55:23.477169 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m14:55:23.491099 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m14:55:23.570924 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m14:55:23.571505 [debug] [MainThread]: Partial parsing: updated file: ecommerce_dbt://models/example/my_first_dbt_model.sql
[0m14:55:23.783962 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd4fdb3d6-a74c-4a5e-9b4f-400612469b67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118faba50>]}
[0m14:55:23.839640 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd4fdb3d6-a74c-4a5e-9b4f-400612469b67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1192686e0>]}
[0m14:55:23.839969 [info ] [MainThread]: Found 2 models, 4 data tests, 482 macros
[0m14:55:23.840181 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd4fdb3d6-a74c-4a5e-9b4f-400612469b67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119569a90>]}
[0m14:55:23.841312 [info ] [MainThread]: 
[0m14:55:23.841660 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:55:23.844000 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_terraform-tutorial-430708'
[0m14:55:23.844240 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:55:24.873838 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_terraform-tutorial-430708, now list_terraform-tutorial-430708_dbt_tutorial)
[0m14:55:24.874896 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m14:55:25.010204 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd4fdb3d6-a74c-4a5e-9b4f-400612469b67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11946f380>]}
[0m14:55:25.011163 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:55:25.012083 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:55:25.012561 [info ] [MainThread]: 
[0m14:55:25.016763 [debug] [Thread-1 (]: Began running node model.ecommerce_dbt.my_first_dbt_model
[0m14:55:25.017366 [info ] [Thread-1 (]: 1 of 2 START sql table model dbt_tutorial.my_first_dbt_model ................... [RUN]
[0m14:55:25.017852 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_terraform-tutorial-430708_dbt_tutorial, now model.ecommerce_dbt.my_first_dbt_model)
[0m14:55:25.018235 [debug] [Thread-1 (]: Began compiling node model.ecommerce_dbt.my_first_dbt_model
[0m14:55:25.032611 [debug] [Thread-1 (]: Writing injected SQL for node "model.ecommerce_dbt.my_first_dbt_model"
[0m14:55:25.033959 [debug] [Thread-1 (]: Began executing node model.ecommerce_dbt.my_first_dbt_model
[0m14:55:25.045865 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:25.237953 [debug] [Thread-1 (]: Writing runtime sql for node "model.ecommerce_dbt.my_first_dbt_model"
[0m14:55:25.239037 [debug] [Thread-1 (]: On model.ecommerce_dbt.my_first_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.my_first_dbt_model"} */

  
    

    create or replace table `terraform-tutorial-430708`.`dbt_tutorial`.`my_first_dbt_model`
      
    
    

    OPTIONS()
    as (
      /*
    Welcome to your first dbt model!
    Did you know that you can also configure models directly within SQL files?
    This will override configurations stated in dbt_project.yml

    Try changing "table" to "view" below
*/



with source_data as (

    select 1 as id
    union all
    select null as id

)

select *
from source_data
where id is not null
    );
  
[0m14:55:25.648180 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=terraform-tutorial-430708&j=bq:EU:bd84cf90-f73c-4868-bfa7-65a793a0c9f1&page=queryresults
[0m14:55:28.325507 [debug] [Thread-1 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4fdb3d6-a74c-4a5e-9b4f-400612469b67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119553650>]}
[0m14:55:28.326291 [info ] [Thread-1 (]: 1 of 2 OK created sql table model dbt_tutorial.my_first_dbt_model .............. [[32mCREATE TABLE (1.0 rows, 0 processed)[0m in 3.31s]
[0m14:55:28.326842 [debug] [Thread-1 (]: Finished running node model.ecommerce_dbt.my_first_dbt_model
[0m14:55:28.327511 [debug] [Thread-2 (]: Began running node model.ecommerce_dbt.my_second_dbt_model
[0m14:55:28.328007 [info ] [Thread-2 (]: 2 of 2 START sql view model dbt_tutorial.my_second_dbt_model ................... [RUN]
[0m14:55:28.328450 [debug] [Thread-2 (]: Acquiring new bigquery connection 'model.ecommerce_dbt.my_second_dbt_model'
[0m14:55:28.328730 [debug] [Thread-2 (]: Began compiling node model.ecommerce_dbt.my_second_dbt_model
[0m14:55:28.330932 [debug] [Thread-2 (]: Writing injected SQL for node "model.ecommerce_dbt.my_second_dbt_model"
[0m14:55:28.331640 [debug] [Thread-2 (]: Began executing node model.ecommerce_dbt.my_second_dbt_model
[0m14:55:28.345622 [debug] [Thread-2 (]: Writing runtime sql for node "model.ecommerce_dbt.my_second_dbt_model"
[0m14:55:28.346225 [debug] [Thread-2 (]: On model.ecommerce_dbt.my_second_dbt_model: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.my_second_dbt_model"} */


  create or replace view `terraform-tutorial-430708`.`dbt_tutorial`.`my_second_dbt_model`
  OPTIONS()
  as -- Use the `ref` function to select from other models

select *
from `terraform-tutorial-430708`.`dbt_tutorial`.`my_first_dbt_model`
where id = 1;


[0m14:55:28.346475 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:55:28.784841 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=terraform-tutorial-430708&j=bq:EU:4315dbe5-d305-4afb-bc8d-b26d2e8afaff&page=queryresults
[0m14:55:29.124524 [debug] [Thread-2 (]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd4fdb3d6-a74c-4a5e-9b4f-400612469b67', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1195ed4f0>]}
[0m14:55:29.125525 [info ] [Thread-2 (]: 2 of 2 OK created sql view model dbt_tutorial.my_second_dbt_model .............. [[32mCREATE VIEW (0 processed)[0m in 0.80s]
[0m14:55:29.126360 [debug] [Thread-2 (]: Finished running node model.ecommerce_dbt.my_second_dbt_model
[0m14:55:29.128136 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:55:29.128882 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:55:29.129191 [debug] [MainThread]: Connection 'model.ecommerce_dbt.my_first_dbt_model' was properly closed.
[0m14:55:29.129488 [debug] [MainThread]: Connection 'model.ecommerce_dbt.my_second_dbt_model' was properly closed.
[0m14:55:29.129809 [info ] [MainThread]: 
[0m14:55:29.130144 [info ] [MainThread]: Finished running 1 table model, 1 view model in 0 hours 0 minutes and 5.29 seconds (5.29s).
[0m14:55:29.131010 [debug] [MainThread]: Command end result
[0m14:55:29.158636 [info ] [MainThread]: 
[0m14:55:29.159092 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:55:29.159371 [info ] [MainThread]: 
[0m14:55:29.159627 [info ] [MainThread]: Done. PASS=2 WARN=0 ERROR=0 SKIP=0 TOTAL=2
[0m14:55:29.162162 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.3308005, "process_user_time": 1.735659, "process_kernel_time": 0.237218, "process_mem_max_rss": "211369984", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:55:29.162478 [debug] [MainThread]: Command `dbt run` succeeded at 14:55:29.162418 after 6.33 seconds
[0m14:55:29.162747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11951b930>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1195af530>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118d84f50>]}
[0m14:55:29.163003 [debug] [MainThread]: Flushing usage events
[0m14:55:33.253176 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105fc8c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088e7d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088e7ed0>]}


============================== 14:55:33.255975 | dc24165c-2347-41c8-9e95-f2444fa7681d ==============================
[0m14:55:33.255975 [info ] [MainThread]: Running with dbt=1.8.8
[0m14:55:33.256353 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jandytenedora/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/jandytenedora/Interview/python-interview-gpt-question/dbt/ecommerce_dbt/logs', 'version_check': 'True', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m14:55:33.790550 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'dc24165c-2347-41c8-9e95-f2444fa7681d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1192b15b0>]}
[0m14:55:33.821386 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'dc24165c-2347-41c8-9e95-f2444fa7681d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119179f20>]}
[0m14:55:33.821815 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m14:55:33.833769 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m14:55:33.902852 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m14:55:33.903234 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m14:55:33.925729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'dc24165c-2347-41c8-9e95-f2444fa7681d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11914f950>]}
[0m14:55:33.990162 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'dc24165c-2347-41c8-9e95-f2444fa7681d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1195b2f30>]}
[0m14:55:33.990546 [info ] [MainThread]: Found 2 models, 4 data tests, 482 macros
[0m14:55:33.990784 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc24165c-2347-41c8-9e95-f2444fa7681d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119576430>]}
[0m14:55:33.991976 [info ] [MainThread]: 
[0m14:55:33.992355 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m14:55:33.994735 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_terraform-tutorial-430708_dbt_tutorial'
[0m14:55:33.994985 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m14:55:34.621249 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'dc24165c-2347-41c8-9e95-f2444fa7681d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119724ae0>]}
[0m14:55:34.622135 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:55:34.622904 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m14:55:34.623342 [info ] [MainThread]: 
[0m14:55:34.626487 [debug] [Thread-2 (]: Began running node test.ecommerce_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m14:55:34.627000 [debug] [Thread-3 (]: Began running node test.ecommerce_dbt.unique_my_first_dbt_model_id.16e066b321
[0m14:55:34.627486 [debug] [Thread-4 (]: Began running node test.ecommerce_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m14:55:34.627937 [info ] [Thread-2 (]: 2 of 4 START test not_null_my_second_dbt_model_id .............................. [RUN]
[0m14:55:34.628491 [debug] [Thread-1 (]: Began running node test.ecommerce_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m14:55:34.629041 [info ] [Thread-3 (]: 3 of 4 START test unique_my_first_dbt_model_id ................................. [RUN]
[0m14:55:34.629527 [info ] [Thread-4 (]: 4 of 4 START test unique_my_second_dbt_model_id ................................ [RUN]
[0m14:55:34.630155 [debug] [Thread-2 (]: Acquiring new bigquery connection 'test.ecommerce_dbt.not_null_my_second_dbt_model_id.151b76d778'
[0m14:55:34.630581 [info ] [Thread-1 (]: 1 of 4 START test not_null_my_first_dbt_model_id ............................... [RUN]
[0m14:55:34.631082 [debug] [Thread-3 (]: Acquiring new bigquery connection 'test.ecommerce_dbt.unique_my_first_dbt_model_id.16e066b321'
[0m14:55:34.631551 [debug] [Thread-4 (]: Acquiring new bigquery connection 'test.ecommerce_dbt.unique_my_second_dbt_model_id.57a0f8c493'
[0m14:55:34.631918 [debug] [Thread-2 (]: Began compiling node test.ecommerce_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m14:55:34.632307 [debug] [Thread-1 (]: Re-using an available connection from the pool (formerly list_terraform-tutorial-430708_dbt_tutorial, now test.ecommerce_dbt.not_null_my_first_dbt_model_id.5fb22c2710)
[0m14:55:34.632669 [debug] [Thread-3 (]: Began compiling node test.ecommerce_dbt.unique_my_first_dbt_model_id.16e066b321
[0m14:55:34.632990 [debug] [Thread-4 (]: Began compiling node test.ecommerce_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m14:55:34.647540 [debug] [Thread-1 (]: Began compiling node test.ecommerce_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m14:55:34.652941 [debug] [Thread-2 (]: Writing injected SQL for node "test.ecommerce_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m14:55:34.657453 [debug] [Thread-3 (]: Writing injected SQL for node "test.ecommerce_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m14:55:34.659792 [debug] [Thread-4 (]: Writing injected SQL for node "test.ecommerce_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m14:55:34.662427 [debug] [Thread-1 (]: Writing injected SQL for node "test.ecommerce_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m14:55:34.663202 [debug] [Thread-3 (]: Began executing node test.ecommerce_dbt.unique_my_first_dbt_model_id.16e066b321
[0m14:55:34.663505 [debug] [Thread-2 (]: Began executing node test.ecommerce_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m14:55:34.663736 [debug] [Thread-4 (]: Began executing node test.ecommerce_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m14:55:34.671029 [debug] [Thread-1 (]: Began executing node test.ecommerce_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m14:55:34.676685 [debug] [Thread-3 (]: Writing runtime sql for node "test.ecommerce_dbt.unique_my_first_dbt_model_id.16e066b321"
[0m14:55:34.678009 [debug] [Thread-2 (]: Writing runtime sql for node "test.ecommerce_dbt.not_null_my_second_dbt_model_id.151b76d778"
[0m14:55:34.679159 [debug] [Thread-4 (]: Writing runtime sql for node "test.ecommerce_dbt.unique_my_second_dbt_model_id.57a0f8c493"
[0m14:55:34.680453 [debug] [Thread-1 (]: Writing runtime sql for node "test.ecommerce_dbt.not_null_my_first_dbt_model_id.5fb22c2710"
[0m14:55:34.681076 [debug] [Thread-2 (]: On test.ecommerce_dbt.not_null_my_second_dbt_model_id.151b76d778: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "test.ecommerce_dbt.not_null_my_second_dbt_model_id.151b76d778"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from `terraform-tutorial-430708`.`dbt_tutorial`.`my_second_dbt_model`
where id is null



      
    ) dbt_internal_test
[0m14:55:34.681386 [debug] [Thread-3 (]: On test.ecommerce_dbt.unique_my_first_dbt_model_id.16e066b321: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "test.ecommerce_dbt.unique_my_first_dbt_model_id.16e066b321"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `terraform-tutorial-430708`.`dbt_tutorial`.`my_first_dbt_model`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m14:55:34.681665 [debug] [Thread-4 (]: On test.ecommerce_dbt.unique_my_second_dbt_model_id.57a0f8c493: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "test.ecommerce_dbt.unique_my_second_dbt_model_id.57a0f8c493"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    

with dbt_test__target as (

  select id as unique_field
  from `terraform-tutorial-430708`.`dbt_tutorial`.`my_second_dbt_model`
  where id is not null

)

select
    unique_field,
    count(*) as n_records

from dbt_test__target
group by unique_field
having count(*) > 1



      
    ) dbt_internal_test
[0m14:55:34.681933 [debug] [Thread-1 (]: On test.ecommerce_dbt.not_null_my_first_dbt_model_id.5fb22c2710: /* {"app": "dbt", "dbt_version": "1.8.8", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "test.ecommerce_dbt.not_null_my_first_dbt_model_id.5fb22c2710"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select id
from `terraform-tutorial-430708`.`dbt_tutorial`.`my_first_dbt_model`
where id is null



      
    ) dbt_internal_test
[0m14:55:34.682152 [debug] [Thread-2 (]: Opening a new connection, currently in state init
[0m14:55:34.682359 [debug] [Thread-3 (]: Opening a new connection, currently in state init
[0m14:55:34.682561 [debug] [Thread-4 (]: Opening a new connection, currently in state init
[0m14:55:34.682765 [debug] [Thread-1 (]: Opening a new connection, currently in state closed
[0m14:55:35.180077 [debug] [Thread-1 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=terraform-tutorial-430708&j=bq:EU:eaf0aedd-c209-4ddb-9d1c-7b2437bbd16d&page=queryresults
[0m14:55:35.370281 [debug] [Thread-3 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=terraform-tutorial-430708&j=bq:EU:81d4c06e-0768-48de-8668-e55442afc608&page=queryresults
[0m14:55:35.470331 [debug] [Thread-2 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=terraform-tutorial-430708&j=bq:EU:23385581-6db2-4fb7-b8d9-f5bd2f5a6cf7&page=queryresults
[0m14:55:35.483828 [debug] [Thread-4 (]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=terraform-tutorial-430708&j=bq:EU:f7a4d7d1-1bdc-4d7c-b65e-90030ef29774&page=queryresults
[0m14:55:35.597405 [info ] [Thread-1 (]: 1 of 4 PASS not_null_my_first_dbt_model_id ..................................... [[32mPASS[0m in 0.96s]
[0m14:55:35.598594 [debug] [Thread-1 (]: Finished running node test.ecommerce_dbt.not_null_my_first_dbt_model_id.5fb22c2710
[0m14:55:35.783610 [info ] [Thread-3 (]: 3 of 4 PASS unique_my_first_dbt_model_id ....................................... [[32mPASS[0m in 1.15s]
[0m14:55:35.784611 [debug] [Thread-3 (]: Finished running node test.ecommerce_dbt.unique_my_first_dbt_model_id.16e066b321
[0m14:55:35.842342 [info ] [Thread-2 (]: 2 of 4 PASS not_null_my_second_dbt_model_id .................................... [[32mPASS[0m in 1.21s]
[0m14:55:35.843245 [debug] [Thread-2 (]: Finished running node test.ecommerce_dbt.not_null_my_second_dbt_model_id.151b76d778
[0m14:55:35.853469 [info ] [Thread-4 (]: 4 of 4 PASS unique_my_second_dbt_model_id ...................................... [[32mPASS[0m in 1.22s]
[0m14:55:35.854123 [debug] [Thread-4 (]: Finished running node test.ecommerce_dbt.unique_my_second_dbt_model_id.57a0f8c493
[0m14:55:35.855738 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m14:55:35.856346 [debug] [MainThread]: Connection 'master' was properly closed.
[0m14:55:35.856647 [debug] [MainThread]: Connection 'test.ecommerce_dbt.not_null_my_first_dbt_model_id.5fb22c2710' was properly closed.
[0m14:55:35.856916 [debug] [MainThread]: Connection 'test.ecommerce_dbt.not_null_my_second_dbt_model_id.151b76d778' was properly closed.
[0m14:55:35.857166 [debug] [MainThread]: Connection 'test.ecommerce_dbt.unique_my_first_dbt_model_id.16e066b321' was properly closed.
[0m14:55:35.857422 [debug] [MainThread]: Connection 'test.ecommerce_dbt.unique_my_second_dbt_model_id.57a0f8c493' was properly closed.
[0m14:55:35.857726 [info ] [MainThread]: 
[0m14:55:35.858045 [info ] [MainThread]: Finished running 4 data tests in 0 hours 0 minutes and 1.87 seconds (1.87s).
[0m14:55:35.859138 [debug] [MainThread]: Command end result
[0m14:55:35.883547 [info ] [MainThread]: 
[0m14:55:35.883886 [info ] [MainThread]: [32mCompleted successfully[0m
[0m14:55:35.884087 [info ] [MainThread]: 
[0m14:55:35.884288 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=0 SKIP=0 TOTAL=4
[0m14:55:35.885828 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.6713684, "process_user_time": 1.514725, "process_kernel_time": 0.21768, "process_mem_max_rss": "208912384", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:55:35.886126 [debug] [MainThread]: Command `dbt test` succeeded at 14:55:35.886066 after 2.67 seconds
[0m14:55:35.886366 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108815190>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1196dbe30>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1196dbd80>]}
[0m14:55:35.886579 [debug] [MainThread]: Flushing usage events
[0m14:58:21.938307 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104498c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10621fd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10621fed0>]}


============================== 14:58:21.941442 | 0586dc14-a667-424e-be81-0ee4d9b5b605 ==============================
[0m14:58:21.941442 [info ] [MainThread]: Running with dbt=1.8.8
[0m14:58:21.941831 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/jandytenedora/.dbt', 'log_path': '/Users/jandytenedora/Interview/python-interview-gpt-question/dbt/ecommerce_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'invocation_command': 'dbt debug', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m14:58:21.951776 [info ] [MainThread]: dbt version: 1.8.8
[0m14:58:21.952040 [info ] [MainThread]: python version: 3.13.1
[0m14:58:21.952208 [info ] [MainThread]: python path: /Users/jandytenedora/Interview/python-interview-gpt-question/gpt_question/bin/python3.13
[0m14:58:21.952370 [info ] [MainThread]: os info: macOS-14.7.1-arm64-arm-64bit-Mach-O
[0m14:58:22.434328 [info ] [MainThread]: Using profiles dir at /Users/jandytenedora/.dbt
[0m14:58:22.434667 [info ] [MainThread]: Using profiles.yml file at /Users/jandytenedora/.dbt/profiles.yml
[0m14:58:22.434862 [info ] [MainThread]: Using dbt_project.yml file at /Users/jandytenedora/Interview/python-interview-gpt-question/dbt/ecommerce_dbt/dbt_project.yml
[0m14:58:22.435030 [info ] [MainThread]: adapter type: bigquery
[0m14:58:22.435190 [info ] [MainThread]: adapter version: 1.9.1
[0m14:58:22.486366 [info ] [MainThread]: Configuration:
[0m14:58:22.486701 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:58:22.486872 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:58:22.487030 [info ] [MainThread]: Required dependencies:
[0m14:58:22.487253 [debug] [MainThread]: Executing "git --help"
[0m14:58:22.508125 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:58:22.508815 [debug] [MainThread]: STDERR: "b''"
[0m14:58:22.509056 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:58:22.509255 [info ] [MainThread]: Connection:
[0m14:58:22.509468 [info ] [MainThread]:   method: oauth
[0m14:58:22.509625 [info ] [MainThread]:   database: terraform-tutorial-430708
[0m14:58:22.509783 [info ] [MainThread]:   execution_project: terraform-tutorial-430708
[0m14:58:22.509924 [info ] [MainThread]:   schema: dbt_tutorial
[0m14:58:22.510062 [info ] [MainThread]:   location: EU
[0m14:58:22.510199 [info ] [MainThread]:   priority: None
[0m14:58:22.510338 [info ] [MainThread]:   maximum_bytes_billed: None
[0m14:58:22.510472 [info ] [MainThread]:   impersonate_service_account: None
[0m14:58:22.510606 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m14:58:22.510743 [info ] [MainThread]:   job_retries: 1
[0m14:58:22.510875 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m14:58:22.511032 [info ] [MainThread]:   job_execution_timeout_seconds: None
[0m14:58:22.511164 [info ] [MainThread]:   timeout_seconds: None
[0m14:58:22.511297 [info ] [MainThread]:   client_id: None
[0m14:58:22.511427 [info ] [MainThread]:   token_uri: None
[0m14:58:22.511560 [info ] [MainThread]:   dataproc_region: None
[0m14:58:22.511696 [info ] [MainThread]:   dataproc_cluster_name: None
[0m14:58:22.511832 [info ] [MainThread]:   gcs_bucket: None
[0m14:58:22.511966 [info ] [MainThread]:   dataproc_batch: None
[0m14:58:22.512439 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m14:58:22.518079 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m14:58:22.519283 [debug] [MainThread]: On debug: select 1 as id
[0m14:58:22.519602 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:58:23.623265 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=terraform-tutorial-430708&j=bq:EU:d36d6642-d9d8-4319-831f-684bc7268bf5&page=queryresults
[0m14:58:23.905930 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m14:58:23.906577 [info ] [MainThread]: [32mAll checks passed![0m
[0m14:58:23.910545 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 2.014781, "process_user_time": 1.229544, "process_kernel_time": 0.204832, "process_mem_max_rss": "198836224", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:58:23.911032 [debug] [MainThread]: Command `dbt debug` succeeded at 14:58:23.910927 after 2.02 seconds
[0m14:58:23.911374 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m14:58:23.911707 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e1f7490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e26dc70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e28c6b0>]}
[0m14:58:23.912078 [debug] [MainThread]: Flushing usage events
[0m14:14:26.644786 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f80c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10888bd90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10888bed0>]}


============================== 14:14:26.648569 | 35a3d8a8-e061-494b-ae91-929f0560d1b4 ==============================
[0m14:14:26.648569 [info ] [MainThread]: Running with dbt=1.8.8
[0m14:14:26.648960 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jandytenedora/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/jandytenedora/Interview/python-interview-gpt-question/dbt/ecommerce_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt debug', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m14:14:26.661464 [info ] [MainThread]: dbt version: 1.8.8
[0m14:14:26.661861 [info ] [MainThread]: python version: 3.13.1
[0m14:14:26.662076 [info ] [MainThread]: python path: /Users/jandytenedora/Interview/python-interview-gpt-question/gpt_question/bin/python3.13
[0m14:14:26.662237 [info ] [MainThread]: os info: macOS-14.7.1-arm64-arm-64bit-Mach-O
[0m14:14:27.478388 [info ] [MainThread]: Using profiles dir at /Users/jandytenedora/.dbt
[0m14:14:27.478731 [info ] [MainThread]: Using profiles.yml file at /Users/jandytenedora/.dbt/profiles.yml
[0m14:14:27.478917 [info ] [MainThread]: Using dbt_project.yml file at /Users/jandytenedora/Interview/python-interview-gpt-question/dbt/ecommerce_dbt/dbt_project.yml
[0m14:14:27.479098 [info ] [MainThread]: adapter type: bigquery
[0m14:14:27.479250 [info ] [MainThread]: adapter version: 1.9.1
[0m14:14:27.529461 [info ] [MainThread]: Configuration:
[0m14:14:27.529933 [info ] [MainThread]:   profiles.yml file [[32mOK found and valid[0m]
[0m14:14:27.530204 [info ] [MainThread]:   dbt_project.yml file [[32mOK found and valid[0m]
[0m14:14:27.530375 [info ] [MainThread]: Required dependencies:
[0m14:14:27.530633 [debug] [MainThread]: Executing "git --help"
[0m14:14:27.558966 [debug] [MainThread]: STDOUT: "b"usage: git [-v | --version] [-h | --help] [-C <path>] [-c <name>=<value>]\n           [--exec-path[=<path>]] [--html-path] [--man-path] [--info-path]\n           [-p | --paginate | -P | --no-pager] [--no-replace-objects] [--bare]\n           [--git-dir=<path>] [--work-tree=<path>] [--namespace=<name>]\n           [--super-prefix=<path>] [--config-env=<name>=<envvar>]\n           <command> [<args>]\n\nThese are common Git commands used in various situations:\n\nstart a working area (see also: git help tutorial)\n   clone     Clone a repository into a new directory\n   init      Create an empty Git repository or reinitialize an existing one\n\nwork on the current change (see also: git help everyday)\n   add       Add file contents to the index\n   mv        Move or rename a file, a directory, or a symlink\n   restore   Restore working tree files\n   rm        Remove files from the working tree and from the index\n\nexamine the history and state (see also: git help revisions)\n   bisect    Use binary search to find the commit that introduced a bug\n   diff      Show changes between commits, commit and working tree, etc\n   grep      Print lines matching a pattern\n   log       Show commit logs\n   show      Show various types of objects\n   status    Show the working tree status\n\ngrow, mark and tweak your common history\n   branch    List, create, or delete branches\n   commit    Record changes to the repository\n   merge     Join two or more development histories together\n   rebase    Reapply commits on top of another base tip\n   reset     Reset current HEAD to the specified state\n   switch    Switch branches\n   tag       Create, list, delete or verify a tag object signed with GPG\n\ncollaborate (see also: git help workflows)\n   fetch     Download objects and refs from another repository\n   pull      Fetch from and integrate with another repository or a local branch\n   push      Update remote refs along with associated objects\n\n'git help -a' and 'git help -g' list available subcommands and some\nconcept guides. See 'git help <command>' or 'git help <concept>'\nto read about a specific subcommand or concept.\nSee 'git help git' for an overview of the system.\n""
[0m14:14:27.559704 [debug] [MainThread]: STDERR: "b''"
[0m14:14:27.559937 [info ] [MainThread]:  - git [[32mOK found[0m]

[0m14:14:27.560144 [info ] [MainThread]: Connection:
[0m14:14:27.560405 [info ] [MainThread]:   method: oauth
[0m14:14:27.560558 [info ] [MainThread]:   database: terraform-tutorial-430708
[0m14:14:27.560706 [info ] [MainThread]:   execution_project: terraform-tutorial-430708
[0m14:14:27.560847 [info ] [MainThread]:   schema: ecommerce_data_raw
[0m14:14:27.560982 [info ] [MainThread]:   location: EU
[0m14:14:27.561117 [info ] [MainThread]:   priority: None
[0m14:14:27.561252 [info ] [MainThread]:   maximum_bytes_billed: None
[0m14:14:27.561390 [info ] [MainThread]:   impersonate_service_account: None
[0m14:14:27.561522 [info ] [MainThread]:   job_retry_deadline_seconds: None
[0m14:14:27.561667 [info ] [MainThread]:   job_retries: 1
[0m14:14:27.561799 [info ] [MainThread]:   job_creation_timeout_seconds: None
[0m14:14:27.561935 [info ] [MainThread]:   job_execution_timeout_seconds: None
[0m14:14:27.562063 [info ] [MainThread]:   timeout_seconds: None
[0m14:14:27.562197 [info ] [MainThread]:   client_id: None
[0m14:14:27.562324 [info ] [MainThread]:   token_uri: None
[0m14:14:27.562455 [info ] [MainThread]:   dataproc_region: None
[0m14:14:27.562582 [info ] [MainThread]:   dataproc_cluster_name: None
[0m14:14:27.562712 [info ] [MainThread]:   gcs_bucket: None
[0m14:14:27.562838 [info ] [MainThread]:   dataproc_batch: None
[0m14:14:27.563227 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m14:14:27.571480 [debug] [MainThread]: Acquiring new bigquery connection 'debug'
[0m14:14:27.572432 [debug] [MainThread]: On debug: select 1 as id
[0m14:14:27.572721 [debug] [MainThread]: Opening a new connection, currently in state init
[0m14:14:30.408364 [debug] [MainThread]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=terraform-tutorial-430708&j=bq:EU:301c00c5-a6d7-4418-9d8d-34204168fc0e&page=queryresults
[0m14:14:30.908870 [info ] [MainThread]:   Connection test: [[32mOK connection ok[0m]

[0m14:14:30.909909 [info ] [MainThread]: [32mAll checks passed![0m
[0m14:14:30.915170 [debug] [MainThread]: Resource report: {"command_name": "debug", "command_success": true, "command_wall_clock_time": 4.314581, "process_user_time": 1.286472, "process_kernel_time": 0.304595, "process_mem_max_rss": "199262208", "process_in_blocks": "0", "process_out_blocks": "0"}
[0m14:14:30.915840 [debug] [MainThread]: Command `dbt debug` succeeded at 14:14:30.915684 after 4.32 seconds
[0m14:14:30.916340 [debug] [MainThread]: Connection 'debug' was properly closed.
[0m14:14:30.916788 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e8db490>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e96e210>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e9746b0>]}
[0m14:14:30.917297 [debug] [MainThread]: Flushing usage events
[0m17:37:46.380723 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104fc8c20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107023d90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107023ed0>]}


============================== 17:37:46.384290 | cbf9468e-0e2b-4c00-95bd-21dc89656a20 ==============================
[0m17:37:46.384290 [info ] [MainThread]: Running with dbt=1.8.8
[0m17:37:46.384675 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/jandytenedora/Interview/python-interview-gpt-question/dbt/ecommerce_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/jandytenedora/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m17:37:47.247374 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'cbf9468e-0e2b-4c00-95bd-21dc89656a20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e9b95b0>]}
[0m17:37:47.279473 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'cbf9468e-0e2b-4c00-95bd-21dc89656a20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e87d9d0>]}
[0m17:37:47.279959 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m17:37:47.295260 [debug] [MainThread]: checksum: ec53e341a936509427e16df1c646386a84befec52c1957e3f4359fbc36fc93f5, vars: {}, profile: , target: , version: 1.8.8
[0m17:37:47.353746 [info ] [MainThread]: Unable to do partial parsing because profile has changed
[0m17:37:47.354129 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m17:37:47.354337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'cbf9468e-0e2b-4c00-95bd-21dc89656a20', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11e84ac50>]}
[0m17:37:48.002271 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.ecommerce_dbt.dim_product' (models/marts/dim_product.sql) depends on a source named 'raw_data.products' which was not found
[0m17:37:48.004821 [debug] [MainThread]: Resource report: {"command_name": "test", "command_wall_clock_time": 1.6707933, "process_user_time": 1.958794, "process_kernel_time": 0.28517, "process_mem_max_rss": "202670080", "command_success": false, "process_in_blocks": "0", "process_out_blocks": "0"}
[0m17:37:48.005169 [debug] [MainThread]: Command `dbt test` failed at 17:37:48.005093 after 1.67 seconds
[0m17:37:48.005456 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11eba1a90>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11eba17c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106f37e70>]}
[0m17:37:48.005681 [debug] [MainThread]: Flushing usage events
[0m17:54:27.863649 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b0e0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105992bb0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105992dc0>]}


============================== 17:54:27.867674 | 6ea70c30-0eb7-4f46-84d8-9d23bc0c4599 ==============================
[0m17:54:27.867674 [info ] [MainThread]: Running with dbt=1.9.1
[0m17:54:27.868139 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jandytenedora/.dbt', 'fail_fast': 'False', 'warn_error': 'None', 'log_path': '/Users/jandytenedora/Interview/python-interview-gpt-question/dbt/ecommerce_dbt/logs', 'debug': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'introspect': 'True', 'invocation_command': 'dbt test', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m17:54:29.030258 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '6ea70c30-0eb7-4f46-84d8-9d23bc0c4599', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104c9a5b0>]}
[0m17:54:29.073792 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '6ea70c30-0eb7-4f46-84d8-9d23bc0c4599', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104eb0220>]}
[0m17:54:29.074381 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m17:54:29.239884 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m17:54:29.324651 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m17:54:29.325063 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': '6ea70c30-0eb7-4f46-84d8-9d23bc0c4599', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105453460>]}
[0m17:54:30.158618 [error] [MainThread]: Encountered an error:
Compilation Error
  Model 'model.ecommerce_dbt.dim_product' (models/marts/dim_product.sql) depends on a source named 'raw_data.products' which was not found
[0m17:54:30.160293 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 2.3534508, "process_in_blocks": "0", "process_kernel_time": 0.385162, "process_mem_max_rss": "191086592", "process_out_blocks": "0", "process_user_time": 2.6168}
[0m17:54:30.160630 [debug] [MainThread]: Command `dbt test` failed at 17:54:30.160561 after 2.35 seconds
[0m17:54:30.160923 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104b0e0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ff42220>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ff42670>]}
[0m17:54:30.161315 [debug] [MainThread]: Flushing usage events
[0m17:54:31.158944 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m17:54:45.440523 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ffdf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e9aee0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105e9a250>]}


============================== 17:54:45.444343 | bf47374d-c11c-4a6f-b9c2-5b115bcb33f0 ==============================
[0m17:54:45.444343 [info ] [MainThread]: Running with dbt=1.9.1
[0m17:54:45.444793 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'fail_fast': 'False', 'log_path': '/Users/jandytenedora/Interview/python-interview-gpt-question/dbt/ecommerce_dbt/logs', 'debug': 'False', 'profiles_dir': '/Users/jandytenedora/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'log_format': 'default', 'static_parser': 'True', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m17:54:46.273796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bf47374d-c11c-4a6f-b9c2-5b115bcb33f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104137f70>]}
[0m17:54:46.315054 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bf47374d-c11c-4a6f-b9c2-5b115bcb33f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd642e0>]}
[0m17:54:46.315539 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m17:54:46.426888 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m17:54:46.564137 [info ] [MainThread]: Unable to do partial parsing because of a version mismatch
[0m17:54:46.564541 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'bf47374d-c11c-4a6f-b9c2-5b115bcb33f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1059324c0>]}
[0m17:54:47.497279 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bf47374d-c11c-4a6f-b9c2-5b115bcb33f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c35ffd0>]}
[0m17:54:47.566298 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jandytenedora/Interview/python-interview-gpt-question/dbt/ecommerce_dbt/target/manifest.json
[0m17:54:47.569938 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jandytenedora/Interview/python-interview-gpt-question/dbt/ecommerce_dbt/target/semantic_manifest.json
[0m17:54:47.715059 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bf47374d-c11c-4a6f-b9c2-5b115bcb33f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c897d30>]}
[0m17:54:47.715528 [info ] [MainThread]: Found 5 models, 3 sources, 489 macros
[0m17:54:47.715796 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bf47374d-c11c-4a6f-b9c2-5b115bcb33f0', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b89e5e0>]}
[0m17:54:47.716738 [warn ] [MainThread]: Nothing to do. Try checking your model configs and model specification args
[0m17:54:47.717140 [debug] [MainThread]: Command end result
[0m17:54:47.736844 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jandytenedora/Interview/python-interview-gpt-question/dbt/ecommerce_dbt/target/manifest.json
[0m17:54:47.738060 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jandytenedora/Interview/python-interview-gpt-question/dbt/ecommerce_dbt/target/semantic_manifest.json
[0m17:54:47.741020 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/jandytenedora/Interview/python-interview-gpt-question/dbt/ecommerce_dbt/target/run_results.json
[0m17:54:47.742620 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 2.356302, "process_in_blocks": "0", "process_kernel_time": 0.352536, "process_mem_max_rss": "220200960", "process_out_blocks": "0", "process_user_time": 2.726142}
[0m17:54:47.742986 [debug] [MainThread]: Command `dbt test` succeeded at 17:54:47.742917 after 2.36 seconds
[0m17:54:47.743289 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ffdf10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd642e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c6daca0>]}
[0m17:54:47.743584 [debug] [MainThread]: Flushing usage events
[0m17:54:48.821314 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:46:41.864329 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c11fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107aaff70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107aaf280>]}


============================== 18:46:41.868369 | fe13b5b8-72e1-4b33-9c46-75b655eab5e9 ==============================
[0m18:46:41.868369 [info ] [MainThread]: Running with dbt=1.9.1
[0m18:46:41.868844 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jandytenedora/.dbt', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/jandytenedora/Interview/python-interview-gpt-question/dbt/ecommerce_dbt/logs', 'fail_fast': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt test', 'send_anonymous_usage_stats': 'True'}
[0m18:46:42.736140 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fe13b5b8-72e1-4b33-9c46-75b655eab5e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d97aa00>]}
[0m18:46:42.778883 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fe13b5b8-72e1-4b33-9c46-75b655eab5e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da6d8e0>]}
[0m18:46:42.779474 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m18:46:42.889728 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m18:46:43.046611 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 1 files added, 0 files changed.
[0m18:46:43.047128 [debug] [MainThread]: Partial parsing: added file: ecommerce_dbt://models/marts/schema.yml
[0m18:46:43.106231 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'dim_products' in the 'models' section of file 'models/marts/schema.yml'
[0m18:46:43.200786 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.ecommerce_dbt.not_null_dim_products_product_id.c8aba288d1' (models/marts/schema.yml) depends on a node named 'dim_products' in package '' which was not found
[0m18:46:43.201226 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.ecommerce_dbt.unique_dim_products_product_id.ef7b2a9985' (models/marts/schema.yml) depends on a node named 'dim_products' in package '' which was not found
[0m18:46:43.201488 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.ecommerce_dbt.not_null_dim_products_product_name.991aec73f3' (models/marts/schema.yml) depends on a node named 'dim_products' in package '' which was not found
[0m18:46:43.201910 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.ecommerce_dbt.not_null_dim_products_price.93519fc0ed' (models/marts/schema.yml) depends on a node named 'dim_products' in package '' which was not found
[0m18:46:43.283006 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fe13b5b8-72e1-4b33-9c46-75b655eab5e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dfcc130>]}
[0m18:46:43.365497 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jandytenedora/Interview/python-interview-gpt-question/dbt/ecommerce_dbt/target/manifest.json
[0m18:46:43.368808 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jandytenedora/Interview/python-interview-gpt-question/dbt/ecommerce_dbt/target/semantic_manifest.json
[0m18:46:43.394759 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fe13b5b8-72e1-4b33-9c46-75b655eab5e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e2817c0>]}
[0m18:46:43.395179 [info ] [MainThread]: Found 5 models, 7 data tests, 3 sources, 489 macros
[0m18:46:43.395442 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe13b5b8-72e1-4b33-9c46-75b655eab5e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10d4acd90>]}
[0m18:46:43.396700 [info ] [MainThread]: 
[0m18:46:43.396961 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:46:43.397180 [info ] [MainThread]: 
[0m18:46:43.397521 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:46:43.400953 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_terraform-tutorial-430708_ecommerce_data_raw_staging'
[0m18:46:43.401326 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:46:43.401639 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_terraform-tutorial-430708_ecommerce_data_raw_reporting'
[0m18:46:43.401979 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:46:45.863703 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fe13b5b8-72e1-4b33-9c46-75b655eab5e9', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e281940>]}
[0m18:46:45.865880 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:46:45.869735 [debug] [Thread-1  ]: Began running node test.ecommerce_dbt.not_null_fact_customer_activity_activity_date.412e077efb
[0m18:46:45.870536 [debug] [Thread-2  ]: Began running node test.ecommerce_dbt.not_null_fact_customer_activity_activity_type.0bf9b8fb18
[0m18:46:45.871666 [debug] [Thread-3  ]: Began running node test.ecommerce_dbt.not_null_fact_customer_activity_customer_id.8c4e1c83bf
[0m18:46:45.872191 [debug] [Thread-4  ]: Began running node test.ecommerce_dbt.not_null_fact_sales_product_id.39101802a8
[0m18:46:45.871185 [info ] [Thread-1  ]: 1 of 7 START test not_null_fact_customer_activity_activity_date ................ [RUN]
[0m18:46:45.872820 [info ] [Thread-2  ]: 2 of 7 START test not_null_fact_customer_activity_activity_type ................ [RUN]
[0m18:46:45.873395 [info ] [Thread-3  ]: 3 of 7 START test not_null_fact_customer_activity_customer_id .................. [RUN]
[0m18:46:45.873947 [info ] [Thread-4  ]: 4 of 7 START test not_null_fact_sales_product_id ............................... [RUN]
[0m18:46:45.874599 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_terraform-tutorial-430708_ecommerce_data_raw_staging, now test.ecommerce_dbt.not_null_fact_customer_activity_activity_date.412e077efb)
[0m18:46:45.875151 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_terraform-tutorial-430708_ecommerce_data_raw_reporting, now test.ecommerce_dbt.not_null_fact_customer_activity_activity_type.0bf9b8fb18)
[0m18:46:45.875737 [debug] [Thread-3  ]: Acquiring new bigquery connection 'test.ecommerce_dbt.not_null_fact_customer_activity_customer_id.8c4e1c83bf'
[0m18:46:45.876236 [debug] [Thread-4  ]: Acquiring new bigquery connection 'test.ecommerce_dbt.not_null_fact_sales_product_id.39101802a8'
[0m18:46:45.876666 [debug] [Thread-1  ]: Began compiling node test.ecommerce_dbt.not_null_fact_customer_activity_activity_date.412e077efb
[0m18:46:45.877042 [debug] [Thread-2  ]: Began compiling node test.ecommerce_dbt.not_null_fact_customer_activity_activity_type.0bf9b8fb18
[0m18:46:45.877421 [debug] [Thread-3  ]: Began compiling node test.ecommerce_dbt.not_null_fact_customer_activity_customer_id.8c4e1c83bf
[0m18:46:45.877787 [debug] [Thread-4  ]: Began compiling node test.ecommerce_dbt.not_null_fact_sales_product_id.39101802a8
[0m18:46:45.901982 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_dbt.not_null_fact_customer_activity_activity_type.0bf9b8fb18"
[0m18:46:45.904741 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_dbt.not_null_fact_customer_activity_activity_date.412e077efb"
[0m18:46:45.908363 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_dbt.not_null_fact_sales_product_id.39101802a8"
[0m18:46:45.911430 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_dbt.not_null_fact_customer_activity_customer_id.8c4e1c83bf"
[0m18:46:45.912473 [debug] [Thread-4  ]: Began executing node test.ecommerce_dbt.not_null_fact_sales_product_id.39101802a8
[0m18:46:45.918222 [debug] [Thread-3  ]: Began executing node test.ecommerce_dbt.not_null_fact_customer_activity_customer_id.8c4e1c83bf
[0m18:46:45.918526 [debug] [Thread-2  ]: Began executing node test.ecommerce_dbt.not_null_fact_customer_activity_activity_type.0bf9b8fb18
[0m18:46:45.928501 [debug] [Thread-4  ]: Writing runtime sql for node "test.ecommerce_dbt.not_null_fact_sales_product_id.39101802a8"
[0m18:46:45.928797 [debug] [Thread-1  ]: Began executing node test.ecommerce_dbt.not_null_fact_customer_activity_activity_date.412e077efb
[0m18:46:45.930893 [debug] [Thread-3  ]: Writing runtime sql for node "test.ecommerce_dbt.not_null_fact_customer_activity_customer_id.8c4e1c83bf"
[0m18:46:45.932877 [debug] [Thread-2  ]: Writing runtime sql for node "test.ecommerce_dbt.not_null_fact_customer_activity_activity_type.0bf9b8fb18"
[0m18:46:45.934945 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_dbt.not_null_fact_customer_activity_activity_date.412e077efb"
[0m18:46:45.935994 [debug] [Thread-2  ]: On test.ecommerce_dbt.not_null_fact_customer_activity_activity_type.0bf9b8fb18: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "test.ecommerce_dbt.not_null_fact_customer_activity_activity_type.0bf9b8fb18"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select activity_type
from `terraform-tutorial-430708`.`ecommerce_data_raw_reporting`.`fact_customer_activity`
where activity_type is null



      
    ) dbt_internal_test
[0m18:46:45.936343 [debug] [Thread-1  ]: On test.ecommerce_dbt.not_null_fact_customer_activity_activity_date.412e077efb: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "test.ecommerce_dbt.not_null_fact_customer_activity_activity_date.412e077efb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select activity_date
from `terraform-tutorial-430708`.`ecommerce_data_raw_reporting`.`fact_customer_activity`
where activity_date is null



      
    ) dbt_internal_test
[0m18:46:45.936641 [debug] [Thread-4  ]: On test.ecommerce_dbt.not_null_fact_sales_product_id.39101802a8: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "test.ecommerce_dbt.not_null_fact_sales_product_id.39101802a8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_id
from `terraform-tutorial-430708`.`ecommerce_data_raw_reporting`.`fact_sales`
where product_id is null



      
    ) dbt_internal_test
[0m18:46:45.936916 [debug] [Thread-3  ]: On test.ecommerce_dbt.not_null_fact_customer_activity_customer_id.8c4e1c83bf: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "test.ecommerce_dbt.not_null_fact_customer_activity_customer_id.8c4e1c83bf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from `terraform-tutorial-430708`.`ecommerce_data_raw_reporting`.`fact_customer_activity`
where customer_id is null



      
    ) dbt_internal_test
[0m18:46:45.937280 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m18:46:45.937520 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:46:45.937800 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m18:46:45.938051 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m18:46:47.079027 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=terraform-tutorial-430708&j=bq:EU:4c2d07b6-a061-46c0-97aa-4d9f384f6910&page=queryresults
[0m18:46:47.079857 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=terraform-tutorial-430708&j=bq:EU:390e7f2d-9451-4636-90a3-6e5a8eb52d8d&page=queryresults
[0m18:46:47.080653 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=terraform-tutorial-430708&j=bq:EU:05dd5eff-8cfb-4509-a27f-70f62ce9d413&page=queryresults
[0m18:46:47.081404 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=terraform-tutorial-430708&j=bq:EU:b64140cc-44dd-4753-8b0e-04e82e470632&page=queryresults
[0m18:46:47.081981 [error] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=terraform-tutorial-430708&j=bq:EU:4c2d07b6-a061-46c0-97aa-4d9f384f6910&page=queryresults
[0m18:46:47.082681 [error] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=terraform-tutorial-430708&j=bq:EU:390e7f2d-9451-4636-90a3-6e5a8eb52d8d&page=queryresults
[0m18:46:47.083258 [error] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=terraform-tutorial-430708&j=bq:EU:05dd5eff-8cfb-4509-a27f-70f62ce9d413&page=queryresults
[0m18:46:47.083789 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=terraform-tutorial-430708&j=bq:EU:b64140cc-44dd-4753-8b0e-04e82e470632&page=queryresults
[0m18:46:47.163284 [debug] [Thread-3  ]: Database Error in test not_null_fact_customer_activity_customer_id (models/marts/schema.yml)
  Not found: Dataset terraform-tutorial-430708:ecommerce_data_raw_reporting was not found in location EU
  compiled code at target/run/ecommerce_dbt/models/marts/schema.yml/not_null_fact_customer_activity_customer_id.sql
[0m18:46:47.164101 [debug] [Thread-1  ]: Database Error in test not_null_fact_customer_activity_activity_date (models/marts/schema.yml)
  Not found: Dataset terraform-tutorial-430708:ecommerce_data_raw_reporting was not found in location EU
  compiled code at target/run/ecommerce_dbt/models/marts/schema.yml/not_null_fact_customer_activity_activity_date.sql
[0m18:46:47.164652 [debug] [Thread-4  ]: Database Error in test not_null_fact_sales_product_id (models/marts/schema.yml)
  Not found: Dataset terraform-tutorial-430708:ecommerce_data_raw_reporting was not found in location EU
  compiled code at target/run/ecommerce_dbt/models/marts/schema.yml/not_null_fact_sales_product_id.sql
[0m18:46:47.165237 [error] [Thread-3  ]: 3 of 7 ERROR not_null_fact_customer_activity_customer_id ....................... [[31mERROR[0m in 1.29s]
[0m18:46:47.165825 [debug] [Thread-2  ]: Database Error in test not_null_fact_customer_activity_activity_type (models/marts/schema.yml)
  Not found: Dataset terraform-tutorial-430708:ecommerce_data_raw_reporting was not found in location EU
  compiled code at target/run/ecommerce_dbt/models/marts/schema.yml/not_null_fact_customer_activity_activity_type.sql
[0m18:46:47.166180 [error] [Thread-1  ]: 1 of 7 ERROR not_null_fact_customer_activity_activity_date ..................... [[31mERROR[0m in 1.29s]
[0m18:46:47.166571 [error] [Thread-4  ]: 4 of 7 ERROR not_null_fact_sales_product_id .................................... [[31mERROR[0m in 1.29s]
[0m18:46:47.166989 [debug] [Thread-3  ]: Finished running node test.ecommerce_dbt.not_null_fact_customer_activity_customer_id.8c4e1c83bf
[0m18:46:47.167321 [error] [Thread-2  ]: 2 of 7 ERROR not_null_fact_customer_activity_activity_type ..................... [[31mERROR[0m in 1.29s]
[0m18:46:47.167861 [debug] [Thread-1  ]: Finished running node test.ecommerce_dbt.not_null_fact_customer_activity_activity_date.412e077efb
[0m18:46:47.168317 [debug] [Thread-4  ]: Finished running node test.ecommerce_dbt.not_null_fact_sales_product_id.39101802a8
[0m18:46:47.168627 [debug] [Thread-3  ]: Began running node test.ecommerce_dbt.not_null_fact_sales_sale_date.aeb11a016c
[0m18:46:47.169017 [debug] [Thread-7  ]: Marking all children of 'test.ecommerce_dbt.not_null_fact_customer_activity_customer_id.8c4e1c83bf' to be skipped because of status 'error'.  Reason: Database Error in test not_null_fact_customer_activity_customer_id (models/marts/schema.yml)
  Not found: Dataset terraform-tutorial-430708:ecommerce_data_raw_reporting was not found in location EU
  compiled code at target/run/ecommerce_dbt/models/marts/schema.yml/not_null_fact_customer_activity_customer_id.sql.
[0m18:46:47.169399 [debug] [Thread-2  ]: Finished running node test.ecommerce_dbt.not_null_fact_customer_activity_activity_type.0bf9b8fb18
[0m18:46:47.169688 [debug] [Thread-1  ]: Began running node test.ecommerce_dbt.not_null_fact_sales_total_quantity.a24e8f3a97
[0m18:46:47.169980 [debug] [Thread-4  ]: Began running node test.ecommerce_dbt.not_null_fact_sales_total_revenue.e93f0630dd
[0m18:46:47.170610 [debug] [Thread-7  ]: Marking all children of 'test.ecommerce_dbt.not_null_fact_customer_activity_activity_date.412e077efb' to be skipped because of status 'error'.  Reason: Database Error in test not_null_fact_customer_activity_activity_date (models/marts/schema.yml)
  Not found: Dataset terraform-tutorial-430708:ecommerce_data_raw_reporting was not found in location EU
  compiled code at target/run/ecommerce_dbt/models/marts/schema.yml/not_null_fact_customer_activity_activity_date.sql.
[0m18:46:47.170259 [info ] [Thread-3  ]: 5 of 7 START test not_null_fact_sales_sale_date ................................ [RUN]
[0m18:46:47.170994 [info ] [Thread-1  ]: 6 of 7 START test not_null_fact_sales_total_quantity ........................... [RUN]
[0m18:46:47.171593 [debug] [Thread-7  ]: Marking all children of 'test.ecommerce_dbt.not_null_fact_sales_product_id.39101802a8' to be skipped because of status 'error'.  Reason: Database Error in test not_null_fact_sales_product_id (models/marts/schema.yml)
  Not found: Dataset terraform-tutorial-430708:ecommerce_data_raw_reporting was not found in location EU
  compiled code at target/run/ecommerce_dbt/models/marts/schema.yml/not_null_fact_sales_product_id.sql.
[0m18:46:47.171213 [info ] [Thread-4  ]: 7 of 7 START test not_null_fact_sales_total_revenue ............................ [RUN]
[0m18:46:47.172044 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_dbt.not_null_fact_customer_activity_customer_id.8c4e1c83bf, now test.ecommerce_dbt.not_null_fact_sales_sale_date.aeb11a016c)
[0m18:46:47.172369 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_dbt.not_null_fact_customer_activity_activity_date.412e077efb, now test.ecommerce_dbt.not_null_fact_sales_total_quantity.a24e8f3a97)
[0m18:46:47.172778 [debug] [Thread-7  ]: Marking all children of 'test.ecommerce_dbt.not_null_fact_customer_activity_activity_type.0bf9b8fb18' to be skipped because of status 'error'.  Reason: Database Error in test not_null_fact_customer_activity_activity_type (models/marts/schema.yml)
  Not found: Dataset terraform-tutorial-430708:ecommerce_data_raw_reporting was not found in location EU
  compiled code at target/run/ecommerce_dbt/models/marts/schema.yml/not_null_fact_customer_activity_activity_type.sql.
[0m18:46:47.173156 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_dbt.not_null_fact_sales_product_id.39101802a8, now test.ecommerce_dbt.not_null_fact_sales_total_revenue.e93f0630dd)
[0m18:46:47.173466 [debug] [Thread-3  ]: Began compiling node test.ecommerce_dbt.not_null_fact_sales_sale_date.aeb11a016c
[0m18:46:47.173720 [debug] [Thread-1  ]: Began compiling node test.ecommerce_dbt.not_null_fact_sales_total_quantity.a24e8f3a97
[0m18:46:47.174019 [debug] [Thread-4  ]: Began compiling node test.ecommerce_dbt.not_null_fact_sales_total_revenue.e93f0630dd
[0m18:46:47.177791 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_dbt.not_null_fact_sales_sale_date.aeb11a016c"
[0m18:46:47.182444 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_dbt.not_null_fact_sales_total_quantity.a24e8f3a97"
[0m18:46:47.185625 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_dbt.not_null_fact_sales_total_revenue.e93f0630dd"
[0m18:46:47.186403 [debug] [Thread-1  ]: Began executing node test.ecommerce_dbt.not_null_fact_sales_total_quantity.a24e8f3a97
[0m18:46:47.188658 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_dbt.not_null_fact_sales_total_quantity.a24e8f3a97"
[0m18:46:47.189011 [debug] [Thread-3  ]: Began executing node test.ecommerce_dbt.not_null_fact_sales_sale_date.aeb11a016c
[0m18:46:47.191303 [debug] [Thread-3  ]: Writing runtime sql for node "test.ecommerce_dbt.not_null_fact_sales_sale_date.aeb11a016c"
[0m18:46:47.191867 [debug] [Thread-4  ]: Began executing node test.ecommerce_dbt.not_null_fact_sales_total_revenue.e93f0630dd
[0m18:46:47.194056 [debug] [Thread-4  ]: Writing runtime sql for node "test.ecommerce_dbt.not_null_fact_sales_total_revenue.e93f0630dd"
[0m18:46:47.194427 [debug] [Thread-1  ]: On test.ecommerce_dbt.not_null_fact_sales_total_quantity.a24e8f3a97: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "test.ecommerce_dbt.not_null_fact_sales_total_quantity.a24e8f3a97"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select total_quantity
from `terraform-tutorial-430708`.`ecommerce_data_raw_reporting`.`fact_sales`
where total_quantity is null



      
    ) dbt_internal_test
[0m18:46:47.194846 [debug] [Thread-3  ]: On test.ecommerce_dbt.not_null_fact_sales_sale_date.aeb11a016c: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "test.ecommerce_dbt.not_null_fact_sales_sale_date.aeb11a016c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sale_date
from `terraform-tutorial-430708`.`ecommerce_data_raw_reporting`.`fact_sales`
where sale_date is null



      
    ) dbt_internal_test
[0m18:46:47.195122 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:46:47.195422 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m18:46:47.196188 [debug] [Thread-4  ]: On test.ecommerce_dbt.not_null_fact_sales_total_revenue.e93f0630dd: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "test.ecommerce_dbt.not_null_fact_sales_total_revenue.e93f0630dd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select total_revenue
from `terraform-tutorial-430708`.`ecommerce_data_raw_reporting`.`fact_sales`
where total_revenue is null



      
    ) dbt_internal_test
[0m18:46:47.197327 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m18:46:48.067882 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=terraform-tutorial-430708&j=bq:EU:0cb1a96b-06a0-4e8c-a41f-330d09fe3a63&page=queryresults
[0m18:46:48.069659 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=terraform-tutorial-430708&j=bq:EU:c609ea03-af25-4e2a-9222-ae7cd8f974f2&page=queryresults
[0m18:46:48.070594 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=terraform-tutorial-430708&j=bq:EU:0cb1a96b-06a0-4e8c-a41f-330d09fe3a63&page=queryresults
[0m18:46:48.071540 [error] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=terraform-tutorial-430708&j=bq:EU:c609ea03-af25-4e2a-9222-ae7cd8f974f2&page=queryresults
[0m18:46:48.091147 [debug] [Thread-1  ]: Database Error in test not_null_fact_sales_total_quantity (models/marts/schema.yml)
  Not found: Dataset terraform-tutorial-430708:ecommerce_data_raw_reporting was not found in location EU
  compiled code at target/run/ecommerce_dbt/models/marts/schema.yml/not_null_fact_sales_total_quantity.sql
[0m18:46:48.093068 [debug] [Thread-4  ]: Database Error in test not_null_fact_sales_total_revenue (models/marts/schema.yml)
  Not found: Dataset terraform-tutorial-430708:ecommerce_data_raw_reporting was not found in location EU
  compiled code at target/run/ecommerce_dbt/models/marts/schema.yml/not_null_fact_sales_total_revenue.sql
[0m18:46:48.093722 [error] [Thread-1  ]: 6 of 7 ERROR not_null_fact_sales_total_quantity ................................ [[31mERROR[0m in 0.92s]
[0m18:46:48.094251 [error] [Thread-4  ]: 7 of 7 ERROR not_null_fact_sales_total_revenue ................................. [[31mERROR[0m in 0.92s]
[0m18:46:48.094802 [debug] [Thread-1  ]: Finished running node test.ecommerce_dbt.not_null_fact_sales_total_quantity.a24e8f3a97
[0m18:46:48.095280 [debug] [Thread-4  ]: Finished running node test.ecommerce_dbt.not_null_fact_sales_total_revenue.e93f0630dd
[0m18:46:48.095727 [debug] [Thread-7  ]: Marking all children of 'test.ecommerce_dbt.not_null_fact_sales_total_quantity.a24e8f3a97' to be skipped because of status 'error'.  Reason: Database Error in test not_null_fact_sales_total_quantity (models/marts/schema.yml)
  Not found: Dataset terraform-tutorial-430708:ecommerce_data_raw_reporting was not found in location EU
  compiled code at target/run/ecommerce_dbt/models/marts/schema.yml/not_null_fact_sales_total_quantity.sql.
[0m18:46:48.096295 [debug] [Thread-7  ]: Marking all children of 'test.ecommerce_dbt.not_null_fact_sales_total_revenue.e93f0630dd' to be skipped because of status 'error'.  Reason: Database Error in test not_null_fact_sales_total_revenue (models/marts/schema.yml)
  Not found: Dataset terraform-tutorial-430708:ecommerce_data_raw_reporting was not found in location EU
  compiled code at target/run/ecommerce_dbt/models/marts/schema.yml/not_null_fact_sales_total_revenue.sql.
[0m18:46:48.124877 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=terraform-tutorial-430708&j=bq:EU:33ab3ff9-4dbf-43e0-84d3-f5d9a7f4df20&page=queryresults
[0m18:46:48.125452 [error] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=terraform-tutorial-430708&j=bq:EU:33ab3ff9-4dbf-43e0-84d3-f5d9a7f4df20&page=queryresults
[0m18:46:48.133917 [debug] [Thread-3  ]: Database Error in test not_null_fact_sales_sale_date (models/marts/schema.yml)
  Not found: Dataset terraform-tutorial-430708:ecommerce_data_raw_reporting was not found in location EU
  compiled code at target/run/ecommerce_dbt/models/marts/schema.yml/not_null_fact_sales_sale_date.sql
[0m18:46:48.134525 [error] [Thread-3  ]: 5 of 7 ERROR not_null_fact_sales_sale_date ..................................... [[31mERROR[0m in 0.96s]
[0m18:46:48.134996 [debug] [Thread-3  ]: Finished running node test.ecommerce_dbt.not_null_fact_sales_sale_date.aeb11a016c
[0m18:46:48.135381 [debug] [Thread-7  ]: Marking all children of 'test.ecommerce_dbt.not_null_fact_sales_sale_date.aeb11a016c' to be skipped because of status 'error'.  Reason: Database Error in test not_null_fact_sales_sale_date (models/marts/schema.yml)
  Not found: Dataset terraform-tutorial-430708:ecommerce_data_raw_reporting was not found in location EU
  compiled code at target/run/ecommerce_dbt/models/marts/schema.yml/not_null_fact_sales_sale_date.sql.
[0m18:46:48.136467 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:46:48.136986 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:46:48.137226 [debug] [MainThread]: Connection 'test.ecommerce_dbt.not_null_fact_sales_total_quantity.a24e8f3a97' was properly closed.
[0m18:46:48.137454 [debug] [MainThread]: Connection 'test.ecommerce_dbt.not_null_fact_customer_activity_activity_type.0bf9b8fb18' was properly closed.
[0m18:46:48.137671 [debug] [MainThread]: Connection 'test.ecommerce_dbt.not_null_fact_sales_sale_date.aeb11a016c' was properly closed.
[0m18:46:48.137880 [debug] [MainThread]: Connection 'test.ecommerce_dbt.not_null_fact_sales_total_revenue.e93f0630dd' was properly closed.
[0m18:46:48.138143 [info ] [MainThread]: 
[0m18:46:48.138389 [info ] [MainThread]: Finished running 7 data tests in 0 hours 0 minutes and 4.74 seconds (4.74s).
[0m18:46:48.139562 [debug] [MainThread]: Command end result
[0m18:46:48.162917 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jandytenedora/Interview/python-interview-gpt-question/dbt/ecommerce_dbt/target/manifest.json
[0m18:46:48.164343 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jandytenedora/Interview/python-interview-gpt-question/dbt/ecommerce_dbt/target/semantic_manifest.json
[0m18:46:48.170321 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/jandytenedora/Interview/python-interview-gpt-question/dbt/ecommerce_dbt/target/run_results.json
[0m18:46:48.170572 [info ] [MainThread]: 
[0m18:46:48.170870 [info ] [MainThread]: [31mCompleted with 7 errors, 0 partial successes, and 0 warnings:[0m
[0m18:46:48.171095 [info ] [MainThread]: 
[0m18:46:48.171367 [error] [MainThread]:   Database Error in test not_null_fact_customer_activity_customer_id (models/marts/schema.yml)
  Not found: Dataset terraform-tutorial-430708:ecommerce_data_raw_reporting was not found in location EU
  compiled code at target/run/ecommerce_dbt/models/marts/schema.yml/not_null_fact_customer_activity_customer_id.sql
[0m18:46:48.171589 [info ] [MainThread]: 
[0m18:46:48.171839 [error] [MainThread]:   Database Error in test not_null_fact_customer_activity_activity_date (models/marts/schema.yml)
  Not found: Dataset terraform-tutorial-430708:ecommerce_data_raw_reporting was not found in location EU
  compiled code at target/run/ecommerce_dbt/models/marts/schema.yml/not_null_fact_customer_activity_activity_date.sql
[0m18:46:48.172057 [info ] [MainThread]: 
[0m18:46:48.172302 [error] [MainThread]:   Database Error in test not_null_fact_sales_product_id (models/marts/schema.yml)
  Not found: Dataset terraform-tutorial-430708:ecommerce_data_raw_reporting was not found in location EU
  compiled code at target/run/ecommerce_dbt/models/marts/schema.yml/not_null_fact_sales_product_id.sql
[0m18:46:48.172510 [info ] [MainThread]: 
[0m18:46:48.172757 [error] [MainThread]:   Database Error in test not_null_fact_customer_activity_activity_type (models/marts/schema.yml)
  Not found: Dataset terraform-tutorial-430708:ecommerce_data_raw_reporting was not found in location EU
  compiled code at target/run/ecommerce_dbt/models/marts/schema.yml/not_null_fact_customer_activity_activity_type.sql
[0m18:46:48.172964 [info ] [MainThread]: 
[0m18:46:48.173208 [error] [MainThread]:   Database Error in test not_null_fact_sales_total_quantity (models/marts/schema.yml)
  Not found: Dataset terraform-tutorial-430708:ecommerce_data_raw_reporting was not found in location EU
  compiled code at target/run/ecommerce_dbt/models/marts/schema.yml/not_null_fact_sales_total_quantity.sql
[0m18:46:48.173413 [info ] [MainThread]: 
[0m18:46:48.173654 [error] [MainThread]:   Database Error in test not_null_fact_sales_total_revenue (models/marts/schema.yml)
  Not found: Dataset terraform-tutorial-430708:ecommerce_data_raw_reporting was not found in location EU
  compiled code at target/run/ecommerce_dbt/models/marts/schema.yml/not_null_fact_sales_total_revenue.sql
[0m18:46:48.173857 [info ] [MainThread]: 
[0m18:46:48.174094 [error] [MainThread]:   Database Error in test not_null_fact_sales_sale_date (models/marts/schema.yml)
  Not found: Dataset terraform-tutorial-430708:ecommerce_data_raw_reporting was not found in location EU
  compiled code at target/run/ecommerce_dbt/models/marts/schema.yml/not_null_fact_sales_sale_date.sql
[0m18:46:48.174298 [info ] [MainThread]: 
[0m18:46:48.174521 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=7 SKIP=0 TOTAL=7
[0m18:46:48.175974 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 6.365787, "process_in_blocks": "0", "process_kernel_time": 0.385166, "process_mem_max_rss": "199376896", "process_out_blocks": "0", "process_user_time": 2.272603}
[0m18:46:48.176274 [debug] [MainThread]: Command `dbt test` failed at 18:46:48.176216 after 6.37 seconds
[0m18:46:48.176561 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106c11fd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10da6d8e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067b9e80>]}
[0m18:46:48.176841 [debug] [MainThread]: Flushing usage events
[0m18:46:49.051840 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:48:04.713722 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102f42040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fd9df0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103fd9fd0>]}


============================== 18:48:04.718272 | 551893f6-5cf0-4d93-afc2-bc36badcbae4 ==============================
[0m18:48:04.718272 [info ] [MainThread]: Running with dbt=1.9.1
[0m18:48:04.718829 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jandytenedora/.dbt', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/jandytenedora/Interview/python-interview-gpt-question/dbt/ecommerce_dbt/logs', 'debug': 'False', 'warn_error': 'None', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:48:06.075256 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '551893f6-5cf0-4d93-afc2-bc36badcbae4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10ce797f0>]}
[0m18:48:06.116892 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '551893f6-5cf0-4d93-afc2-bc36badcbae4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cf68490>]}
[0m18:48:06.117374 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m18:48:06.228689 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m18:48:06.402850 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:48:06.403217 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:48:06.446205 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '551893f6-5cf0-4d93-afc2-bc36badcbae4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dde9130>]}
[0m18:48:06.529727 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jandytenedora/Interview/python-interview-gpt-question/dbt/ecommerce_dbt/target/manifest.json
[0m18:48:06.532487 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jandytenedora/Interview/python-interview-gpt-question/dbt/ecommerce_dbt/target/semantic_manifest.json
[0m18:48:06.547575 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '551893f6-5cf0-4d93-afc2-bc36badcbae4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10de16f10>]}
[0m18:48:06.548023 [info ] [MainThread]: Found 5 models, 7 data tests, 3 sources, 489 macros
[0m18:48:06.548294 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '551893f6-5cf0-4d93-afc2-bc36badcbae4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dddbfd0>]}
[0m18:48:06.549552 [info ] [MainThread]: 
[0m18:48:06.549818 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:48:06.550027 [info ] [MainThread]: 
[0m18:48:06.550360 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:48:06.553888 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_terraform-tutorial-430708'
[0m18:48:06.554283 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_terraform-tutorial-430708'
[0m18:48:06.554538 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:48:06.554800 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:48:09.131309 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_terraform-tutorial-430708, now create_terraform-tutorial-430708_ecommerce_data_raw_reporting)
[0m18:48:09.132581 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_terraform-tutorial-430708, now create_terraform-tutorial-430708_ecommerce_data_raw_staging)
[0m18:48:09.135034 [debug] [ThreadPool]: Creating schema "database: "terraform-tutorial-430708"
schema: "ecommerce_data_raw_reporting"
"
[0m18:48:09.135815 [debug] [ThreadPool]: Creating schema "database: "terraform-tutorial-430708"
schema: "ecommerce_data_raw_staging"
"
[0m18:48:09.157995 [debug] [ThreadPool]: On create_terraform-tutorial-430708_ecommerce_data_raw_reporting: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "ecommerce_dbt", "target_name": "dev", "connection_name": "create_terraform-tutorial-430708_ecommerce_data_raw_reporting"} */
create schema if not exists `terraform-tutorial-430708`.`ecommerce_data_raw_reporting`
  
[0m18:48:09.160500 [debug] [ThreadPool]: On create_terraform-tutorial-430708_ecommerce_data_raw_staging: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "ecommerce_dbt", "target_name": "dev", "connection_name": "create_terraform-tutorial-430708_ecommerce_data_raw_staging"} */
create schema if not exists `terraform-tutorial-430708`.`ecommerce_data_raw_staging`
  
[0m18:48:09.160912 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:48:09.161173 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:48:10.050053 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=terraform-tutorial-430708&j=bq:EU:158232ea-a041-4ad7-b4ce-d94632a935f1&page=queryresults
[0m18:48:10.050931 [debug] [ThreadPool]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=terraform-tutorial-430708&j=bq:EU:0f4edc41-08db-4694-87d4-98b04f6b80cc&page=queryresults
[0m18:48:12.796756 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_terraform-tutorial-430708_ecommerce_data_raw_reporting'
[0m18:48:12.797709 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:48:12.798498 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_terraform-tutorial-430708_ecommerce_data_raw_staging'
[0m18:48:12.800185 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:48:13.645393 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '551893f6-5cf0-4d93-afc2-bc36badcbae4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cfbc490>]}
[0m18:48:13.647305 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:48:13.650037 [debug] [Thread-1  ]: Began running node model.ecommerce_dbt.dim_product
[0m18:48:13.650688 [debug] [Thread-2  ]: Began running node model.ecommerce_dbt.stg_customer_logs
[0m18:48:13.651165 [info ] [Thread-1  ]: 1 of 5 START sql view model ecommerce_data_raw_reporting.dim_product ........... [RUN]
[0m18:48:13.651500 [debug] [Thread-3  ]: Began running node model.ecommerce_dbt.stg_sales
[0m18:48:13.651846 [info ] [Thread-2  ]: 2 of 5 START sql view model ecommerce_data_raw_staging.stg_customer_logs ....... [RUN]
[0m18:48:13.652283 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_terraform-tutorial-430708_ecommerce_data_raw_reporting, now model.ecommerce_dbt.dim_product)
[0m18:48:13.652644 [info ] [Thread-3  ]: 3 of 5 START sql view model ecommerce_data_raw_staging.stg_sales ............... [RUN]
[0m18:48:13.652969 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_terraform-tutorial-430708_ecommerce_data_raw_staging, now model.ecommerce_dbt.stg_customer_logs)
[0m18:48:13.653261 [debug] [Thread-1  ]: Began compiling node model.ecommerce_dbt.dim_product
[0m18:48:13.654081 [debug] [Thread-3  ]: Acquiring new bigquery connection 'model.ecommerce_dbt.stg_sales'
[0m18:48:13.654543 [debug] [Thread-2  ]: Began compiling node model.ecommerce_dbt.stg_customer_logs
[0m18:48:13.662863 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_dbt.dim_product"
[0m18:48:13.663238 [debug] [Thread-3  ]: Began compiling node model.ecommerce_dbt.stg_sales
[0m18:48:13.665759 [debug] [Thread-2  ]: Writing injected SQL for node "model.ecommerce_dbt.stg_customer_logs"
[0m18:48:13.668784 [debug] [Thread-3  ]: Writing injected SQL for node "model.ecommerce_dbt.stg_sales"
[0m18:48:13.669288 [debug] [Thread-1  ]: Began executing node model.ecommerce_dbt.dim_product
[0m18:48:13.694090 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_dbt.dim_product"
[0m18:48:13.694777 [debug] [Thread-3  ]: Began executing node model.ecommerce_dbt.stg_sales
[0m18:48:13.695089 [debug] [Thread-2  ]: Began executing node model.ecommerce_dbt.stg_customer_logs
[0m18:48:13.697571 [debug] [Thread-3  ]: Writing runtime sql for node "model.ecommerce_dbt.stg_sales"
[0m18:48:13.699870 [debug] [Thread-2  ]: Writing runtime sql for node "model.ecommerce_dbt.stg_customer_logs"
[0m18:48:13.700197 [debug] [Thread-1  ]: On model.ecommerce_dbt.dim_product: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.dim_product"} */


  create or replace view `terraform-tutorial-430708`.`ecommerce_data_raw_reporting`.`dim_product`
  OPTIONS()
  as SELECT
    product_id,
    product_name,
    category,
    price
FROM `terraform-tutorial-430708`.`raw_data`.`product_catalog`;


[0m18:48:13.700674 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:48:13.701867 [debug] [Thread-3  ]: On model.ecommerce_dbt.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.stg_sales"} */


  create or replace view `terraform-tutorial-430708`.`ecommerce_data_raw_staging`.`stg_sales`
  OPTIONS()
  as WITH cleaned_sales AS (
    SELECT
        transaction_id,
        product_id,
        sale_date,
        quantity,
        price_per_unit
    FROM `terraform-tutorial-430708`.`raw_data`.`raw_sales_data`
    WHERE sale_date IS NOT NULL
)
SELECT * FROM cleaned_sales;


[0m18:48:13.702196 [debug] [Thread-2  ]: On model.ecommerce_dbt.stg_customer_logs: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.stg_customer_logs"} */


  create or replace view `terraform-tutorial-430708`.`ecommerce_data_raw_staging`.`stg_customer_logs`
  OPTIONS()
  as WITH cleaned_customer_logs AS (
    SELECT
        timestamp,
        user_id,
        event_type,
        product_id
    FROM `terraform-tutorial-430708`.`raw_data`.`customer_logs`
    WHERE user_id IS NOT NULL
)
SELECT * FROM cleaned_customer_logs;


[0m18:48:13.702530 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m18:48:13.702817 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m18:48:14.610912 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=terraform-tutorial-430708&j=bq:EU:cf3307f8-b8fa-4652-97d1-d994cf698862&page=queryresults
[0m18:48:14.613004 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=terraform-tutorial-430708&j=bq:EU:dcfd487a-424a-4d40-9774-d2b3ce027f91&page=queryresults
[0m18:48:14.613932 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=terraform-tutorial-430708&j=bq:EU:7b4b1e48-401a-47af-93a8-0aab8f3383ac&page=queryresults
[0m18:48:14.612213 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=terraform-tutorial-430708&j=bq:EU:cf3307f8-b8fa-4652-97d1-d994cf698862&page=queryresults
[0m18:48:14.614860 [error] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=terraform-tutorial-430708&j=bq:EU:dcfd487a-424a-4d40-9774-d2b3ce027f91&page=queryresults
[0m18:48:14.615577 [error] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=terraform-tutorial-430708&j=bq:EU:7b4b1e48-401a-47af-93a8-0aab8f3383ac&page=queryresults
[0m18:48:14.699171 [debug] [Thread-2  ]: Database Error in model stg_customer_logs (models/staging/stg_customer_logs.sql)
  Not found: Dataset terraform-tutorial-430708:raw_data was not found in location EU
  compiled code at target/run/ecommerce_dbt/models/staging/stg_customer_logs.sql
[0m18:48:14.699969 [debug] [Thread-3  ]: Database Error in model stg_sales (models/staging/stg_sales.sql)
  Not found: Dataset terraform-tutorial-430708:raw_data was not found in location EU
  compiled code at target/run/ecommerce_dbt/models/staging/stg_sales.sql
[0m18:48:14.701647 [debug] [Thread-1  ]: Database Error in model dim_product (models/marts/dim_product.sql)
  Not found: Dataset terraform-tutorial-430708:raw_data was not found in location EU
  compiled code at target/run/ecommerce_dbt/models/marts/dim_product.sql
[0m18:48:14.703160 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '551893f6-5cf0-4d93-afc2-bc36badcbae4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1030c31f0>]}
[0m18:48:14.703424 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '551893f6-5cf0-4d93-afc2-bc36badcbae4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e4444c0>]}
[0m18:48:14.703748 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '551893f6-5cf0-4d93-afc2-bc36badcbae4', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e431a90>]}
[0m18:48:14.704178 [error] [Thread-2  ]: 2 of 5 ERROR creating sql view model ecommerce_data_raw_staging.stg_customer_logs  [[31mERROR[0m in 1.05s]
[0m18:48:14.704665 [error] [Thread-3  ]: 3 of 5 ERROR creating sql view model ecommerce_data_raw_staging.stg_sales ...... [[31mERROR[0m in 1.05s]
[0m18:48:14.705508 [debug] [Thread-2  ]: Finished running node model.ecommerce_dbt.stg_customer_logs
[0m18:48:14.705043 [error] [Thread-1  ]: 1 of 5 ERROR creating sql view model ecommerce_data_raw_reporting.dim_product .. [[31mERROR[0m in 1.05s]
[0m18:48:14.705943 [debug] [Thread-3  ]: Finished running node model.ecommerce_dbt.stg_sales
[0m18:48:14.706345 [debug] [Thread-7  ]: Marking all children of 'model.ecommerce_dbt.stg_customer_logs' to be skipped because of status 'error'.  Reason: Database Error in model stg_customer_logs (models/staging/stg_customer_logs.sql)
  Not found: Dataset terraform-tutorial-430708:raw_data was not found in location EU
  compiled code at target/run/ecommerce_dbt/models/staging/stg_customer_logs.sql.
[0m18:48:14.706698 [debug] [Thread-1  ]: Finished running node model.ecommerce_dbt.dim_product
[0m18:48:14.707132 [debug] [Thread-7  ]: Marking all children of 'model.ecommerce_dbt.stg_sales' to be skipped because of status 'error'.  Reason: Database Error in model stg_sales (models/staging/stg_sales.sql)
  Not found: Dataset terraform-tutorial-430708:raw_data was not found in location EU
  compiled code at target/run/ecommerce_dbt/models/staging/stg_sales.sql.
[0m18:48:14.707474 [debug] [Thread-4  ]: Began running node model.ecommerce_dbt.fact_customer_activity
[0m18:48:14.707857 [debug] [Thread-7  ]: Marking all children of 'model.ecommerce_dbt.dim_product' to be skipped because of status 'error'.  Reason: Database Error in model dim_product (models/marts/dim_product.sql)
  Not found: Dataset terraform-tutorial-430708:raw_data was not found in location EU
  compiled code at target/run/ecommerce_dbt/models/marts/dim_product.sql.
[0m18:48:14.708179 [info ] [Thread-4  ]: 4 of 5 SKIP relation ecommerce_data_raw_reporting.fact_customer_activity ....... [[33mSKIP[0m]
[0m18:48:14.708659 [debug] [Thread-3  ]: Began running node model.ecommerce_dbt.fact_sales
[0m18:48:14.709100 [debug] [Thread-4  ]: Finished running node model.ecommerce_dbt.fact_customer_activity
[0m18:48:14.709451 [info ] [Thread-3  ]: 5 of 5 SKIP relation ecommerce_data_raw_reporting.fact_sales ................... [[33mSKIP[0m]
[0m18:48:14.709976 [debug] [Thread-3  ]: Finished running node model.ecommerce_dbt.fact_sales
[0m18:48:14.710874 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:48:14.711417 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:48:14.711635 [debug] [MainThread]: Connection 'create_terraform-tutorial-430708_ecommerce_data_raw_staging' was properly closed.
[0m18:48:14.711835 [debug] [MainThread]: Connection 'create_terraform-tutorial-430708_ecommerce_data_raw_reporting' was properly closed.
[0m18:48:14.712045 [debug] [MainThread]: Connection 'model.ecommerce_dbt.dim_product' was properly closed.
[0m18:48:14.712237 [debug] [MainThread]: Connection 'model.ecommerce_dbt.stg_customer_logs' was properly closed.
[0m18:48:14.712437 [debug] [MainThread]: Connection 'model.ecommerce_dbt.stg_sales' was properly closed.
[0m18:48:14.712829 [info ] [MainThread]: 
[0m18:48:14.713112 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 8.16 seconds (8.16s).
[0m18:48:14.713835 [debug] [MainThread]: Command end result
[0m18:48:14.738329 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jandytenedora/Interview/python-interview-gpt-question/dbt/ecommerce_dbt/target/manifest.json
[0m18:48:14.739774 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jandytenedora/Interview/python-interview-gpt-question/dbt/ecommerce_dbt/target/semantic_manifest.json
[0m18:48:14.745080 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/jandytenedora/Interview/python-interview-gpt-question/dbt/ecommerce_dbt/target/run_results.json
[0m18:48:14.745354 [info ] [MainThread]: 
[0m18:48:14.745651 [info ] [MainThread]: [31mCompleted with 3 errors, 0 partial successes, and 0 warnings:[0m
[0m18:48:14.745882 [info ] [MainThread]: 
[0m18:48:14.746151 [error] [MainThread]:   Database Error in model stg_customer_logs (models/staging/stg_customer_logs.sql)
  Not found: Dataset terraform-tutorial-430708:raw_data was not found in location EU
  compiled code at target/run/ecommerce_dbt/models/staging/stg_customer_logs.sql
[0m18:48:14.746370 [info ] [MainThread]: 
[0m18:48:14.746622 [error] [MainThread]:   Database Error in model stg_sales (models/staging/stg_sales.sql)
  Not found: Dataset terraform-tutorial-430708:raw_data was not found in location EU
  compiled code at target/run/ecommerce_dbt/models/staging/stg_sales.sql
[0m18:48:14.746832 [info ] [MainThread]: 
[0m18:48:14.747131 [error] [MainThread]:   Database Error in model dim_product (models/marts/dim_product.sql)
  Not found: Dataset terraform-tutorial-430708:raw_data was not found in location EU
  compiled code at target/run/ecommerce_dbt/models/marts/dim_product.sql
[0m18:48:14.747444 [info ] [MainThread]: 
[0m18:48:14.747767 [info ] [MainThread]: Done. PASS=0 WARN=0 ERROR=3 SKIP=2 TOTAL=5
[0m18:48:14.749273 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 10.093697, "process_in_blocks": "0", "process_kernel_time": 0.459655, "process_mem_max_rss": "195805184", "process_out_blocks": "0", "process_user_time": 2.181425}
[0m18:48:14.749607 [debug] [MainThread]: Command `dbt run` failed at 18:48:14.749540 after 10.09 seconds
[0m18:48:14.749905 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102f42040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1020461f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10de16160>]}
[0m18:48:14.750199 [debug] [MainThread]: Flushing usage events
[0m18:48:16.290653 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:50:15.089339 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d4dfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1135d9e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1135d91c0>]}


============================== 18:50:15.093689 | 043182b8-0538-49f9-b9ee-a7b09cec2b79 ==============================
[0m18:50:15.093689 [info ] [MainThread]: Running with dbt=1.9.1
[0m18:50:15.094141 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/jandytenedora/.dbt', 'log_path': '/Users/jandytenedora/Interview/python-interview-gpt-question/dbt/ecommerce_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:50:15.947321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '043182b8-0538-49f9-b9ee-a7b09cec2b79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1233e48b0>]}
[0m18:50:15.989152 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '043182b8-0538-49f9-b9ee-a7b09cec2b79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112fedf10>]}
[0m18:50:15.989641 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m18:50:16.100178 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m18:50:16.272974 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 4 files changed.
[0m18:50:16.273803 [debug] [MainThread]: Partial parsing: updated file: ecommerce_dbt://models/staging/schema.yml
[0m18:50:16.274081 [debug] [MainThread]: Partial parsing: updated file: ecommerce_dbt://models/staging/stg_customer_logs.sql
[0m18:50:16.274324 [debug] [MainThread]: Partial parsing: updated file: ecommerce_dbt://models/marts/dim_product.sql
[0m18:50:16.274555 [debug] [MainThread]: Partial parsing: updated file: ecommerce_dbt://models/staging/stg_sales.sql
[0m18:50:16.669924 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '043182b8-0538-49f9-b9ee-a7b09cec2b79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124778130>]}
[0m18:50:16.750449 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jandytenedora/Interview/python-interview-gpt-question/dbt/ecommerce_dbt/target/manifest.json
[0m18:50:16.754061 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jandytenedora/Interview/python-interview-gpt-question/dbt/ecommerce_dbt/target/semantic_manifest.json
[0m18:50:16.768032 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '043182b8-0538-49f9-b9ee-a7b09cec2b79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124723b20>]}
[0m18:50:16.768434 [info ] [MainThread]: Found 5 models, 7 data tests, 3 sources, 489 macros
[0m18:50:16.768692 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '043182b8-0538-49f9-b9ee-a7b09cec2b79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121be6460>]}
[0m18:50:16.769889 [info ] [MainThread]: 
[0m18:50:16.770151 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:50:16.770359 [info ] [MainThread]: 
[0m18:50:16.770699 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:50:16.774250 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_terraform-tutorial-430708'
[0m18:50:16.774751 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_terraform-tutorial-430708'
[0m18:50:16.775044 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:50:16.775336 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:50:20.092465 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_terraform-tutorial-430708, now list_terraform-tutorial-430708_ecommerce_data_raw_reporting)
[0m18:50:20.094016 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_terraform-tutorial-430708, now list_terraform-tutorial-430708_ecommerce_data_raw_staging)
[0m18:50:20.094789 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:50:20.095346 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:50:20.911291 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '043182b8-0538-49f9-b9ee-a7b09cec2b79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104826040>]}
[0m18:50:20.912404 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:50:20.914859 [debug] [Thread-1  ]: Began running node model.ecommerce_dbt.dim_product
[0m18:50:20.915325 [debug] [Thread-2  ]: Began running node model.ecommerce_dbt.stg_customer_logs
[0m18:50:20.916264 [debug] [Thread-3  ]: Began running node model.ecommerce_dbt.stg_sales
[0m18:50:20.915920 [info ] [Thread-1  ]: 1 of 5 START sql view model ecommerce_data_raw_reporting.dim_product ........... [RUN]
[0m18:50:20.916862 [info ] [Thread-2  ]: 2 of 5 START sql view model ecommerce_data_raw_staging.stg_customer_logs ....... [RUN]
[0m18:50:20.917366 [info ] [Thread-3  ]: 3 of 5 START sql view model ecommerce_data_raw_staging.stg_sales ............... [RUN]
[0m18:50:20.917845 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_terraform-tutorial-430708_ecommerce_data_raw_reporting, now model.ecommerce_dbt.dim_product)
[0m18:50:20.918247 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_terraform-tutorial-430708_ecommerce_data_raw_staging, now model.ecommerce_dbt.stg_customer_logs)
[0m18:50:20.918729 [debug] [Thread-3  ]: Acquiring new bigquery connection 'model.ecommerce_dbt.stg_sales'
[0m18:50:20.919096 [debug] [Thread-1  ]: Began compiling node model.ecommerce_dbt.dim_product
[0m18:50:20.919425 [debug] [Thread-2  ]: Began compiling node model.ecommerce_dbt.stg_customer_logs
[0m18:50:20.919749 [debug] [Thread-3  ]: Began compiling node model.ecommerce_dbt.stg_sales
[0m18:50:20.929835 [debug] [Thread-2  ]: Writing injected SQL for node "model.ecommerce_dbt.stg_customer_logs"
[0m18:50:20.932222 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_dbt.dim_product"
[0m18:50:20.934719 [debug] [Thread-3  ]: Writing injected SQL for node "model.ecommerce_dbt.stg_sales"
[0m18:50:20.936790 [debug] [Thread-3  ]: Began executing node model.ecommerce_dbt.stg_sales
[0m18:50:20.956338 [debug] [Thread-2  ]: Began executing node model.ecommerce_dbt.stg_customer_logs
[0m18:50:20.956719 [debug] [Thread-1  ]: Began executing node model.ecommerce_dbt.dim_product
[0m18:50:20.961808 [debug] [Thread-3  ]: Writing runtime sql for node "model.ecommerce_dbt.stg_sales"
[0m18:50:20.965083 [debug] [Thread-2  ]: Writing runtime sql for node "model.ecommerce_dbt.stg_customer_logs"
[0m18:50:20.967361 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_dbt.dim_product"
[0m18:50:20.968772 [debug] [Thread-2  ]: On model.ecommerce_dbt.stg_customer_logs: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.stg_customer_logs"} */


  create or replace view `terraform-tutorial-430708`.`ecommerce_data_raw_staging`.`stg_customer_logs`
  OPTIONS()
  as WITH cleaned_customer_logs AS (
    SELECT
        timestamp,
        user_id,
        event_type,
        product_id
    FROM `terraform-tutorial-430708`.`ecommerce_data_raw`.`customer_logs`
    WHERE user_id IS NOT NULL
)
SELECT * FROM cleaned_customer_logs;


[0m18:50:20.969174 [debug] [Thread-3  ]: On model.ecommerce_dbt.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.stg_sales"} */


  create or replace view `terraform-tutorial-430708`.`ecommerce_data_raw_staging`.`stg_sales`
  OPTIONS()
  as WITH cleaned_sales AS (
    SELECT
        transaction_id,
        product_id,
        sale_date,
        quantity,
        price_per_unit
    FROM `terraform-tutorial-430708`.`ecommerce_data_raw`.`raw_sales_data`
    WHERE sale_date IS NOT NULL
)
SELECT * FROM cleaned_sales;


[0m18:50:20.969512 [debug] [Thread-1  ]: On model.ecommerce_dbt.dim_product: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.dim_product"} */


  create or replace view `terraform-tutorial-430708`.`ecommerce_data_raw_reporting`.`dim_product`
  OPTIONS()
  as SELECT
    product_id,
    product_name,
    category,
    price
FROM `terraform-tutorial-430708`.`ecommerce_data_raw`.`product_catalog`;


[0m18:50:20.969844 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m18:50:20.970103 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m18:50:20.971149 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:50:21.848046 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=terraform-tutorial-430708&j=bq:EU:aac1c81b-b0e6-47a9-9f44-05e6ef40ac16&page=queryresults
[0m18:50:21.849871 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=terraform-tutorial-430708&j=bq:EU:939284eb-1a18-4b79-997e-3264db1258f7&page=queryresults
[0m18:50:21.852963 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=terraform-tutorial-430708&j=bq:EU:0c39100e-6b07-46e0-80df-b707fed1642d&page=queryresults
[0m18:50:22.249956 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=terraform-tutorial-430708&j=bq:EU:aac1c81b-b0e6-47a9-9f44-05e6ef40ac16&page=queryresults
[0m18:50:22.292488 [debug] [Thread-1  ]: Database Error in model dim_product (models/marts/dim_product.sql)
  Unrecognized name: product_name; Did you mean product_id? at [8:5]
  compiled code at target/run/ecommerce_dbt/models/marts/dim_product.sql
[0m18:50:22.294332 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '043182b8-0538-49f9-b9ee-a7b09cec2b79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110c7b9a0>]}
[0m18:50:22.294899 [error] [Thread-1  ]: 1 of 5 ERROR creating sql view model ecommerce_data_raw_reporting.dim_product .. [[31mERROR[0m in 1.38s]
[0m18:50:22.295335 [debug] [Thread-1  ]: Finished running node model.ecommerce_dbt.dim_product
[0m18:50:22.295737 [debug] [Thread-7  ]: Marking all children of 'model.ecommerce_dbt.dim_product' to be skipped because of status 'error'.  Reason: Database Error in model dim_product (models/marts/dim_product.sql)
  Unrecognized name: product_name; Did you mean product_id? at [8:5]
  compiled code at target/run/ecommerce_dbt/models/marts/dim_product.sql.
[0m18:50:22.735836 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '043182b8-0538-49f9-b9ee-a7b09cec2b79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123367370>]}
[0m18:50:22.736317 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '043182b8-0538-49f9-b9ee-a7b09cec2b79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x12493bf40>]}
[0m18:50:22.736865 [info ] [Thread-3  ]: 3 of 5 OK created sql view model ecommerce_data_raw_staging.stg_sales .......... [[32mCREATE VIEW (0 processed)[0m in 1.82s]
[0m18:50:22.737717 [debug] [Thread-3  ]: Finished running node model.ecommerce_dbt.stg_sales
[0m18:50:22.737273 [info ] [Thread-2  ]: 2 of 5 OK created sql view model ecommerce_data_raw_staging.stg_customer_logs .. [[32mCREATE VIEW (0 processed)[0m in 1.82s]
[0m18:50:22.738249 [debug] [Thread-2  ]: Finished running node model.ecommerce_dbt.stg_customer_logs
[0m18:50:22.738603 [debug] [Thread-4  ]: Began running node model.ecommerce_dbt.fact_sales
[0m18:50:22.738959 [info ] [Thread-4  ]: 4 of 5 START sql view model ecommerce_data_raw_reporting.fact_sales ............ [RUN]
[0m18:50:22.739268 [debug] [Thread-3  ]: Began running node model.ecommerce_dbt.fact_customer_activity
[0m18:50:22.739630 [debug] [Thread-4  ]: Acquiring new bigquery connection 'model.ecommerce_dbt.fact_sales'
[0m18:50:22.739989 [info ] [Thread-3  ]: 5 of 5 START sql view model ecommerce_data_raw_reporting.fact_customer_activity  [RUN]
[0m18:50:22.740291 [debug] [Thread-4  ]: Began compiling node model.ecommerce_dbt.fact_sales
[0m18:50:22.740576 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.ecommerce_dbt.stg_sales, now model.ecommerce_dbt.fact_customer_activity)
[0m18:50:22.742989 [debug] [Thread-4  ]: Writing injected SQL for node "model.ecommerce_dbt.fact_sales"
[0m18:50:22.743278 [debug] [Thread-3  ]: Began compiling node model.ecommerce_dbt.fact_customer_activity
[0m18:50:22.745513 [debug] [Thread-3  ]: Writing injected SQL for node "model.ecommerce_dbt.fact_customer_activity"
[0m18:50:22.745972 [debug] [Thread-4  ]: Began executing node model.ecommerce_dbt.fact_sales
[0m18:50:22.748430 [debug] [Thread-4  ]: Writing runtime sql for node "model.ecommerce_dbt.fact_sales"
[0m18:50:22.748840 [debug] [Thread-3  ]: Began executing node model.ecommerce_dbt.fact_customer_activity
[0m18:50:22.811186 [debug] [Thread-3  ]: Writing runtime sql for node "model.ecommerce_dbt.fact_customer_activity"
[0m18:50:22.811788 [debug] [Thread-4  ]: On model.ecommerce_dbt.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.fact_sales"} */


  create or replace view `terraform-tutorial-430708`.`ecommerce_data_raw_reporting`.`fact_sales`
  OPTIONS()
  as SELECT
    sale_date,
    product_id,
    SUM(quantity) AS total_quantity,
    SUM(quantity * price_per_unit) AS total_revenue
FROM `terraform-tutorial-430708`.`ecommerce_data_raw_staging`.`stg_sales`
GROUP BY
sale_date, product_id;


[0m18:50:22.812166 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m18:50:22.812484 [debug] [Thread-3  ]: On model.ecommerce_dbt.fact_customer_activity: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.fact_customer_activity"} */


  create or replace view `terraform-tutorial-430708`.`ecommerce_data_raw_reporting`.`fact_customer_activity`
  OPTIONS()
  as SELECT
    user_id,
    DATE(timestamp) AS activity_date,
    COUNT(CASE WHEN event_type == 'view' THEN 1) AS views,
    COUNT(CASE WHEN event_type == 'clicks' THEN 1) AS clicks,
    COUNT(CASE WHEN event_type == 'purchases' THEN 1) AS purchases,
FROM `terraform-tutorial-430708`.`ecommerce_data_raw_staging`.`stg_customer_logs`
GROUP BY user_id, product_id, DATE(timestamp);


[0m18:50:22.813524 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m18:50:24.112145 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=terraform-tutorial-430708&j=bq:EU:16c9d180-c172-4821-89ce-9b2a97f938c6&page=queryresults
[0m18:50:24.113241 [error] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=terraform-tutorial-430708&j=bq:EU:16c9d180-c172-4821-89ce-9b2a97f938c6&page=queryresults
[0m18:50:24.129607 [debug] [Thread-3  ]: Database Error in model fact_customer_activity (models/marts/fact_customer_activity.sql)
  Syntax error: Unexpected "=" at [9:33]
  compiled code at target/run/ecommerce_dbt/models/marts/fact_customer_activity.sql
[0m18:50:24.130243 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '043182b8-0538-49f9-b9ee-a7b09cec2b79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1248d26a0>]}
[0m18:50:24.130926 [error] [Thread-3  ]: 5 of 5 ERROR creating sql view model ecommerce_data_raw_reporting.fact_customer_activity  [[31mERROR[0m in 1.39s]
[0m18:50:24.131493 [debug] [Thread-3  ]: Finished running node model.ecommerce_dbt.fact_customer_activity
[0m18:50:24.131979 [debug] [Thread-7  ]: Marking all children of 'model.ecommerce_dbt.fact_customer_activity' to be skipped because of status 'error'.  Reason: Database Error in model fact_customer_activity (models/marts/fact_customer_activity.sql)
  Syntax error: Unexpected "=" at [9:33]
  compiled code at target/run/ecommerce_dbt/models/marts/fact_customer_activity.sql.
[0m18:50:24.642297 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=terraform-tutorial-430708&j=bq:EU:cb3b09f5-f12c-48cc-91ef-2e6cfc1c1522&page=queryresults
[0m18:50:25.331708 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '043182b8-0538-49f9-b9ee-a7b09cec2b79', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124d7bf40>]}
[0m18:50:25.334307 [info ] [Thread-4  ]: 4 of 5 OK created sql view model ecommerce_data_raw_reporting.fact_sales ....... [[32mCREATE VIEW (0 processed)[0m in 2.59s]
[0m18:50:25.335256 [debug] [Thread-4  ]: Finished running node model.ecommerce_dbt.fact_sales
[0m18:50:25.337198 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:50:25.338178 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:50:25.338617 [debug] [MainThread]: Connection 'model.ecommerce_dbt.dim_product' was properly closed.
[0m18:50:25.339011 [debug] [MainThread]: Connection 'model.ecommerce_dbt.stg_customer_logs' was properly closed.
[0m18:50:25.339341 [debug] [MainThread]: Connection 'model.ecommerce_dbt.fact_customer_activity' was properly closed.
[0m18:50:25.339664 [debug] [MainThread]: Connection 'model.ecommerce_dbt.fact_sales' was properly closed.
[0m18:50:25.340111 [info ] [MainThread]: 
[0m18:50:25.340499 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 8.57 seconds (8.57s).
[0m18:50:25.341921 [debug] [MainThread]: Command end result
[0m18:50:25.370427 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jandytenedora/Interview/python-interview-gpt-question/dbt/ecommerce_dbt/target/manifest.json
[0m18:50:25.372342 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jandytenedora/Interview/python-interview-gpt-question/dbt/ecommerce_dbt/target/semantic_manifest.json
[0m18:50:25.378190 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/jandytenedora/Interview/python-interview-gpt-question/dbt/ecommerce_dbt/target/run_results.json
[0m18:50:25.378475 [info ] [MainThread]: 
[0m18:50:25.378768 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m18:50:25.379004 [info ] [MainThread]: 
[0m18:50:25.379295 [error] [MainThread]:   Database Error in model dim_product (models/marts/dim_product.sql)
  Unrecognized name: product_name; Did you mean product_id? at [8:5]
  compiled code at target/run/ecommerce_dbt/models/marts/dim_product.sql
[0m18:50:25.379521 [info ] [MainThread]: 
[0m18:50:25.379774 [error] [MainThread]:   Database Error in model fact_customer_activity (models/marts/fact_customer_activity.sql)
  Syntax error: Unexpected "=" at [9:33]
  compiled code at target/run/ecommerce_dbt/models/marts/fact_customer_activity.sql
[0m18:50:25.379989 [info ] [MainThread]: 
[0m18:50:25.380223 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=2 SKIP=0 TOTAL=5
[0m18:50:25.381661 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 10.353778, "process_in_blocks": "0", "process_kernel_time": 0.387503, "process_mem_max_rss": "205766656", "process_out_blocks": "0", "process_user_time": 2.499915}
[0m18:50:25.382028 [debug] [MainThread]: Command `dbt run` failed at 18:50:25.381959 after 10.35 seconds
[0m18:50:25.382343 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x111d4dfd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x112903cd0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1243dda90>]}
[0m18:50:25.382653 [debug] [MainThread]: Flushing usage events
[0m18:50:27.242564 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:51:39.074729 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041a9fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106459d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106459f40>]}


============================== 18:51:39.078996 | 8c879961-3459-4678-bc7f-9d5cfac29cf3 ==============================
[0m18:51:39.078996 [info ] [MainThread]: Running with dbt=1.9.1
[0m18:51:39.079462 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/jandytenedora/Interview/python-interview-gpt-question/dbt/ecommerce_dbt/logs', 'version_check': 'True', 'profiles_dir': '/Users/jandytenedora/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:51:39.934113 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8c879961-3459-4678-bc7f-9d5cfac29cf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e327970>]}
[0m18:51:39.976570 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8c879961-3459-4678-bc7f-9d5cfac29cf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10643e250>]}
[0m18:51:39.977109 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m18:51:40.085304 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m18:51:40.258777 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 2 files changed.
[0m18:51:40.259327 [debug] [MainThread]: Partial parsing: updated file: ecommerce_dbt://models/marts/dim_product.sql
[0m18:51:40.259677 [debug] [MainThread]: Partial parsing: updated file: ecommerce_dbt://models/marts/fact_customer_activity.sql
[0m18:51:40.584186 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8c879961-3459-4678-bc7f-9d5cfac29cf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f568f70>]}
[0m18:51:40.666325 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jandytenedora/Interview/python-interview-gpt-question/dbt/ecommerce_dbt/target/manifest.json
[0m18:51:40.669439 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jandytenedora/Interview/python-interview-gpt-question/dbt/ecommerce_dbt/target/semantic_manifest.json
[0m18:51:40.683356 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8c879961-3459-4678-bc7f-9d5cfac29cf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f583490>]}
[0m18:51:40.683789 [info ] [MainThread]: Found 5 models, 7 data tests, 3 sources, 489 macros
[0m18:51:40.684066 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c879961-3459-4678-bc7f-9d5cfac29cf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10dd68370>]}
[0m18:51:40.685226 [info ] [MainThread]: 
[0m18:51:40.685512 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:51:40.685734 [info ] [MainThread]: 
[0m18:51:40.686089 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:51:40.689549 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_terraform-tutorial-430708'
[0m18:51:40.689880 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:51:40.690202 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_terraform-tutorial-430708'
[0m18:51:40.690558 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:51:43.095650 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_terraform-tutorial-430708, now list_terraform-tutorial-430708_ecommerce_data_raw_staging)
[0m18:51:43.097042 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_terraform-tutorial-430708, now list_terraform-tutorial-430708_ecommerce_data_raw_reporting)
[0m18:51:43.097809 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:51:43.098364 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:51:43.976607 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8c879961-3459-4678-bc7f-9d5cfac29cf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102967af0>]}
[0m18:51:43.977556 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:51:43.980136 [debug] [Thread-1  ]: Began running node model.ecommerce_dbt.dim_product
[0m18:51:43.980665 [debug] [Thread-2  ]: Began running node model.ecommerce_dbt.stg_customer_logs
[0m18:51:43.981768 [debug] [Thread-3  ]: Began running node model.ecommerce_dbt.stg_sales
[0m18:51:43.981388 [info ] [Thread-1  ]: 1 of 5 START sql view model ecommerce_data_raw_reporting.dim_product ........... [RUN]
[0m18:51:43.982406 [info ] [Thread-2  ]: 2 of 5 START sql view model ecommerce_data_raw_staging.stg_customer_logs ....... [RUN]
[0m18:51:43.982934 [info ] [Thread-3  ]: 3 of 5 START sql view model ecommerce_data_raw_staging.stg_sales ............... [RUN]
[0m18:51:43.983613 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_terraform-tutorial-430708_ecommerce_data_raw_staging, now model.ecommerce_dbt.dim_product)
[0m18:51:43.984198 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_terraform-tutorial-430708_ecommerce_data_raw_reporting, now model.ecommerce_dbt.stg_customer_logs)
[0m18:51:43.984825 [debug] [Thread-3  ]: Acquiring new bigquery connection 'model.ecommerce_dbt.stg_sales'
[0m18:51:43.985285 [debug] [Thread-1  ]: Began compiling node model.ecommerce_dbt.dim_product
[0m18:51:43.985674 [debug] [Thread-2  ]: Began compiling node model.ecommerce_dbt.stg_customer_logs
[0m18:51:43.986024 [debug] [Thread-3  ]: Began compiling node model.ecommerce_dbt.stg_sales
[0m18:51:43.996118 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_dbt.dim_product"
[0m18:51:43.999094 [debug] [Thread-2  ]: Writing injected SQL for node "model.ecommerce_dbt.stg_customer_logs"
[0m18:51:44.001718 [debug] [Thread-3  ]: Writing injected SQL for node "model.ecommerce_dbt.stg_sales"
[0m18:51:44.003827 [debug] [Thread-3  ]: Began executing node model.ecommerce_dbt.stg_sales
[0m18:51:44.009853 [debug] [Thread-1  ]: Began executing node model.ecommerce_dbt.dim_product
[0m18:51:44.028530 [debug] [Thread-2  ]: Began executing node model.ecommerce_dbt.stg_customer_logs
[0m18:51:44.039969 [debug] [Thread-3  ]: Writing runtime sql for node "model.ecommerce_dbt.stg_sales"
[0m18:51:44.042548 [debug] [Thread-2  ]: Writing runtime sql for node "model.ecommerce_dbt.stg_customer_logs"
[0m18:51:44.043481 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_dbt.dim_product"
[0m18:51:44.044481 [debug] [Thread-1  ]: On model.ecommerce_dbt.dim_product: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.dim_product"} */


  create or replace view `terraform-tutorial-430708`.`ecommerce_data_raw_reporting`.`dim_product`
  OPTIONS()
  as SELECT
    product_id,
    category,
    price
FROM `terraform-tutorial-430708`.`ecommerce_data_raw`.`product_catalog`;


[0m18:51:44.044884 [debug] [Thread-2  ]: On model.ecommerce_dbt.stg_customer_logs: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.stg_customer_logs"} */


  create or replace view `terraform-tutorial-430708`.`ecommerce_data_raw_staging`.`stg_customer_logs`
  OPTIONS()
  as WITH cleaned_customer_logs AS (
    SELECT
        timestamp,
        user_id,
        event_type,
        product_id
    FROM `terraform-tutorial-430708`.`ecommerce_data_raw`.`customer_logs`
    WHERE user_id IS NOT NULL
)
SELECT * FROM cleaned_customer_logs;


[0m18:51:44.045250 [debug] [Thread-3  ]: On model.ecommerce_dbt.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.stg_sales"} */


  create or replace view `terraform-tutorial-430708`.`ecommerce_data_raw_staging`.`stg_sales`
  OPTIONS()
  as WITH cleaned_sales AS (
    SELECT
        transaction_id,
        product_id,
        sale_date,
        quantity,
        price_per_unit
    FROM `terraform-tutorial-430708`.`ecommerce_data_raw`.`raw_sales_data`
    WHERE sale_date IS NOT NULL
)
SELECT * FROM cleaned_sales;


[0m18:51:44.045599 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:51:44.045887 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m18:51:44.046167 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m18:51:44.945188 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=terraform-tutorial-430708&j=bq:EU:f2055684-f708-4570-8999-e2459cdbe86d&page=queryresults
[0m18:51:44.946085 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=terraform-tutorial-430708&j=bq:EU:2dfce3de-27ae-4d77-a160-bfab1adeb384&page=queryresults
[0m18:51:44.976309 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=terraform-tutorial-430708&j=bq:EU:cdb61ea5-a803-49eb-871b-091f7acc512b&page=queryresults
[0m18:51:45.121415 [error] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=terraform-tutorial-430708&j=bq:EU:2dfce3de-27ae-4d77-a160-bfab1adeb384&page=queryresults
[0m18:51:45.165973 [debug] [Thread-1  ]: Database Error in model dim_product (models/marts/dim_product.sql)
  Unrecognized name: price; Did you mean device? at [9:5]
  compiled code at target/run/ecommerce_dbt/models/marts/dim_product.sql
[0m18:51:45.167787 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c879961-3459-4678-bc7f-9d5cfac29cf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f5ffe20>]}
[0m18:51:45.168339 [error] [Thread-1  ]: 1 of 5 ERROR creating sql view model ecommerce_data_raw_reporting.dim_product .. [[31mERROR[0m in 1.18s]
[0m18:51:45.168767 [debug] [Thread-1  ]: Finished running node model.ecommerce_dbt.dim_product
[0m18:51:45.169188 [debug] [Thread-7  ]: Marking all children of 'model.ecommerce_dbt.dim_product' to be skipped because of status 'error'.  Reason: Database Error in model dim_product (models/marts/dim_product.sql)
  Unrecognized name: price; Did you mean device? at [9:5]
  compiled code at target/run/ecommerce_dbt/models/marts/dim_product.sql.
[0m18:51:45.334335 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c879961-3459-4678-bc7f-9d5cfac29cf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1062c90d0>]}
[0m18:51:45.334934 [info ] [Thread-3  ]: 3 of 5 OK created sql view model ecommerce_data_raw_staging.stg_sales .......... [[32mCREATE VIEW (0 processed)[0m in 1.35s]
[0m18:51:45.335389 [debug] [Thread-3  ]: Finished running node model.ecommerce_dbt.stg_sales
[0m18:51:45.335815 [debug] [Thread-4  ]: Began running node model.ecommerce_dbt.fact_sales
[0m18:51:45.336163 [info ] [Thread-4  ]: 4 of 5 START sql view model ecommerce_data_raw_reporting.fact_sales ............ [RUN]
[0m18:51:45.336549 [debug] [Thread-4  ]: Acquiring new bigquery connection 'model.ecommerce_dbt.fact_sales'
[0m18:51:45.336812 [debug] [Thread-4  ]: Began compiling node model.ecommerce_dbt.fact_sales
[0m18:51:45.339518 [debug] [Thread-4  ]: Writing injected SQL for node "model.ecommerce_dbt.fact_sales"
[0m18:51:45.340639 [debug] [Thread-4  ]: Began executing node model.ecommerce_dbt.fact_sales
[0m18:51:45.343919 [debug] [Thread-4  ]: Writing runtime sql for node "model.ecommerce_dbt.fact_sales"
[0m18:51:45.345353 [debug] [Thread-4  ]: On model.ecommerce_dbt.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.fact_sales"} */


  create or replace view `terraform-tutorial-430708`.`ecommerce_data_raw_reporting`.`fact_sales`
  OPTIONS()
  as SELECT
    sale_date,
    product_id,
    SUM(quantity) AS total_quantity,
    SUM(quantity * price_per_unit) AS total_revenue
FROM `terraform-tutorial-430708`.`ecommerce_data_raw_staging`.`stg_sales`
GROUP BY
sale_date, product_id;


[0m18:51:45.345741 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m18:51:45.420948 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c879961-3459-4678-bc7f-9d5cfac29cf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f71e0a0>]}
[0m18:51:45.421599 [info ] [Thread-2  ]: 2 of 5 OK created sql view model ecommerce_data_raw_staging.stg_customer_logs .. [[32mCREATE VIEW (0 processed)[0m in 1.44s]
[0m18:51:45.422044 [debug] [Thread-2  ]: Finished running node model.ecommerce_dbt.stg_customer_logs
[0m18:51:45.422458 [debug] [Thread-3  ]: Began running node model.ecommerce_dbt.fact_customer_activity
[0m18:51:45.422807 [info ] [Thread-3  ]: 5 of 5 START sql view model ecommerce_data_raw_reporting.fact_customer_activity  [RUN]
[0m18:51:45.423124 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.ecommerce_dbt.stg_sales, now model.ecommerce_dbt.fact_customer_activity)
[0m18:51:45.423398 [debug] [Thread-3  ]: Began compiling node model.ecommerce_dbt.fact_customer_activity
[0m18:51:45.426057 [debug] [Thread-3  ]: Writing injected SQL for node "model.ecommerce_dbt.fact_customer_activity"
[0m18:51:45.426877 [debug] [Thread-3  ]: Began executing node model.ecommerce_dbt.fact_customer_activity
[0m18:51:45.429576 [debug] [Thread-3  ]: Writing runtime sql for node "model.ecommerce_dbt.fact_customer_activity"
[0m18:51:45.430289 [debug] [Thread-3  ]: On model.ecommerce_dbt.fact_customer_activity: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.fact_customer_activity"} */


  create or replace view `terraform-tutorial-430708`.`ecommerce_data_raw_reporting`.`fact_customer_activity`
  OPTIONS()
  as SELECT
    user_id,
    DATE(timestamp) AS activity_date,
    COUNT(CASE WHEN event_type == 'view' THEN 1) AS views,
    COUNT(CASE WHEN event_type == 'clicks' THEN 1) AS clicks,
    COUNT(CASE WHEN event_type == 'purchases' THEN 1) AS purchases,
FROM `terraform-tutorial-430708`.`ecommerce_data_raw_staging`.`stg_customer_logs`
GROUP BY user_id, product_id, activity_date;


[0m18:51:45.430627 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m18:51:46.122436 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=terraform-tutorial-430708&j=bq:EU:72a786b0-d71f-4f0f-91df-708343ba44d3&page=queryresults
[0m18:51:46.124129 [error] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=terraform-tutorial-430708&j=bq:EU:72a786b0-d71f-4f0f-91df-708343ba44d3&page=queryresults
[0m18:51:46.141816 [debug] [Thread-3  ]: Database Error in model fact_customer_activity (models/marts/fact_customer_activity.sql)
  Syntax error: Unexpected "=" at [9:33]
  compiled code at target/run/ecommerce_dbt/models/marts/fact_customer_activity.sql
[0m18:51:46.142556 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c879961-3459-4678-bc7f-9d5cfac29cf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f5ffee0>]}
[0m18:51:46.143344 [error] [Thread-3  ]: 5 of 5 ERROR creating sql view model ecommerce_data_raw_reporting.fact_customer_activity  [[31mERROR[0m in 0.72s]
[0m18:51:46.143933 [debug] [Thread-3  ]: Finished running node model.ecommerce_dbt.fact_customer_activity
[0m18:51:46.144427 [debug] [Thread-7  ]: Marking all children of 'model.ecommerce_dbt.fact_customer_activity' to be skipped because of status 'error'.  Reason: Database Error in model fact_customer_activity (models/marts/fact_customer_activity.sql)
  Syntax error: Unexpected "=" at [9:33]
  compiled code at target/run/ecommerce_dbt/models/marts/fact_customer_activity.sql.
[0m18:51:46.447938 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=terraform-tutorial-430708&j=bq:EU:88c48ac0-6de9-43ce-a0aa-fb4bf12d7e42&page=queryresults
[0m18:51:46.798321 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '8c879961-3459-4678-bc7f-9d5cfac29cf3', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fb61ca0>]}
[0m18:51:46.799598 [info ] [Thread-4  ]: 4 of 5 OK created sql view model ecommerce_data_raw_reporting.fact_sales ....... [[32mCREATE VIEW (0 processed)[0m in 1.46s]
[0m18:51:46.800606 [debug] [Thread-4  ]: Finished running node model.ecommerce_dbt.fact_sales
[0m18:51:46.802234 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:51:46.803142 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:51:46.803679 [debug] [MainThread]: Connection 'model.ecommerce_dbt.dim_product' was properly closed.
[0m18:51:46.804140 [debug] [MainThread]: Connection 'model.ecommerce_dbt.stg_customer_logs' was properly closed.
[0m18:51:46.804557 [debug] [MainThread]: Connection 'model.ecommerce_dbt.fact_customer_activity' was properly closed.
[0m18:51:46.804954 [debug] [MainThread]: Connection 'model.ecommerce_dbt.fact_sales' was properly closed.
[0m18:51:46.805501 [info ] [MainThread]: 
[0m18:51:46.806024 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 6.12 seconds (6.12s).
[0m18:51:46.807667 [debug] [MainThread]: Command end result
[0m18:51:46.896481 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jandytenedora/Interview/python-interview-gpt-question/dbt/ecommerce_dbt/target/manifest.json
[0m18:51:46.898778 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jandytenedora/Interview/python-interview-gpt-question/dbt/ecommerce_dbt/target/semantic_manifest.json
[0m18:51:46.904136 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/jandytenedora/Interview/python-interview-gpt-question/dbt/ecommerce_dbt/target/run_results.json
[0m18:51:46.904407 [info ] [MainThread]: 
[0m18:51:46.904697 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m18:51:46.904938 [info ] [MainThread]: 
[0m18:51:46.905208 [error] [MainThread]:   Database Error in model dim_product (models/marts/dim_product.sql)
  Unrecognized name: price; Did you mean device? at [9:5]
  compiled code at target/run/ecommerce_dbt/models/marts/dim_product.sql
[0m18:51:46.905438 [info ] [MainThread]: 
[0m18:51:46.905695 [error] [MainThread]:   Database Error in model fact_customer_activity (models/marts/fact_customer_activity.sql)
  Syntax error: Unexpected "=" at [9:33]
  compiled code at target/run/ecommerce_dbt/models/marts/fact_customer_activity.sql
[0m18:51:46.905917 [info ] [MainThread]: 
[0m18:51:46.906155 [info ] [MainThread]: Done. PASS=3 WARN=0 ERROR=2 SKIP=0 TOTAL=5
[0m18:51:46.907581 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 7.891175, "process_in_blocks": "0", "process_kernel_time": 0.369449, "process_mem_max_rss": "197279744", "process_out_blocks": "0", "process_user_time": 2.442639}
[0m18:51:46.907879 [debug] [MainThread]: Command `dbt run` failed at 18:51:46.907822 after 7.89 seconds
[0m18:51:46.908167 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1041a9fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dca430>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f1b2c70>]}
[0m18:51:46.908472 [debug] [MainThread]: Flushing usage events
[0m18:51:47.991992 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:52:04.529459 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108039f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e8d3a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108e8d1c0>]}


============================== 18:52:04.533087 | 35b69a40-5477-446c-9dd5-4be820ab3932 ==============================
[0m18:52:04.533087 [info ] [MainThread]: Running with dbt=1.9.1
[0m18:52:04.533503 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jandytenedora/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/jandytenedora/Interview/python-interview-gpt-question/dbt/ecommerce_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt run', 'static_parser': 'True', 'log_format': 'default', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:52:05.339622 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '35b69a40-5477-446c-9dd5-4be820ab3932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fbf0580>]}
[0m18:52:05.383844 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '35b69a40-5477-446c-9dd5-4be820ab3932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fe06f10>]}
[0m18:52:05.384469 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m18:52:05.492778 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m18:52:05.662518 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:52:05.663053 [debug] [MainThread]: Partial parsing: updated file: ecommerce_dbt://models/marts/dim_product.sql
[0m18:52:05.867132 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '35b69a40-5477-446c-9dd5-4be820ab3932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118deddf0>]}
[0m18:52:05.947390 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jandytenedora/Interview/python-interview-gpt-question/dbt/ecommerce_dbt/target/manifest.json
[0m18:52:05.950141 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jandytenedora/Interview/python-interview-gpt-question/dbt/ecommerce_dbt/target/semantic_manifest.json
[0m18:52:05.964266 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '35b69a40-5477-446c-9dd5-4be820ab3932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1088d6d90>]}
[0m18:52:05.964697 [info ] [MainThread]: Found 5 models, 7 data tests, 3 sources, 489 macros
[0m18:52:05.964965 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '35b69a40-5477-446c-9dd5-4be820ab3932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fec8640>]}
[0m18:52:05.966155 [info ] [MainThread]: 
[0m18:52:05.966418 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:52:05.966633 [info ] [MainThread]: 
[0m18:52:05.966984 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:52:05.970415 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_terraform-tutorial-430708'
[0m18:52:05.970840 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:52:05.971303 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_terraform-tutorial-430708'
[0m18:52:05.971755 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:52:08.513213 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_terraform-tutorial-430708, now list_terraform-tutorial-430708_ecommerce_data_raw_reporting)
[0m18:52:08.514418 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_terraform-tutorial-430708, now list_terraform-tutorial-430708_ecommerce_data_raw_staging)
[0m18:52:08.515397 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:52:08.515844 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:52:09.062000 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '35b69a40-5477-446c-9dd5-4be820ab3932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118d41310>]}
[0m18:52:09.063029 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:52:09.065657 [debug] [Thread-1  ]: Began running node model.ecommerce_dbt.dim_product
[0m18:52:09.066166 [debug] [Thread-2  ]: Began running node model.ecommerce_dbt.stg_customer_logs
[0m18:52:09.067214 [debug] [Thread-3  ]: Began running node model.ecommerce_dbt.stg_sales
[0m18:52:09.066803 [info ] [Thread-1  ]: 1 of 5 START sql view model ecommerce_data_raw_reporting.dim_product ........... [RUN]
[0m18:52:09.067926 [info ] [Thread-2  ]: 2 of 5 START sql view model ecommerce_data_raw_staging.stg_customer_logs ....... [RUN]
[0m18:52:09.068544 [info ] [Thread-3  ]: 3 of 5 START sql view model ecommerce_data_raw_staging.stg_sales ............... [RUN]
[0m18:52:09.069128 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_terraform-tutorial-430708_ecommerce_data_raw_reporting, now model.ecommerce_dbt.dim_product)
[0m18:52:09.069924 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_terraform-tutorial-430708_ecommerce_data_raw_staging, now model.ecommerce_dbt.stg_customer_logs)
[0m18:52:09.070580 [debug] [Thread-3  ]: Acquiring new bigquery connection 'model.ecommerce_dbt.stg_sales'
[0m18:52:09.071066 [debug] [Thread-1  ]: Began compiling node model.ecommerce_dbt.dim_product
[0m18:52:09.071477 [debug] [Thread-2  ]: Began compiling node model.ecommerce_dbt.stg_customer_logs
[0m18:52:09.071868 [debug] [Thread-3  ]: Began compiling node model.ecommerce_dbt.stg_sales
[0m18:52:09.082696 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_dbt.dim_product"
[0m18:52:09.087116 [debug] [Thread-2  ]: Writing injected SQL for node "model.ecommerce_dbt.stg_customer_logs"
[0m18:52:09.091368 [debug] [Thread-3  ]: Writing injected SQL for node "model.ecommerce_dbt.stg_sales"
[0m18:52:09.092698 [debug] [Thread-1  ]: Began executing node model.ecommerce_dbt.dim_product
[0m18:52:09.098847 [debug] [Thread-3  ]: Began executing node model.ecommerce_dbt.stg_sales
[0m18:52:09.099165 [debug] [Thread-2  ]: Began executing node model.ecommerce_dbt.stg_customer_logs
[0m18:52:09.117219 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_dbt.dim_product"
[0m18:52:09.119719 [debug] [Thread-3  ]: Writing runtime sql for node "model.ecommerce_dbt.stg_sales"
[0m18:52:09.122026 [debug] [Thread-2  ]: Writing runtime sql for node "model.ecommerce_dbt.stg_customer_logs"
[0m18:52:09.122908 [debug] [Thread-2  ]: On model.ecommerce_dbt.stg_customer_logs: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.stg_customer_logs"} */


  create or replace view `terraform-tutorial-430708`.`ecommerce_data_raw_staging`.`stg_customer_logs`
  OPTIONS()
  as WITH cleaned_customer_logs AS (
    SELECT
        timestamp,
        user_id,
        event_type,
        product_id
    FROM `terraform-tutorial-430708`.`ecommerce_data_raw`.`customer_logs`
    WHERE user_id IS NOT NULL
)
SELECT * FROM cleaned_customer_logs;


[0m18:52:09.123378 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m18:52:09.124312 [debug] [Thread-3  ]: On model.ecommerce_dbt.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.stg_sales"} */


  create or replace view `terraform-tutorial-430708`.`ecommerce_data_raw_staging`.`stg_sales`
  OPTIONS()
  as WITH cleaned_sales AS (
    SELECT
        transaction_id,
        product_id,
        sale_date,
        quantity,
        price_per_unit
    FROM `terraform-tutorial-430708`.`ecommerce_data_raw`.`raw_sales_data`
    WHERE sale_date IS NOT NULL
)
SELECT * FROM cleaned_sales;


[0m18:52:09.124665 [debug] [Thread-1  ]: On model.ecommerce_dbt.dim_product: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.dim_product"} */


  create or replace view `terraform-tutorial-430708`.`ecommerce_data_raw_reporting`.`dim_product`
  OPTIONS()
  as SELECT
    product_id,
    category,
    device
FROM `terraform-tutorial-430708`.`ecommerce_data_raw`.`product_catalog`;


[0m18:52:09.125236 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m18:52:09.125590 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:52:09.912310 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=terraform-tutorial-430708&j=bq:EU:7cb2a537-8cde-4e23-a115-b761f51248f4&page=queryresults
[0m18:52:09.915086 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=terraform-tutorial-430708&j=bq:EU:d6d70c47-bd49-475a-8788-205a121cafc6&page=queryresults
[0m18:52:09.916174 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=terraform-tutorial-430708&j=bq:EU:3cdeda10-1d63-4805-8365-8ae42717b010&page=queryresults
[0m18:52:10.526311 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35b69a40-5477-446c-9dd5-4be820ab3932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118e028e0>]}
[0m18:52:10.526645 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35b69a40-5477-446c-9dd5-4be820ab3932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118f9a7f0>]}
[0m18:52:10.526924 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35b69a40-5477-446c-9dd5-4be820ab3932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118e02a30>]}
[0m18:52:10.527462 [info ] [Thread-2  ]: 2 of 5 OK created sql view model ecommerce_data_raw_staging.stg_customer_logs .. [[32mCREATE VIEW (0 processed)[0m in 1.45s]
[0m18:52:10.527887 [info ] [Thread-1  ]: 1 of 5 OK created sql view model ecommerce_data_raw_reporting.dim_product ...... [[32mCREATE VIEW (0 processed)[0m in 1.46s]
[0m18:52:10.528813 [debug] [Thread-2  ]: Finished running node model.ecommerce_dbt.stg_customer_logs
[0m18:52:10.528388 [info ] [Thread-3  ]: 3 of 5 OK created sql view model ecommerce_data_raw_staging.stg_sales .......... [[32mCREATE VIEW (0 processed)[0m in 1.46s]
[0m18:52:10.529302 [debug] [Thread-1  ]: Finished running node model.ecommerce_dbt.dim_product
[0m18:52:10.529869 [debug] [Thread-3  ]: Finished running node model.ecommerce_dbt.stg_sales
[0m18:52:10.530158 [debug] [Thread-4  ]: Began running node model.ecommerce_dbt.fact_customer_activity
[0m18:52:10.530964 [debug] [Thread-2  ]: Began running node model.ecommerce_dbt.fact_sales
[0m18:52:10.530739 [info ] [Thread-4  ]: 4 of 5 START sql view model ecommerce_data_raw_reporting.fact_customer_activity  [RUN]
[0m18:52:10.531364 [info ] [Thread-2  ]: 5 of 5 START sql view model ecommerce_data_raw_reporting.fact_sales ............ [RUN]
[0m18:52:10.531771 [debug] [Thread-4  ]: Acquiring new bigquery connection 'model.ecommerce_dbt.fact_customer_activity'
[0m18:52:10.532063 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.ecommerce_dbt.stg_customer_logs, now model.ecommerce_dbt.fact_sales)
[0m18:52:10.532339 [debug] [Thread-4  ]: Began compiling node model.ecommerce_dbt.fact_customer_activity
[0m18:52:10.532618 [debug] [Thread-2  ]: Began compiling node model.ecommerce_dbt.fact_sales
[0m18:52:10.535267 [debug] [Thread-4  ]: Writing injected SQL for node "model.ecommerce_dbt.fact_customer_activity"
[0m18:52:10.537638 [debug] [Thread-2  ]: Writing injected SQL for node "model.ecommerce_dbt.fact_sales"
[0m18:52:10.538310 [debug] [Thread-2  ]: Began executing node model.ecommerce_dbt.fact_sales
[0m18:52:10.538620 [debug] [Thread-4  ]: Began executing node model.ecommerce_dbt.fact_customer_activity
[0m18:52:10.541254 [debug] [Thread-2  ]: Writing runtime sql for node "model.ecommerce_dbt.fact_sales"
[0m18:52:10.543724 [debug] [Thread-4  ]: Writing runtime sql for node "model.ecommerce_dbt.fact_customer_activity"
[0m18:52:10.544246 [debug] [Thread-2  ]: On model.ecommerce_dbt.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.fact_sales"} */


  create or replace view `terraform-tutorial-430708`.`ecommerce_data_raw_reporting`.`fact_sales`
  OPTIONS()
  as SELECT
    sale_date,
    product_id,
    SUM(quantity) AS total_quantity,
    SUM(quantity * price_per_unit) AS total_revenue
FROM `terraform-tutorial-430708`.`ecommerce_data_raw_staging`.`stg_sales`
GROUP BY
sale_date, product_id;


[0m18:52:10.544568 [debug] [Thread-4  ]: On model.ecommerce_dbt.fact_customer_activity: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.fact_customer_activity"} */


  create or replace view `terraform-tutorial-430708`.`ecommerce_data_raw_reporting`.`fact_customer_activity`
  OPTIONS()
  as SELECT
    user_id,
    DATE(timestamp) AS activity_date,
    COUNT(CASE WHEN event_type == 'view' THEN 1) AS views,
    COUNT(CASE WHEN event_type == 'clicks' THEN 1) AS clicks,
    COUNT(CASE WHEN event_type == 'purchases' THEN 1) AS purchases,
FROM `terraform-tutorial-430708`.`ecommerce_data_raw_staging`.`stg_customer_logs`
GROUP BY user_id, product_id, activity_date;


[0m18:52:10.544949 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m18:52:10.545217 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m18:52:11.120031 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=terraform-tutorial-430708&j=bq:EU:05ab1086-26a1-4d47-990f-5ae5fb2bb9d6&page=queryresults
[0m18:52:11.121109 [error] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=terraform-tutorial-430708&j=bq:EU:05ab1086-26a1-4d47-990f-5ae5fb2bb9d6&page=queryresults
[0m18:52:11.159495 [debug] [Thread-4  ]: Database Error in model fact_customer_activity (models/marts/fact_customer_activity.sql)
  Syntax error: Unexpected "=" at [9:33]
  compiled code at target/run/ecommerce_dbt/models/marts/fact_customer_activity.sql
[0m18:52:11.160043 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35b69a40-5477-446c-9dd5-4be820ab3932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11934a9a0>]}
[0m18:52:11.160595 [error] [Thread-4  ]: 4 of 5 ERROR creating sql view model ecommerce_data_raw_reporting.fact_customer_activity  [[31mERROR[0m in 0.63s]
[0m18:52:11.161032 [debug] [Thread-4  ]: Finished running node model.ecommerce_dbt.fact_customer_activity
[0m18:52:11.161452 [debug] [Thread-7  ]: Marking all children of 'model.ecommerce_dbt.fact_customer_activity' to be skipped because of status 'error'.  Reason: Database Error in model fact_customer_activity (models/marts/fact_customer_activity.sql)
  Syntax error: Unexpected "=" at [9:33]
  compiled code at target/run/ecommerce_dbt/models/marts/fact_customer_activity.sql.
[0m18:52:11.941584 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=terraform-tutorial-430708&j=bq:EU:99fd8bd9-1ddc-4db3-9256-816504bc4efc&page=queryresults
[0m18:52:12.847367 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '35b69a40-5477-446c-9dd5-4be820ab3932', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118e02eb0>]}
[0m18:52:12.848762 [info ] [Thread-2  ]: 5 of 5 OK created sql view model ecommerce_data_raw_reporting.fact_sales ....... [[32mCREATE VIEW (0 processed)[0m in 2.32s]
[0m18:52:12.849799 [debug] [Thread-2  ]: Finished running node model.ecommerce_dbt.fact_sales
[0m18:52:12.851586 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:52:12.852528 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:52:12.852978 [debug] [MainThread]: Connection 'model.ecommerce_dbt.dim_product' was properly closed.
[0m18:52:12.853376 [debug] [MainThread]: Connection 'model.ecommerce_dbt.fact_sales' was properly closed.
[0m18:52:12.853743 [debug] [MainThread]: Connection 'model.ecommerce_dbt.stg_sales' was properly closed.
[0m18:52:12.854109 [debug] [MainThread]: Connection 'model.ecommerce_dbt.fact_customer_activity' was properly closed.
[0m18:52:12.854636 [info ] [MainThread]: 
[0m18:52:12.855088 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 6.89 seconds (6.89s).
[0m18:52:12.856635 [debug] [MainThread]: Command end result
[0m18:52:12.889197 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jandytenedora/Interview/python-interview-gpt-question/dbt/ecommerce_dbt/target/manifest.json
[0m18:52:12.891266 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jandytenedora/Interview/python-interview-gpt-question/dbt/ecommerce_dbt/target/semantic_manifest.json
[0m18:52:12.896499 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/jandytenedora/Interview/python-interview-gpt-question/dbt/ecommerce_dbt/target/run_results.json
[0m18:52:12.896807 [info ] [MainThread]: 
[0m18:52:12.897099 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:52:12.897514 [info ] [MainThread]: 
[0m18:52:12.897855 [error] [MainThread]:   Database Error in model fact_customer_activity (models/marts/fact_customer_activity.sql)
  Syntax error: Unexpected "=" at [9:33]
  compiled code at target/run/ecommerce_dbt/models/marts/fact_customer_activity.sql
[0m18:52:12.898092 [info ] [MainThread]: 
[0m18:52:12.898338 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m18:52:12.900286 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 8.423473, "process_in_blocks": "0", "process_kernel_time": 0.371719, "process_mem_max_rss": "200376320", "process_out_blocks": "0", "process_user_time": 2.250352}
[0m18:52:12.900693 [debug] [MainThread]: Command `dbt run` failed at 18:52:12.900626 after 8.42 seconds
[0m18:52:12.901034 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x108039f40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fbf0580>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10fe06f10>]}
[0m18:52:12.901387 [debug] [MainThread]: Flushing usage events
[0m18:52:14.488657 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:53:58.121601 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103755fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10481bd60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10481bf40>]}


============================== 18:53:58.125531 | 283065f8-675d-4e6f-ae1a-1d753a848ce8 ==============================
[0m18:53:58.125531 [info ] [MainThread]: Running with dbt=1.9.1
[0m18:53:58.125961 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'fail_fast': 'False', 'version_check': 'True', 'log_path': '/Users/jandytenedora/Interview/python-interview-gpt-question/dbt/ecommerce_dbt/logs', 'debug': 'False', 'profiles_dir': '/Users/jandytenedora/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'static_parser': 'True', 'log_format': 'default', 'introspect': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m18:53:58.988975 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '283065f8-675d-4e6f-ae1a-1d753a848ce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x102641a90>]}
[0m18:53:59.030734 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '283065f8-675d-4e6f-ae1a-1d753a848ce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104225fa0>]}
[0m18:53:59.031292 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m18:53:59.139151 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m18:53:59.313685 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:53:59.314028 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:53:59.355486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '283065f8-675d-4e6f-ae1a-1d753a848ce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1249ecdc0>]}
[0m18:53:59.439752 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jandytenedora/Interview/python-interview-gpt-question/dbt/ecommerce_dbt/target/manifest.json
[0m18:53:59.443128 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jandytenedora/Interview/python-interview-gpt-question/dbt/ecommerce_dbt/target/semantic_manifest.json
[0m18:53:59.457486 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '283065f8-675d-4e6f-ae1a-1d753a848ce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124a08a60>]}
[0m18:53:59.457891 [info ] [MainThread]: Found 5 models, 7 data tests, 3 sources, 489 macros
[0m18:53:59.458150 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '283065f8-675d-4e6f-ae1a-1d753a848ce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124a0a490>]}
[0m18:53:59.459358 [info ] [MainThread]: 
[0m18:53:59.459633 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:53:59.459842 [info ] [MainThread]: 
[0m18:53:59.460192 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:53:59.463614 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_terraform-tutorial-430708'
[0m18:53:59.464027 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:53:59.464344 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_terraform-tutorial-430708'
[0m18:53:59.464776 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:54:02.845342 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_terraform-tutorial-430708, now list_terraform-tutorial-430708_ecommerce_data_raw_staging)
[0m18:54:02.846540 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:54:02.847290 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_terraform-tutorial-430708, now list_terraform-tutorial-430708_ecommerce_data_raw_reporting)
[0m18:54:02.849189 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:54:03.649918 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '283065f8-675d-4e6f-ae1a-1d753a848ce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1047edeb0>]}
[0m18:54:03.651174 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:54:03.654448 [debug] [Thread-1  ]: Began running node model.ecommerce_dbt.dim_product
[0m18:54:03.655049 [debug] [Thread-2  ]: Began running node model.ecommerce_dbt.stg_customer_logs
[0m18:54:03.656286 [debug] [Thread-3  ]: Began running node model.ecommerce_dbt.stg_sales
[0m18:54:03.655812 [info ] [Thread-1  ]: 1 of 5 START sql view model ecommerce_data_raw_reporting.dim_product ........... [RUN]
[0m18:54:03.657385 [info ] [Thread-2  ]: 2 of 5 START sql view model ecommerce_data_raw_staging.stg_customer_logs ....... [RUN]
[0m18:54:03.658286 [info ] [Thread-3  ]: 3 of 5 START sql view model ecommerce_data_raw_staging.stg_sales ............... [RUN]
[0m18:54:03.659193 [debug] [Thread-1  ]: Acquiring new bigquery connection 'model.ecommerce_dbt.dim_product'
[0m18:54:03.659830 [debug] [Thread-2  ]: Acquiring new bigquery connection 'model.ecommerce_dbt.stg_customer_logs'
[0m18:54:03.660372 [debug] [Thread-3  ]: Acquiring new bigquery connection 'model.ecommerce_dbt.stg_sales'
[0m18:54:03.660839 [debug] [Thread-1  ]: Began compiling node model.ecommerce_dbt.dim_product
[0m18:54:03.661335 [debug] [Thread-2  ]: Began compiling node model.ecommerce_dbt.stg_customer_logs
[0m18:54:03.661777 [debug] [Thread-3  ]: Began compiling node model.ecommerce_dbt.stg_sales
[0m18:54:03.677264 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_dbt.dim_product"
[0m18:54:03.679813 [debug] [Thread-2  ]: Writing injected SQL for node "model.ecommerce_dbt.stg_customer_logs"
[0m18:54:03.682446 [debug] [Thread-3  ]: Writing injected SQL for node "model.ecommerce_dbt.stg_sales"
[0m18:54:03.684548 [debug] [Thread-3  ]: Began executing node model.ecommerce_dbt.stg_sales
[0m18:54:03.709212 [debug] [Thread-3  ]: Writing runtime sql for node "model.ecommerce_dbt.stg_sales"
[0m18:54:03.709689 [debug] [Thread-1  ]: Began executing node model.ecommerce_dbt.dim_product
[0m18:54:03.712132 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_dbt.dim_product"
[0m18:54:03.712429 [debug] [Thread-2  ]: Began executing node model.ecommerce_dbt.stg_customer_logs
[0m18:54:03.714796 [debug] [Thread-2  ]: Writing runtime sql for node "model.ecommerce_dbt.stg_customer_logs"
[0m18:54:03.715151 [debug] [Thread-3  ]: On model.ecommerce_dbt.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.stg_sales"} */


  create or replace view `terraform-tutorial-430708`.`ecommerce_data_raw_staging`.`stg_sales`
  OPTIONS()
  as WITH cleaned_sales AS (
    SELECT
        transaction_id,
        product_id,
        sale_date,
        quantity,
        price_per_unit
    FROM `terraform-tutorial-430708`.`ecommerce_data_raw`.`raw_sales_data`
    WHERE sale_date IS NOT NULL
)
SELECT * FROM cleaned_sales;


[0m18:54:03.715549 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m18:54:03.715847 [debug] [Thread-1  ]: On model.ecommerce_dbt.dim_product: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.dim_product"} */


  create or replace view `terraform-tutorial-430708`.`ecommerce_data_raw_reporting`.`dim_product`
  OPTIONS()
  as SELECT
    product_id,
    category,
    device
FROM `terraform-tutorial-430708`.`ecommerce_data_raw`.`product_catalog`;


[0m18:54:03.716907 [debug] [Thread-1  ]: Opening a new connection, currently in state init
[0m18:54:03.717251 [debug] [Thread-2  ]: On model.ecommerce_dbt.stg_customer_logs: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.stg_customer_logs"} */


  create or replace view `terraform-tutorial-430708`.`ecommerce_data_raw_staging`.`stg_customer_logs`
  OPTIONS()
  as WITH cleaned_customer_logs AS (
    SELECT
        timestamp,
        user_id,
        event_type,
        product_id
    FROM `terraform-tutorial-430708`.`ecommerce_data_raw`.`customer_logs`
    WHERE user_id IS NOT NULL
)
SELECT * FROM cleaned_customer_logs;


[0m18:54:03.718102 [debug] [Thread-2  ]: Opening a new connection, currently in state init
[0m18:54:04.670436 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=terraform-tutorial-430708&j=bq:EU:4ef090d8-d1e5-4994-9ba5-2253ae6939b9&page=queryresults
[0m18:54:04.672345 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=terraform-tutorial-430708&j=bq:EU:f7d96c1b-1ff5-4dbb-a54e-f9196c587228&page=queryresults
[0m18:54:04.673336 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=terraform-tutorial-430708&j=bq:EU:b4f1df55-613e-4e4f-aa92-2287dd1024bc&page=queryresults
[0m18:54:05.421460 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '283065f8-675d-4e6f-ae1a-1d753a848ce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x124a8e7f0>]}
[0m18:54:05.421890 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '283065f8-675d-4e6f-ae1a-1d753a848ce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123ca8fd0>]}
[0m18:54:05.422334 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '283065f8-675d-4e6f-ae1a-1d753a848ce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123ce14c0>]}
[0m18:54:05.422814 [info ] [Thread-1  ]: 1 of 5 OK created sql view model ecommerce_data_raw_reporting.dim_product ...... [[32mCREATE VIEW (0 processed)[0m in 1.76s]
[0m18:54:05.423404 [info ] [Thread-2  ]: 2 of 5 OK created sql view model ecommerce_data_raw_staging.stg_customer_logs .. [[32mCREATE VIEW (0 processed)[0m in 1.76s]
[0m18:54:05.423913 [info ] [Thread-3  ]: 3 of 5 OK created sql view model ecommerce_data_raw_staging.stg_sales .......... [[32mCREATE VIEW (0 processed)[0m in 1.76s]
[0m18:54:05.424586 [debug] [Thread-1  ]: Finished running node model.ecommerce_dbt.dim_product
[0m18:54:05.425151 [debug] [Thread-2  ]: Finished running node model.ecommerce_dbt.stg_customer_logs
[0m18:54:05.425601 [debug] [Thread-3  ]: Finished running node model.ecommerce_dbt.stg_sales
[0m18:54:05.426261 [debug] [Thread-3  ]: Began running node model.ecommerce_dbt.fact_customer_activity
[0m18:54:05.426655 [info ] [Thread-3  ]: 4 of 5 START sql view model ecommerce_data_raw_reporting.fact_customer_activity  [RUN]
[0m18:54:05.427171 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.ecommerce_dbt.stg_sales, now model.ecommerce_dbt.fact_customer_activity)
[0m18:54:05.427452 [debug] [Thread-3  ]: Began compiling node model.ecommerce_dbt.fact_customer_activity
[0m18:54:05.430319 [debug] [Thread-3  ]: Writing injected SQL for node "model.ecommerce_dbt.fact_customer_activity"
[0m18:54:05.430707 [debug] [Thread-1  ]: Began running node model.ecommerce_dbt.fact_sales
[0m18:54:05.431209 [info ] [Thread-1  ]: 5 of 5 START sql view model ecommerce_data_raw_reporting.fact_sales ............ [RUN]
[0m18:54:05.431578 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_dbt.dim_product, now model.ecommerce_dbt.fact_sales)
[0m18:54:05.431840 [debug] [Thread-1  ]: Began compiling node model.ecommerce_dbt.fact_sales
[0m18:54:05.434214 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_dbt.fact_sales"
[0m18:54:05.435041 [debug] [Thread-3  ]: Began executing node model.ecommerce_dbt.fact_customer_activity
[0m18:54:05.437400 [debug] [Thread-3  ]: Writing runtime sql for node "model.ecommerce_dbt.fact_customer_activity"
[0m18:54:05.437783 [debug] [Thread-1  ]: Began executing node model.ecommerce_dbt.fact_sales
[0m18:54:05.440261 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_dbt.fact_sales"
[0m18:54:05.440828 [debug] [Thread-3  ]: On model.ecommerce_dbt.fact_customer_activity: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.fact_customer_activity"} */


  create or replace view `terraform-tutorial-430708`.`ecommerce_data_raw_reporting`.`fact_customer_activity`
  OPTIONS()
  as SELECT
    user_id,
    DATE(timestamp) AS activity_date,
    COUNT(CASE WHEN event_type == 'view' THEN 1) AS views,
    COUNT(CASE WHEN event_type == 'clicks' THEN 1) AS clicks,
    COUNT(CASE WHEN event_type == 'purchases' THEN 1) AS purchases,
FROM `terraform-tutorial-430708`.`ecommerce_data_raw_staging`.`stg_customer_logs`
GROUP BY user_id, product_id, activity_date;


[0m18:54:05.441172 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m18:54:05.441517 [debug] [Thread-1  ]: On model.ecommerce_dbt.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.fact_sales"} */


  create or replace view `terraform-tutorial-430708`.`ecommerce_data_raw_reporting`.`fact_sales`
  OPTIONS()
  as SELECT
    sale_date,
    product_id,
    SUM(quantity) AS total_quantity,
    SUM(quantity * price_per_unit) AS total_revenue
FROM `terraform-tutorial-430708`.`ecommerce_data_raw_staging`.`stg_sales`
GROUP BY
sale_date, product_id;


[0m18:54:05.442644 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:54:06.024472 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=terraform-tutorial-430708&j=bq:EU:aafd8010-a7a1-43d5-935a-c0232959a52b&page=queryresults
[0m18:54:06.026521 [error] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=terraform-tutorial-430708&j=bq:EU:aafd8010-a7a1-43d5-935a-c0232959a52b&page=queryresults
[0m18:54:06.067388 [debug] [Thread-3  ]: Database Error in model fact_customer_activity (models/marts/fact_customer_activity.sql)
  Syntax error: Unexpected "=" at [9:33]
  compiled code at target/run/ecommerce_dbt/models/marts/fact_customer_activity.sql
[0m18:54:06.068645 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '283065f8-675d-4e6f-ae1a-1d753a848ce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130f13e80>]}
[0m18:54:06.069216 [error] [Thread-3  ]: 4 of 5 ERROR creating sql view model ecommerce_data_raw_reporting.fact_customer_activity  [[31mERROR[0m in 0.64s]
[0m18:54:06.069639 [debug] [Thread-3  ]: Finished running node model.ecommerce_dbt.fact_customer_activity
[0m18:54:06.070122 [debug] [Thread-7  ]: Marking all children of 'model.ecommerce_dbt.fact_customer_activity' to be skipped because of status 'error'.  Reason: Database Error in model fact_customer_activity (models/marts/fact_customer_activity.sql)
  Syntax error: Unexpected "=" at [9:33]
  compiled code at target/run/ecommerce_dbt/models/marts/fact_customer_activity.sql.
[0m18:54:06.512740 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=terraform-tutorial-430708&j=bq:EU:859e65d2-2c38-420e-8687-4126d5bd867e&page=queryresults
[0m18:54:07.006920 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': '283065f8-675d-4e6f-ae1a-1d753a848ce8', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130fc7bb0>]}
[0m18:54:07.008060 [info ] [Thread-1  ]: 5 of 5 OK created sql view model ecommerce_data_raw_reporting.fact_sales ....... [[32mCREATE VIEW (0 processed)[0m in 1.58s]
[0m18:54:07.008883 [debug] [Thread-1  ]: Finished running node model.ecommerce_dbt.fact_sales
[0m18:54:07.010463 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:54:07.011231 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:54:07.011586 [debug] [MainThread]: Connection 'list_terraform-tutorial-430708_ecommerce_data_raw_staging' was properly closed.
[0m18:54:07.011910 [debug] [MainThread]: Connection 'list_terraform-tutorial-430708_ecommerce_data_raw_reporting' was properly closed.
[0m18:54:07.012220 [debug] [MainThread]: Connection 'model.ecommerce_dbt.fact_sales' was properly closed.
[0m18:54:07.012524 [debug] [MainThread]: Connection 'model.ecommerce_dbt.stg_customer_logs' was properly closed.
[0m18:54:07.012838 [debug] [MainThread]: Connection 'model.ecommerce_dbt.fact_customer_activity' was properly closed.
[0m18:54:07.013296 [info ] [MainThread]: 
[0m18:54:07.013680 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 7.55 seconds (7.55s).
[0m18:54:07.015060 [debug] [MainThread]: Command end result
[0m18:54:07.048666 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jandytenedora/Interview/python-interview-gpt-question/dbt/ecommerce_dbt/target/manifest.json
[0m18:54:07.050814 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jandytenedora/Interview/python-interview-gpt-question/dbt/ecommerce_dbt/target/semantic_manifest.json
[0m18:54:07.056371 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/jandytenedora/Interview/python-interview-gpt-question/dbt/ecommerce_dbt/target/run_results.json
[0m18:54:07.056646 [info ] [MainThread]: 
[0m18:54:07.056923 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:54:07.057151 [info ] [MainThread]: 
[0m18:54:07.057422 [error] [MainThread]:   Database Error in model fact_customer_activity (models/marts/fact_customer_activity.sql)
  Syntax error: Unexpected "=" at [9:33]
  compiled code at target/run/ecommerce_dbt/models/marts/fact_customer_activity.sql
[0m18:54:07.057642 [info ] [MainThread]: 
[0m18:54:07.057871 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m18:54:07.059399 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 8.991858, "process_in_blocks": "0", "process_kernel_time": 0.385084, "process_mem_max_rss": "189841408", "process_out_blocks": "0", "process_user_time": 2.12291}
[0m18:54:07.059712 [debug] [MainThread]: Command `dbt run` failed at 18:54:07.059654 after 8.99 seconds
[0m18:54:07.060009 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103755fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103650c70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x130df1e50>]}
[0m18:54:07.060309 [debug] [MainThread]: Flushing usage events
[0m18:54:09.277117 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:54:25.211499 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10381df70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046ab2e0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1046ab100>]}


============================== 18:54:25.215580 | 061984dd-0252-43a5-9f90-38ea5686d364 ==============================
[0m18:54:25.215580 [info ] [MainThread]: Running with dbt=1.9.1
[0m18:54:25.216009 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'profiles_dir': '/Users/jandytenedora/.dbt', 'log_path': '/Users/jandytenedora/Interview/python-interview-gpt-question/dbt/ecommerce_dbt/logs', 'fail_fast': 'False', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'invocation_command': 'dbt compile', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:54:26.035043 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '061984dd-0252-43a5-9f90-38ea5686d364', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10a5de1f0>]}
[0m18:54:26.076396 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '061984dd-0252-43a5-9f90-38ea5686d364', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104145670>]}
[0m18:54:26.076914 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m18:54:26.186230 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m18:54:26.357346 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:54:26.357703 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:54:26.399453 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '061984dd-0252-43a5-9f90-38ea5686d364', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa78130>]}
[0m18:54:26.481414 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jandytenedora/Interview/python-interview-gpt-question/dbt/ecommerce_dbt/target/manifest.json
[0m18:54:26.487096 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jandytenedora/Interview/python-interview-gpt-question/dbt/ecommerce_dbt/target/semantic_manifest.json
[0m18:54:26.499119 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '061984dd-0252-43a5-9f90-38ea5686d364', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa78160>]}
[0m18:54:26.499552 [info ] [MainThread]: Found 5 models, 7 data tests, 3 sources, 489 macros
[0m18:54:26.499834 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '061984dd-0252-43a5-9f90-38ea5686d364', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aa26b80>]}
[0m18:54:26.501250 [info ] [MainThread]: 
[0m18:54:26.501631 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:54:26.501859 [info ] [MainThread]: 
[0m18:54:26.502267 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:54:26.505825 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_terraform-tutorial-430708_ecommerce_data_raw_reporting'
[0m18:54:26.506321 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_terraform-tutorial-430708_ecommerce_data_raw_staging'
[0m18:54:26.506618 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:54:26.506860 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:54:28.200430 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '061984dd-0252-43a5-9f90-38ea5686d364', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104675a90>]}
[0m18:54:28.201608 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:54:28.206921 [debug] [Thread-1  ]: Began running node model.ecommerce_dbt.dim_product
[0m18:54:28.207425 [debug] [Thread-2  ]: Began running node model.ecommerce_dbt.stg_customer_logs
[0m18:54:28.207938 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_terraform-tutorial-430708_ecommerce_data_raw_reporting, now model.ecommerce_dbt.dim_product)
[0m18:54:28.208351 [debug] [Thread-3  ]: Began running node model.ecommerce_dbt.stg_sales
[0m18:54:28.208880 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_terraform-tutorial-430708_ecommerce_data_raw_staging, now model.ecommerce_dbt.stg_customer_logs)
[0m18:54:28.209384 [debug] [Thread-1  ]: Began compiling node model.ecommerce_dbt.dim_product
[0m18:54:28.209953 [debug] [Thread-3  ]: Acquiring new bigquery connection 'model.ecommerce_dbt.stg_sales'
[0m18:54:28.210378 [debug] [Thread-2  ]: Began compiling node model.ecommerce_dbt.stg_customer_logs
[0m18:54:28.219893 [debug] [Thread-3  ]: Began compiling node model.ecommerce_dbt.stg_sales
[0m18:54:28.223124 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_dbt.dim_product"
[0m18:54:28.227036 [debug] [Thread-2  ]: Writing injected SQL for node "model.ecommerce_dbt.stg_customer_logs"
[0m18:54:28.229503 [debug] [Thread-3  ]: Writing injected SQL for node "model.ecommerce_dbt.stg_sales"
[0m18:54:28.230578 [debug] [Thread-1  ]: Began executing node model.ecommerce_dbt.dim_product
[0m18:54:28.230890 [debug] [Thread-3  ]: Began executing node model.ecommerce_dbt.stg_sales
[0m18:54:28.231225 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:54:28.231495 [debug] [Thread-2  ]: Began executing node model.ecommerce_dbt.stg_customer_logs
[0m18:54:28.231781 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m18:54:28.232470 [debug] [Thread-1  ]: Finished running node model.ecommerce_dbt.dim_product
[0m18:54:28.232763 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m18:54:28.233432 [debug] [Thread-3  ]: Finished running node model.ecommerce_dbt.stg_sales
[0m18:54:28.234153 [debug] [Thread-2  ]: Finished running node model.ecommerce_dbt.stg_customer_logs
[0m18:54:28.234623 [debug] [Thread-4  ]: Began running node model.ecommerce_dbt.fact_sales
[0m18:54:28.235020 [debug] [Thread-4  ]: Acquiring new bigquery connection 'model.ecommerce_dbt.fact_sales'
[0m18:54:28.235314 [debug] [Thread-3  ]: Began running node model.ecommerce_dbt.fact_customer_activity
[0m18:54:28.235575 [debug] [Thread-4  ]: Began compiling node model.ecommerce_dbt.fact_sales
[0m18:54:28.235879 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.ecommerce_dbt.stg_sales, now model.ecommerce_dbt.fact_customer_activity)
[0m18:54:28.238446 [debug] [Thread-4  ]: Writing injected SQL for node "model.ecommerce_dbt.fact_sales"
[0m18:54:28.238751 [debug] [Thread-3  ]: Began compiling node model.ecommerce_dbt.fact_customer_activity
[0m18:54:28.241006 [debug] [Thread-3  ]: Writing injected SQL for node "model.ecommerce_dbt.fact_customer_activity"
[0m18:54:28.241549 [debug] [Thread-4  ]: Began executing node model.ecommerce_dbt.fact_sales
[0m18:54:28.241834 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m18:54:28.242414 [debug] [Thread-4  ]: Finished running node model.ecommerce_dbt.fact_sales
[0m18:54:28.242671 [debug] [Thread-3  ]: Began executing node model.ecommerce_dbt.fact_customer_activity
[0m18:54:28.243107 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m18:54:28.243746 [debug] [Thread-3  ]: Finished running node model.ecommerce_dbt.fact_customer_activity
[0m18:54:28.244012 [debug] [Thread-1  ]: Began running node test.ecommerce_dbt.not_null_fact_sales_product_id.39101802a8
[0m18:54:28.244270 [debug] [Thread-3  ]: Began running node test.ecommerce_dbt.not_null_fact_sales_sale_date.aeb11a016c
[0m18:54:28.244508 [debug] [Thread-2  ]: Began running node test.ecommerce_dbt.not_null_fact_sales_total_quantity.a24e8f3a97
[0m18:54:28.244789 [debug] [Thread-4  ]: Began running node test.ecommerce_dbt.not_null_fact_sales_total_revenue.e93f0630dd
[0m18:54:28.245050 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_dbt.dim_product, now test.ecommerce_dbt.not_null_fact_sales_product_id.39101802a8)
[0m18:54:28.245391 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.ecommerce_dbt.fact_customer_activity, now test.ecommerce_dbt.not_null_fact_sales_sale_date.aeb11a016c)
[0m18:54:28.245664 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.ecommerce_dbt.stg_customer_logs, now test.ecommerce_dbt.not_null_fact_sales_total_quantity.a24e8f3a97)
[0m18:54:28.245934 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.ecommerce_dbt.fact_sales, now test.ecommerce_dbt.not_null_fact_sales_total_revenue.e93f0630dd)
[0m18:54:28.246227 [debug] [Thread-1  ]: Began compiling node test.ecommerce_dbt.not_null_fact_sales_product_id.39101802a8
[0m18:54:28.246496 [debug] [Thread-3  ]: Began compiling node test.ecommerce_dbt.not_null_fact_sales_sale_date.aeb11a016c
[0m18:54:28.246752 [debug] [Thread-2  ]: Began compiling node test.ecommerce_dbt.not_null_fact_sales_total_quantity.a24e8f3a97
[0m18:54:28.246992 [debug] [Thread-4  ]: Began compiling node test.ecommerce_dbt.not_null_fact_sales_total_revenue.e93f0630dd
[0m18:54:28.256218 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_dbt.not_null_fact_sales_product_id.39101802a8"
[0m18:54:28.259358 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_dbt.not_null_fact_sales_sale_date.aeb11a016c"
[0m18:54:28.263399 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_dbt.not_null_fact_sales_total_quantity.a24e8f3a97"
[0m18:54:28.266508 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_dbt.not_null_fact_sales_total_revenue.e93f0630dd"
[0m18:54:28.268100 [debug] [Thread-2  ]: Began executing node test.ecommerce_dbt.not_null_fact_sales_total_quantity.a24e8f3a97
[0m18:54:28.268510 [debug] [Thread-1  ]: Began executing node test.ecommerce_dbt.not_null_fact_sales_product_id.39101802a8
[0m18:54:28.268788 [debug] [Thread-3  ]: Began executing node test.ecommerce_dbt.not_null_fact_sales_sale_date.aeb11a016c
[0m18:54:28.269029 [debug] [Thread-4  ]: Began executing node test.ecommerce_dbt.not_null_fact_sales_total_revenue.e93f0630dd
[0m18:54:28.269305 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m18:54:28.269596 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:54:28.269868 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m18:54:28.270122 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m18:54:28.270747 [debug] [Thread-2  ]: Finished running node test.ecommerce_dbt.not_null_fact_sales_total_quantity.a24e8f3a97
[0m18:54:28.271322 [debug] [Thread-1  ]: Finished running node test.ecommerce_dbt.not_null_fact_sales_product_id.39101802a8
[0m18:54:28.271860 [debug] [Thread-3  ]: Finished running node test.ecommerce_dbt.not_null_fact_sales_sale_date.aeb11a016c
[0m18:54:28.272480 [debug] [Thread-4  ]: Finished running node test.ecommerce_dbt.not_null_fact_sales_total_revenue.e93f0630dd
[0m18:54:28.272760 [debug] [Thread-2  ]: Began running node test.ecommerce_dbt.not_null_fact_customer_activity_activity_date.412e077efb
[0m18:54:28.273063 [debug] [Thread-1  ]: Began running node test.ecommerce_dbt.not_null_fact_customer_activity_activity_type.0bf9b8fb18
[0m18:54:28.273349 [debug] [Thread-3  ]: Began running node test.ecommerce_dbt.not_null_fact_customer_activity_customer_id.8c4e1c83bf
[0m18:54:28.273701 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_dbt.not_null_fact_sales_total_quantity.a24e8f3a97, now test.ecommerce_dbt.not_null_fact_customer_activity_activity_date.412e077efb)
[0m18:54:28.273986 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_dbt.not_null_fact_sales_product_id.39101802a8, now test.ecommerce_dbt.not_null_fact_customer_activity_activity_type.0bf9b8fb18)
[0m18:54:28.274256 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_dbt.not_null_fact_sales_sale_date.aeb11a016c, now test.ecommerce_dbt.not_null_fact_customer_activity_customer_id.8c4e1c83bf)
[0m18:54:28.274524 [debug] [Thread-2  ]: Began compiling node test.ecommerce_dbt.not_null_fact_customer_activity_activity_date.412e077efb
[0m18:54:28.274776 [debug] [Thread-1  ]: Began compiling node test.ecommerce_dbt.not_null_fact_customer_activity_activity_type.0bf9b8fb18
[0m18:54:28.275016 [debug] [Thread-3  ]: Began compiling node test.ecommerce_dbt.not_null_fact_customer_activity_customer_id.8c4e1c83bf
[0m18:54:28.278332 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_dbt.not_null_fact_customer_activity_activity_date.412e077efb"
[0m18:54:28.281442 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_dbt.not_null_fact_customer_activity_activity_type.0bf9b8fb18"
[0m18:54:28.284531 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_dbt.not_null_fact_customer_activity_customer_id.8c4e1c83bf"
[0m18:54:28.285362 [debug] [Thread-1  ]: Began executing node test.ecommerce_dbt.not_null_fact_customer_activity_activity_type.0bf9b8fb18
[0m18:54:28.285630 [debug] [Thread-3  ]: Began executing node test.ecommerce_dbt.not_null_fact_customer_activity_customer_id.8c4e1c83bf
[0m18:54:28.285878 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:54:28.286151 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m18:54:28.286394 [debug] [Thread-2  ]: Began executing node test.ecommerce_dbt.not_null_fact_customer_activity_activity_date.412e077efb
[0m18:54:28.287024 [debug] [Thread-1  ]: Finished running node test.ecommerce_dbt.not_null_fact_customer_activity_activity_type.0bf9b8fb18
[0m18:54:28.287655 [debug] [Thread-3  ]: Finished running node test.ecommerce_dbt.not_null_fact_customer_activity_customer_id.8c4e1c83bf
[0m18:54:28.287921 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m18:54:28.288582 [debug] [Thread-2  ]: Finished running node test.ecommerce_dbt.not_null_fact_customer_activity_activity_date.412e077efb
[0m18:54:28.289308 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:54:28.289555 [debug] [MainThread]: Connection 'test.ecommerce_dbt.not_null_fact_customer_activity_activity_type.0bf9b8fb18' was properly closed.
[0m18:54:28.289768 [debug] [MainThread]: Connection 'test.ecommerce_dbt.not_null_fact_customer_activity_activity_date.412e077efb' was properly closed.
[0m18:54:28.289965 [debug] [MainThread]: Connection 'test.ecommerce_dbt.not_null_fact_customer_activity_customer_id.8c4e1c83bf' was properly closed.
[0m18:54:28.290163 [debug] [MainThread]: Connection 'test.ecommerce_dbt.not_null_fact_sales_total_revenue.e93f0630dd' was properly closed.
[0m18:54:28.291558 [debug] [MainThread]: Command end result
[0m18:54:28.314065 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jandytenedora/Interview/python-interview-gpt-question/dbt/ecommerce_dbt/target/manifest.json
[0m18:54:28.315545 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jandytenedora/Interview/python-interview-gpt-question/dbt/ecommerce_dbt/target/semantic_manifest.json
[0m18:54:28.321991 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/jandytenedora/Interview/python-interview-gpt-question/dbt/ecommerce_dbt/target/run_results.json
[0m18:54:28.323674 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 3.1693254, "process_in_blocks": "0", "process_kernel_time": 0.318277, "process_mem_max_rss": "190021632", "process_out_blocks": "0", "process_user_time": 1.904814}
[0m18:54:28.324003 [debug] [MainThread]: Command `dbt compile` succeeded at 18:54:28.323930 after 3.17 seconds
[0m18:54:28.324292 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10381df70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104145670>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10aaa7730>]}
[0m18:54:28.324579 [debug] [MainThread]: Flushing usage events
[0m18:54:29.075063 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:54:33.293263 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f73040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110319e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1103191f0>]}


============================== 18:54:33.297525 | aee75889-73e4-4929-a3e8-51a0733df89a ==============================
[0m18:54:33.297525 [info ] [MainThread]: Running with dbt=1.9.1
[0m18:54:33.297959 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jandytenedora/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/jandytenedora/Interview/python-interview-gpt-question/dbt/ecommerce_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt run', 'send_anonymous_usage_stats': 'True'}
[0m18:54:34.106275 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'aee75889-73e4-4929-a3e8-51a0733df89a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116f951c0>]}
[0m18:54:34.147911 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'aee75889-73e4-4929-a3e8-51a0733df89a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102ed670>]}
[0m18:54:34.148410 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m18:54:34.254443 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m18:54:34.430280 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:54:34.430831 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:54:34.474321 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'aee75889-73e4-4929-a3e8-51a0733df89a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117f27130>]}
[0m18:54:34.554880 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jandytenedora/Interview/python-interview-gpt-question/dbt/ecommerce_dbt/target/manifest.json
[0m18:54:34.557221 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jandytenedora/Interview/python-interview-gpt-question/dbt/ecommerce_dbt/target/semantic_manifest.json
[0m18:54:34.571233 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'aee75889-73e4-4929-a3e8-51a0733df89a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10246bee0>]}
[0m18:54:34.571675 [info ] [MainThread]: Found 5 models, 7 data tests, 3 sources, 489 macros
[0m18:54:34.571942 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aee75889-73e4-4929-a3e8-51a0733df89a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106bff130>]}
[0m18:54:34.573246 [info ] [MainThread]: 
[0m18:54:34.573565 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:54:34.573789 [info ] [MainThread]: 
[0m18:54:34.574167 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:54:34.577704 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_terraform-tutorial-430708'
[0m18:54:34.578146 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_terraform-tutorial-430708'
[0m18:54:34.578389 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:54:34.578683 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:54:36.621632 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_terraform-tutorial-430708, now list_terraform-tutorial-430708_ecommerce_data_raw_staging)
[0m18:54:36.622830 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_terraform-tutorial-430708, now list_terraform-tutorial-430708_ecommerce_data_raw_reporting)
[0m18:54:36.623386 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:54:36.624029 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:54:37.097056 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'aee75889-73e4-4929-a3e8-51a0733df89a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106410610>]}
[0m18:54:37.098292 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:54:37.101466 [debug] [Thread-1  ]: Began running node model.ecommerce_dbt.dim_product
[0m18:54:37.102077 [debug] [Thread-2  ]: Began running node model.ecommerce_dbt.stg_customer_logs
[0m18:54:37.103332 [debug] [Thread-3  ]: Began running node model.ecommerce_dbt.stg_sales
[0m18:54:37.102860 [info ] [Thread-1  ]: 1 of 5 START sql view model ecommerce_data_raw_reporting.dim_product ........... [RUN]
[0m18:54:37.104149 [info ] [Thread-2  ]: 2 of 5 START sql view model ecommerce_data_raw_staging.stg_customer_logs ....... [RUN]
[0m18:54:37.104834 [info ] [Thread-3  ]: 3 of 5 START sql view model ecommerce_data_raw_staging.stg_sales ............... [RUN]
[0m18:54:37.105530 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_terraform-tutorial-430708_ecommerce_data_raw_staging, now model.ecommerce_dbt.dim_product)
[0m18:54:37.106063 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_terraform-tutorial-430708_ecommerce_data_raw_reporting, now model.ecommerce_dbt.stg_customer_logs)
[0m18:54:37.106676 [debug] [Thread-3  ]: Acquiring new bigquery connection 'model.ecommerce_dbt.stg_sales'
[0m18:54:37.107108 [debug] [Thread-1  ]: Began compiling node model.ecommerce_dbt.dim_product
[0m18:54:37.107758 [debug] [Thread-2  ]: Began compiling node model.ecommerce_dbt.stg_customer_logs
[0m18:54:37.108342 [debug] [Thread-3  ]: Began compiling node model.ecommerce_dbt.stg_sales
[0m18:54:37.122813 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_dbt.dim_product"
[0m18:54:37.126060 [debug] [Thread-2  ]: Writing injected SQL for node "model.ecommerce_dbt.stg_customer_logs"
[0m18:54:37.128929 [debug] [Thread-3  ]: Writing injected SQL for node "model.ecommerce_dbt.stg_sales"
[0m18:54:37.130552 [debug] [Thread-1  ]: Began executing node model.ecommerce_dbt.dim_product
[0m18:54:37.137174 [debug] [Thread-2  ]: Began executing node model.ecommerce_dbt.stg_customer_logs
[0m18:54:37.161484 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_dbt.dim_product"
[0m18:54:37.163246 [debug] [Thread-2  ]: Writing runtime sql for node "model.ecommerce_dbt.stg_customer_logs"
[0m18:54:37.163739 [debug] [Thread-3  ]: Began executing node model.ecommerce_dbt.stg_sales
[0m18:54:37.167099 [debug] [Thread-3  ]: Writing runtime sql for node "model.ecommerce_dbt.stg_sales"
[0m18:54:37.167494 [debug] [Thread-1  ]: On model.ecommerce_dbt.dim_product: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.dim_product"} */


  create or replace view `terraform-tutorial-430708`.`ecommerce_data_raw_reporting`.`dim_product`
  OPTIONS()
  as SELECT
    product_id,
    category,
    device
FROM `terraform-tutorial-430708`.`ecommerce_data_raw`.`product_catalog`;


[0m18:54:37.167868 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:54:37.168175 [debug] [Thread-3  ]: On model.ecommerce_dbt.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.stg_sales"} */


  create or replace view `terraform-tutorial-430708`.`ecommerce_data_raw_staging`.`stg_sales`
  OPTIONS()
  as WITH cleaned_sales AS (
    SELECT
        transaction_id,
        product_id,
        sale_date,
        quantity,
        price_per_unit
    FROM `terraform-tutorial-430708`.`ecommerce_data_raw`.`raw_sales_data`
    WHERE sale_date IS NOT NULL
)
SELECT * FROM cleaned_sales;


[0m18:54:37.169285 [debug] [Thread-2  ]: On model.ecommerce_dbt.stg_customer_logs: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.stg_customer_logs"} */


  create or replace view `terraform-tutorial-430708`.`ecommerce_data_raw_staging`.`stg_customer_logs`
  OPTIONS()
  as WITH cleaned_customer_logs AS (
    SELECT
        timestamp,
        user_id,
        event_type,
        product_id
    FROM `terraform-tutorial-430708`.`ecommerce_data_raw`.`customer_logs`
    WHERE user_id IS NOT NULL
)
SELECT * FROM cleaned_customer_logs;


[0m18:54:37.169629 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m18:54:37.169924 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m18:54:38.085419 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=terraform-tutorial-430708&j=bq:EU:e3081f27-5dcb-44e4-9879-6646f2046a34&page=queryresults
[0m18:54:38.087154 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=terraform-tutorial-430708&j=bq:EU:cf3e69a3-38d1-40b3-abb8-7587b493dbeb&page=queryresults
[0m18:54:38.088117 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=terraform-tutorial-430708&j=bq:EU:16ba3b55-bee2-4433-b8c7-61d2c47b6f88&page=queryresults
[0m18:54:38.878277 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aee75889-73e4-4929-a3e8-51a0733df89a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11797a5e0>]}
[0m18:54:38.878997 [info ] [Thread-2  ]: 2 of 5 OK created sql view model ecommerce_data_raw_staging.stg_customer_logs .. [[32mCREATE VIEW (0 processed)[0m in 1.77s]
[0m18:54:38.879458 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aee75889-73e4-4929-a3e8-51a0733df89a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116fa2e20>]}
[0m18:54:38.879973 [debug] [Thread-2  ]: Finished running node model.ecommerce_dbt.stg_customer_logs
[0m18:54:38.880229 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aee75889-73e4-4929-a3e8-51a0733df89a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x120010cd0>]}
[0m18:54:38.880786 [info ] [Thread-3  ]: 3 of 5 OK created sql view model ecommerce_data_raw_staging.stg_sales .......... [[32mCREATE VIEW (0 processed)[0m in 1.77s]
[0m18:54:38.882027 [debug] [Thread-4  ]: Began running node model.ecommerce_dbt.fact_customer_activity
[0m18:54:38.882426 [debug] [Thread-3  ]: Finished running node model.ecommerce_dbt.stg_sales
[0m18:54:38.881726 [info ] [Thread-1  ]: 1 of 5 OK created sql view model ecommerce_data_raw_reporting.dim_product ...... [[32mCREATE VIEW (0 processed)[0m in 1.77s]
[0m18:54:38.882865 [info ] [Thread-4  ]: 4 of 5 START sql view model ecommerce_data_raw_reporting.fact_customer_activity  [RUN]
[0m18:54:38.883305 [debug] [Thread-2  ]: Began running node model.ecommerce_dbt.fact_sales
[0m18:54:38.883681 [debug] [Thread-1  ]: Finished running node model.ecommerce_dbt.dim_product
[0m18:54:38.884056 [debug] [Thread-4  ]: Acquiring new bigquery connection 'model.ecommerce_dbt.fact_customer_activity'
[0m18:54:38.884393 [info ] [Thread-2  ]: 5 of 5 START sql view model ecommerce_data_raw_reporting.fact_sales ............ [RUN]
[0m18:54:38.884757 [debug] [Thread-4  ]: Began compiling node model.ecommerce_dbt.fact_customer_activity
[0m18:54:38.885053 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.ecommerce_dbt.stg_customer_logs, now model.ecommerce_dbt.fact_sales)
[0m18:54:38.887751 [debug] [Thread-4  ]: Writing injected SQL for node "model.ecommerce_dbt.fact_customer_activity"
[0m18:54:38.888039 [debug] [Thread-2  ]: Began compiling node model.ecommerce_dbt.fact_sales
[0m18:54:38.890245 [debug] [Thread-2  ]: Writing injected SQL for node "model.ecommerce_dbt.fact_sales"
[0m18:54:38.890963 [debug] [Thread-4  ]: Began executing node model.ecommerce_dbt.fact_customer_activity
[0m18:54:38.891225 [debug] [Thread-2  ]: Began executing node model.ecommerce_dbt.fact_sales
[0m18:54:38.893601 [debug] [Thread-4  ]: Writing runtime sql for node "model.ecommerce_dbt.fact_customer_activity"
[0m18:54:38.896779 [debug] [Thread-2  ]: Writing runtime sql for node "model.ecommerce_dbt.fact_sales"
[0m18:54:38.897739 [debug] [Thread-2  ]: On model.ecommerce_dbt.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.fact_sales"} */


  create or replace view `terraform-tutorial-430708`.`ecommerce_data_raw_reporting`.`fact_sales`
  OPTIONS()
  as SELECT
    sale_date,
    product_id,
    SUM(quantity) AS total_quantity,
    SUM(quantity * price_per_unit) AS total_revenue
FROM `terraform-tutorial-430708`.`ecommerce_data_raw_staging`.`stg_sales`
GROUP BY
sale_date, product_id;


[0m18:54:38.898125 [debug] [Thread-4  ]: On model.ecommerce_dbt.fact_customer_activity: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.fact_customer_activity"} */


  create or replace view `terraform-tutorial-430708`.`ecommerce_data_raw_reporting`.`fact_customer_activity`
  OPTIONS()
  as SELECT
    user_id,
    DATE(timestamp) AS activity_date,
    COUNT(CASE WHEN event_type == 'view' THEN 1) AS views,
    COUNT(CASE WHEN event_type == 'clicks' THEN 1) AS clicks,
    COUNT(CASE WHEN event_type == 'purchases' THEN 1) AS purchases,
FROM `terraform-tutorial-430708`.`ecommerce_data_raw_staging`.`stg_customer_logs`
GROUP BY user_id, product_id, activity_date;


[0m18:54:38.898522 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m18:54:38.898874 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m18:54:39.506685 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=terraform-tutorial-430708&j=bq:EU:93f0b748-2b1b-48d4-bddd-29794c59224c&page=queryresults
[0m18:54:39.507807 [error] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=terraform-tutorial-430708&j=bq:EU:93f0b748-2b1b-48d4-bddd-29794c59224c&page=queryresults
[0m18:54:39.547997 [debug] [Thread-4  ]: Database Error in model fact_customer_activity (models/marts/fact_customer_activity.sql)
  Syntax error: Unexpected "=" at [9:33]
  compiled code at target/run/ecommerce_dbt/models/marts/fact_customer_activity.sql
[0m18:54:39.548541 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aee75889-73e4-4929-a3e8-51a0733df89a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1204ea220>]}
[0m18:54:39.549053 [error] [Thread-4  ]: 4 of 5 ERROR creating sql view model ecommerce_data_raw_reporting.fact_customer_activity  [[31mERROR[0m in 0.66s]
[0m18:54:39.549465 [debug] [Thread-4  ]: Finished running node model.ecommerce_dbt.fact_customer_activity
[0m18:54:39.549880 [debug] [Thread-7  ]: Marking all children of 'model.ecommerce_dbt.fact_customer_activity' to be skipped because of status 'error'.  Reason: Database Error in model fact_customer_activity (models/marts/fact_customer_activity.sql)
  Syntax error: Unexpected "=" at [9:33]
  compiled code at target/run/ecommerce_dbt/models/marts/fact_customer_activity.sql.
[0m18:54:40.120765 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=terraform-tutorial-430708&j=bq:EU:359d2ae0-351a-46b6-9135-0ad16be0a1b0&page=queryresults
[0m18:54:40.501403 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'aee75889-73e4-4929-a3e8-51a0733df89a', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116fa2e20>]}
[0m18:54:40.503585 [info ] [Thread-2  ]: 5 of 5 OK created sql view model ecommerce_data_raw_reporting.fact_sales ....... [[32mCREATE VIEW (0 processed)[0m in 1.62s]
[0m18:54:40.504443 [debug] [Thread-2  ]: Finished running node model.ecommerce_dbt.fact_sales
[0m18:54:40.505936 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:54:40.506718 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:54:40.507086 [debug] [MainThread]: Connection 'model.ecommerce_dbt.dim_product' was properly closed.
[0m18:54:40.507432 [debug] [MainThread]: Connection 'model.ecommerce_dbt.fact_sales' was properly closed.
[0m18:54:40.507748 [debug] [MainThread]: Connection 'model.ecommerce_dbt.stg_sales' was properly closed.
[0m18:54:40.508061 [debug] [MainThread]: Connection 'model.ecommerce_dbt.fact_customer_activity' was properly closed.
[0m18:54:40.508514 [info ] [MainThread]: 
[0m18:54:40.508887 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 5.93 seconds (5.93s).
[0m18:54:40.510265 [debug] [MainThread]: Command end result
[0m18:54:40.537351 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jandytenedora/Interview/python-interview-gpt-question/dbt/ecommerce_dbt/target/manifest.json
[0m18:54:40.538754 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jandytenedora/Interview/python-interview-gpt-question/dbt/ecommerce_dbt/target/semantic_manifest.json
[0m18:54:40.543950 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/jandytenedora/Interview/python-interview-gpt-question/dbt/ecommerce_dbt/target/run_results.json
[0m18:54:40.544205 [info ] [MainThread]: 
[0m18:54:40.544478 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:54:40.544710 [info ] [MainThread]: 
[0m18:54:40.544982 [error] [MainThread]:   Database Error in model fact_customer_activity (models/marts/fact_customer_activity.sql)
  Syntax error: Unexpected "=" at [9:33]
  compiled code at target/run/ecommerce_dbt/models/marts/fact_customer_activity.sql
[0m18:54:40.545201 [info ] [MainThread]: 
[0m18:54:40.545435 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m18:54:40.546879 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 7.3048763, "process_in_blocks": "0", "process_kernel_time": 0.334195, "process_mem_max_rss": "195985408", "process_out_blocks": "0", "process_user_time": 2.123683}
[0m18:54:40.547187 [debug] [MainThread]: Command `dbt run` failed at 18:54:40.547130 after 7.31 seconds
[0m18:54:40.547471 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105f73040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116f951c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1102ed670>]}
[0m18:54:40.547745 [debug] [MainThread]: Flushing usage events
[0m18:54:42.556704 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:54:51.250880 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107789fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086182b0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1086180d0>]}


============================== 18:54:51.254300 | ee3633fa-6012-418d-89cd-11ed17f2bf8f ==============================
[0m18:54:51.254300 [info ] [MainThread]: Running with dbt=1.9.1
[0m18:54:51.254739 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'version_check': 'True', 'log_path': '/Users/jandytenedora/Interview/python-interview-gpt-question/dbt/ecommerce_dbt/logs', 'fail_fast': 'False', 'profiles_dir': '/Users/jandytenedora/.dbt', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'introspect': 'True', 'log_format': 'default', 'static_parser': 'True', 'target_path': 'None', 'invocation_command': 'dbt compile', 'send_anonymous_usage_stats': 'True'}
[0m18:54:51.927463 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'ee3633fa-6012-418d-89cd-11ed17f2bf8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068c9a90>]}
[0m18:54:51.968646 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'ee3633fa-6012-418d-89cd-11ed17f2bf8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10860d2e0>]}
[0m18:54:51.969136 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m18:54:52.084252 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m18:54:52.251997 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:54:52.252514 [debug] [MainThread]: Partial parsing: updated file: ecommerce_dbt://models/marts/fact_customer_activity.sql
[0m18:54:52.579314 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'ee3633fa-6012-418d-89cd-11ed17f2bf8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10f00b130>]}
[0m18:54:52.660419 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jandytenedora/Interview/python-interview-gpt-question/dbt/ecommerce_dbt/target/manifest.json
[0m18:54:52.663361 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jandytenedora/Interview/python-interview-gpt-question/dbt/ecommerce_dbt/target/semantic_manifest.json
[0m18:54:52.675583 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'ee3633fa-6012-418d-89cd-11ed17f2bf8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10eecc550>]}
[0m18:54:52.675983 [info ] [MainThread]: Found 5 models, 7 data tests, 3 sources, 489 macros
[0m18:54:52.676250 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee3633fa-6012-418d-89cd-11ed17f2bf8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10804cee0>]}
[0m18:54:52.677834 [info ] [MainThread]: 
[0m18:54:52.678100 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:54:52.678312 [info ] [MainThread]: 
[0m18:54:52.678673 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:54:52.682113 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_terraform-tutorial-430708_ecommerce_data_raw_reporting'
[0m18:54:52.682521 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_terraform-tutorial-430708_ecommerce_data_raw_staging'
[0m18:54:52.682748 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:54:52.682997 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:54:54.330673 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'ee3633fa-6012-418d-89cd-11ed17f2bf8f', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10e5dcd00>]}
[0m18:54:54.332225 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:54:54.338207 [debug] [Thread-1  ]: Began running node model.ecommerce_dbt.dim_product
[0m18:54:54.338953 [debug] [Thread-2  ]: Began running node model.ecommerce_dbt.stg_customer_logs
[0m18:54:54.339702 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_terraform-tutorial-430708_ecommerce_data_raw_reporting, now model.ecommerce_dbt.dim_product)
[0m18:54:54.340281 [debug] [Thread-3  ]: Began running node model.ecommerce_dbt.stg_sales
[0m18:54:54.340906 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_terraform-tutorial-430708_ecommerce_data_raw_staging, now model.ecommerce_dbt.stg_customer_logs)
[0m18:54:54.341459 [debug] [Thread-1  ]: Began compiling node model.ecommerce_dbt.dim_product
[0m18:54:54.342123 [debug] [Thread-3  ]: Acquiring new bigquery connection 'model.ecommerce_dbt.stg_sales'
[0m18:54:54.342630 [debug] [Thread-2  ]: Began compiling node model.ecommerce_dbt.stg_customer_logs
[0m18:54:54.354571 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_dbt.dim_product"
[0m18:54:54.355015 [debug] [Thread-3  ]: Began compiling node model.ecommerce_dbt.stg_sales
[0m18:54:54.358051 [debug] [Thread-2  ]: Writing injected SQL for node "model.ecommerce_dbt.stg_customer_logs"
[0m18:54:54.361078 [debug] [Thread-3  ]: Writing injected SQL for node "model.ecommerce_dbt.stg_sales"
[0m18:54:54.361789 [debug] [Thread-1  ]: Began executing node model.ecommerce_dbt.dim_product
[0m18:54:54.362132 [debug] [Thread-2  ]: Began executing node model.ecommerce_dbt.stg_customer_logs
[0m18:54:54.362499 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:54:54.362866 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m18:54:54.363161 [debug] [Thread-3  ]: Began executing node model.ecommerce_dbt.stg_sales
[0m18:54:54.364092 [debug] [Thread-1  ]: Finished running node model.ecommerce_dbt.dim_product
[0m18:54:54.364788 [debug] [Thread-2  ]: Finished running node model.ecommerce_dbt.stg_customer_logs
[0m18:54:54.365075 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m18:54:54.365878 [debug] [Thread-3  ]: Finished running node model.ecommerce_dbt.stg_sales
[0m18:54:54.366259 [debug] [Thread-4  ]: Began running node model.ecommerce_dbt.fact_customer_activity
[0m18:54:54.366683 [debug] [Thread-4  ]: Acquiring new bigquery connection 'model.ecommerce_dbt.fact_customer_activity'
[0m18:54:54.366968 [debug] [Thread-2  ]: Began running node model.ecommerce_dbt.fact_sales
[0m18:54:54.367228 [debug] [Thread-4  ]: Began compiling node model.ecommerce_dbt.fact_customer_activity
[0m18:54:54.367535 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.ecommerce_dbt.stg_customer_logs, now model.ecommerce_dbt.fact_sales)
[0m18:54:54.370176 [debug] [Thread-4  ]: Writing injected SQL for node "model.ecommerce_dbt.fact_customer_activity"
[0m18:54:54.370490 [debug] [Thread-2  ]: Began compiling node model.ecommerce_dbt.fact_sales
[0m18:54:54.373623 [debug] [Thread-2  ]: Writing injected SQL for node "model.ecommerce_dbt.fact_sales"
[0m18:54:54.374104 [debug] [Thread-2  ]: Began executing node model.ecommerce_dbt.fact_sales
[0m18:54:54.374370 [debug] [Thread-4  ]: Began executing node model.ecommerce_dbt.fact_customer_activity
[0m18:54:54.374628 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m18:54:54.374888 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m18:54:54.375482 [debug] [Thread-2  ]: Finished running node model.ecommerce_dbt.fact_sales
[0m18:54:54.376027 [debug] [Thread-4  ]: Finished running node model.ecommerce_dbt.fact_customer_activity
[0m18:54:54.376652 [debug] [Thread-1  ]: Began running node test.ecommerce_dbt.not_null_fact_sales_product_id.39101802a8
[0m18:54:54.376943 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly model.ecommerce_dbt.dim_product, now test.ecommerce_dbt.not_null_fact_sales_product_id.39101802a8)
[0m18:54:54.377198 [debug] [Thread-3  ]: Began running node test.ecommerce_dbt.not_null_fact_sales_sale_date.aeb11a016c
[0m18:54:54.377455 [debug] [Thread-2  ]: Began running node test.ecommerce_dbt.not_null_fact_sales_total_quantity.a24e8f3a97
[0m18:54:54.377696 [debug] [Thread-1  ]: Began compiling node test.ecommerce_dbt.not_null_fact_sales_product_id.39101802a8
[0m18:54:54.377930 [debug] [Thread-4  ]: Began running node test.ecommerce_dbt.not_null_fact_sales_total_revenue.e93f0630dd
[0m18:54:54.378194 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.ecommerce_dbt.stg_sales, now test.ecommerce_dbt.not_null_fact_sales_sale_date.aeb11a016c)
[0m18:54:54.378475 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.ecommerce_dbt.fact_sales, now test.ecommerce_dbt.not_null_fact_sales_total_quantity.a24e8f3a97)
[0m18:54:54.383897 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly model.ecommerce_dbt.fact_customer_activity, now test.ecommerce_dbt.not_null_fact_sales_total_revenue.e93f0630dd)
[0m18:54:54.388142 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_dbt.not_null_fact_sales_product_id.39101802a8"
[0m18:54:54.388455 [debug] [Thread-3  ]: Began compiling node test.ecommerce_dbt.not_null_fact_sales_sale_date.aeb11a016c
[0m18:54:54.388714 [debug] [Thread-2  ]: Began compiling node test.ecommerce_dbt.not_null_fact_sales_total_quantity.a24e8f3a97
[0m18:54:54.388959 [debug] [Thread-4  ]: Began compiling node test.ecommerce_dbt.not_null_fact_sales_total_revenue.e93f0630dd
[0m18:54:54.392215 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_dbt.not_null_fact_sales_sale_date.aeb11a016c"
[0m18:54:54.395411 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_dbt.not_null_fact_sales_total_quantity.a24e8f3a97"
[0m18:54:54.398688 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_dbt.not_null_fact_sales_total_revenue.e93f0630dd"
[0m18:54:54.398986 [debug] [Thread-1  ]: Began executing node test.ecommerce_dbt.not_null_fact_sales_product_id.39101802a8
[0m18:54:54.399559 [debug] [Thread-3  ]: Began executing node test.ecommerce_dbt.not_null_fact_sales_sale_date.aeb11a016c
[0m18:54:54.399944 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:54:54.400236 [debug] [Thread-2  ]: Began executing node test.ecommerce_dbt.not_null_fact_sales_total_quantity.a24e8f3a97
[0m18:54:54.400526 [debug] [Thread-4  ]: Began executing node test.ecommerce_dbt.not_null_fact_sales_total_revenue.e93f0630dd
[0m18:54:54.400804 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m18:54:54.401453 [debug] [Thread-1  ]: Finished running node test.ecommerce_dbt.not_null_fact_sales_product_id.39101802a8
[0m18:54:54.401723 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m18:54:54.401986 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m18:54:54.402545 [debug] [Thread-3  ]: Finished running node test.ecommerce_dbt.not_null_fact_sales_sale_date.aeb11a016c
[0m18:54:54.402825 [debug] [Thread-1  ]: Began running node test.ecommerce_dbt.not_null_fact_customer_activity_activity_date.412e077efb
[0m18:54:54.403422 [debug] [Thread-2  ]: Finished running node test.ecommerce_dbt.not_null_fact_sales_total_quantity.a24e8f3a97
[0m18:54:54.403968 [debug] [Thread-4  ]: Finished running node test.ecommerce_dbt.not_null_fact_sales_total_revenue.e93f0630dd
[0m18:54:54.404241 [debug] [Thread-3  ]: Began running node test.ecommerce_dbt.not_null_fact_customer_activity_activity_type.0bf9b8fb18
[0m18:54:54.404543 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_dbt.not_null_fact_sales_product_id.39101802a8, now test.ecommerce_dbt.not_null_fact_customer_activity_activity_date.412e077efb)
[0m18:54:54.404858 [debug] [Thread-2  ]: Began running node test.ecommerce_dbt.not_null_fact_customer_activity_customer_id.8c4e1c83bf
[0m18:54:54.405202 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_dbt.not_null_fact_sales_sale_date.aeb11a016c, now test.ecommerce_dbt.not_null_fact_customer_activity_activity_type.0bf9b8fb18)
[0m18:54:54.405467 [debug] [Thread-1  ]: Began compiling node test.ecommerce_dbt.not_null_fact_customer_activity_activity_date.412e077efb
[0m18:54:54.405744 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_dbt.not_null_fact_sales_total_quantity.a24e8f3a97, now test.ecommerce_dbt.not_null_fact_customer_activity_customer_id.8c4e1c83bf)
[0m18:54:54.405989 [debug] [Thread-3  ]: Began compiling node test.ecommerce_dbt.not_null_fact_customer_activity_activity_type.0bf9b8fb18
[0m18:54:54.409347 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_dbt.not_null_fact_customer_activity_activity_date.412e077efb"
[0m18:54:54.409634 [debug] [Thread-2  ]: Began compiling node test.ecommerce_dbt.not_null_fact_customer_activity_customer_id.8c4e1c83bf
[0m18:54:54.413687 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_dbt.not_null_fact_customer_activity_activity_type.0bf9b8fb18"
[0m18:54:54.416969 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_dbt.not_null_fact_customer_activity_customer_id.8c4e1c83bf"
[0m18:54:54.417454 [debug] [Thread-3  ]: Began executing node test.ecommerce_dbt.not_null_fact_customer_activity_activity_type.0bf9b8fb18
[0m18:54:54.417723 [debug] [Thread-2  ]: Began executing node test.ecommerce_dbt.not_null_fact_customer_activity_customer_id.8c4e1c83bf
[0m18:54:54.417991 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m18:54:54.418223 [debug] [Thread-1  ]: Began executing node test.ecommerce_dbt.not_null_fact_customer_activity_activity_date.412e077efb
[0m18:54:54.418475 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m18:54:54.419040 [debug] [Thread-3  ]: Finished running node test.ecommerce_dbt.not_null_fact_customer_activity_activity_type.0bf9b8fb18
[0m18:54:54.419293 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:54:54.419812 [debug] [Thread-2  ]: Finished running node test.ecommerce_dbt.not_null_fact_customer_activity_customer_id.8c4e1c83bf
[0m18:54:54.420426 [debug] [Thread-1  ]: Finished running node test.ecommerce_dbt.not_null_fact_customer_activity_activity_date.412e077efb
[0m18:54:54.421173 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:54:54.421393 [debug] [MainThread]: Connection 'test.ecommerce_dbt.not_null_fact_customer_activity_activity_date.412e077efb' was properly closed.
[0m18:54:54.421590 [debug] [MainThread]: Connection 'test.ecommerce_dbt.not_null_fact_customer_activity_customer_id.8c4e1c83bf' was properly closed.
[0m18:54:54.421783 [debug] [MainThread]: Connection 'test.ecommerce_dbt.not_null_fact_customer_activity_activity_type.0bf9b8fb18' was properly closed.
[0m18:54:54.421973 [debug] [MainThread]: Connection 'test.ecommerce_dbt.not_null_fact_sales_total_revenue.e93f0630dd' was properly closed.
[0m18:54:54.423389 [debug] [MainThread]: Command end result
[0m18:54:54.444882 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jandytenedora/Interview/python-interview-gpt-question/dbt/ecommerce_dbt/target/manifest.json
[0m18:54:54.446178 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jandytenedora/Interview/python-interview-gpt-question/dbt/ecommerce_dbt/target/semantic_manifest.json
[0m18:54:54.452118 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/jandytenedora/Interview/python-interview-gpt-question/dbt/ecommerce_dbt/target/run_results.json
[0m18:54:54.453651 [debug] [MainThread]: Resource report: {"command_name": "compile", "command_success": true, "command_wall_clock_time": 3.2552133, "process_in_blocks": "0", "process_kernel_time": 0.281792, "process_mem_max_rss": "198197248", "process_out_blocks": "0", "process_user_time": 2.184018}
[0m18:54:54.453981 [debug] [MainThread]: Command `dbt compile` succeeded at 18:54:54.453918 after 3.26 seconds
[0m18:54:54.454259 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107789fa0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11273f880>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1068c9a90>]}
[0m18:54:54.454535 [debug] [MainThread]: Flushing usage events
[0m18:54:55.663647 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:55:03.288527 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104923070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057b5e80>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1057b51f0>]}


============================== 18:55:03.292152 | c07110c0-c867-4057-8248-720a874c7d14 ==============================
[0m18:55:03.292152 [info ] [MainThread]: Running with dbt=1.9.1
[0m18:55:03.292580 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jandytenedora/.dbt', 'version_check': 'True', 'warn_error': 'None', 'log_path': '/Users/jandytenedora/Interview/python-interview-gpt-question/dbt/ecommerce_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'introspect': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:55:04.005337 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'c07110c0-c867-4057-8248-720a874c7d14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x103a59af0>]}
[0m18:55:04.047014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'c07110c0-c867-4057-8248-720a874c7d14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10b6973a0>]}
[0m18:55:04.047492 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m18:55:04.154278 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m18:55:04.324893 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:55:04.325277 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:55:04.368019 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'c07110c0-c867-4057-8248-720a874c7d14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb74ee0>]}
[0m18:55:04.454327 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jandytenedora/Interview/python-interview-gpt-question/dbt/ecommerce_dbt/target/manifest.json
[0m18:55:04.457381 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jandytenedora/Interview/python-interview-gpt-question/dbt/ecommerce_dbt/target/semantic_manifest.json
[0m18:55:04.471461 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'c07110c0-c867-4057-8248-720a874c7d14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb971c0>]}
[0m18:55:04.471901 [info ] [MainThread]: Found 5 models, 7 data tests, 3 sources, 489 macros
[0m18:55:04.472180 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c07110c0-c867-4057-8248-720a874c7d14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb598b0>]}
[0m18:55:04.473347 [info ] [MainThread]: 
[0m18:55:04.473621 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:55:04.473835 [info ] [MainThread]: 
[0m18:55:04.474172 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:55:04.477648 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_terraform-tutorial-430708'
[0m18:55:04.478015 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:55:04.478328 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_terraform-tutorial-430708'
[0m18:55:04.478700 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:55:06.816322 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_terraform-tutorial-430708, now list_terraform-tutorial-430708_ecommerce_data_raw_reporting)
[0m18:55:06.817019 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:55:06.817458 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_terraform-tutorial-430708, now list_terraform-tutorial-430708_ecommerce_data_raw_staging)
[0m18:55:06.818521 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:55:07.338800 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'c07110c0-c867-4057-8248-720a874c7d14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10575d9a0>]}
[0m18:55:07.339613 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:55:07.341931 [debug] [Thread-1  ]: Began running node model.ecommerce_dbt.dim_product
[0m18:55:07.342328 [debug] [Thread-2  ]: Began running node model.ecommerce_dbt.stg_customer_logs
[0m18:55:07.343155 [debug] [Thread-3  ]: Began running node model.ecommerce_dbt.stg_sales
[0m18:55:07.342849 [info ] [Thread-1  ]: 1 of 5 START sql view model ecommerce_data_raw_reporting.dim_product ........... [RUN]
[0m18:55:07.343808 [info ] [Thread-2  ]: 2 of 5 START sql view model ecommerce_data_raw_staging.stg_customer_logs ....... [RUN]
[0m18:55:07.344498 [info ] [Thread-3  ]: 3 of 5 START sql view model ecommerce_data_raw_staging.stg_sales ............... [RUN]
[0m18:55:07.345108 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_terraform-tutorial-430708_ecommerce_data_raw_reporting, now model.ecommerce_dbt.dim_product)
[0m18:55:07.345520 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_terraform-tutorial-430708_ecommerce_data_raw_staging, now model.ecommerce_dbt.stg_customer_logs)
[0m18:55:07.345962 [debug] [Thread-3  ]: Acquiring new bigquery connection 'model.ecommerce_dbt.stg_sales'
[0m18:55:07.346414 [debug] [Thread-1  ]: Began compiling node model.ecommerce_dbt.dim_product
[0m18:55:07.346826 [debug] [Thread-2  ]: Began compiling node model.ecommerce_dbt.stg_customer_logs
[0m18:55:07.347156 [debug] [Thread-3  ]: Began compiling node model.ecommerce_dbt.stg_sales
[0m18:55:07.358790 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_dbt.dim_product"
[0m18:55:07.361450 [debug] [Thread-2  ]: Writing injected SQL for node "model.ecommerce_dbt.stg_customer_logs"
[0m18:55:07.363789 [debug] [Thread-3  ]: Writing injected SQL for node "model.ecommerce_dbt.stg_sales"
[0m18:55:07.365374 [debug] [Thread-1  ]: Began executing node model.ecommerce_dbt.dim_product
[0m18:55:07.365726 [debug] [Thread-3  ]: Began executing node model.ecommerce_dbt.stg_sales
[0m18:55:07.372324 [debug] [Thread-2  ]: Began executing node model.ecommerce_dbt.stg_customer_logs
[0m18:55:07.395691 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_dbt.dim_product"
[0m18:55:07.396545 [debug] [Thread-3  ]: Writing runtime sql for node "model.ecommerce_dbt.stg_sales"
[0m18:55:07.399816 [debug] [Thread-2  ]: Writing runtime sql for node "model.ecommerce_dbt.stg_customer_logs"
[0m18:55:07.400783 [debug] [Thread-1  ]: On model.ecommerce_dbt.dim_product: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.dim_product"} */


  create or replace view `terraform-tutorial-430708`.`ecommerce_data_raw_reporting`.`dim_product`
  OPTIONS()
  as SELECT
    product_id,
    category,
    device
FROM `terraform-tutorial-430708`.`ecommerce_data_raw`.`product_catalog`;


[0m18:55:07.401241 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:55:07.402083 [debug] [Thread-3  ]: On model.ecommerce_dbt.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.stg_sales"} */


  create or replace view `terraform-tutorial-430708`.`ecommerce_data_raw_staging`.`stg_sales`
  OPTIONS()
  as WITH cleaned_sales AS (
    SELECT
        transaction_id,
        product_id,
        sale_date,
        quantity,
        price_per_unit
    FROM `terraform-tutorial-430708`.`ecommerce_data_raw`.`raw_sales_data`
    WHERE sale_date IS NOT NULL
)
SELECT * FROM cleaned_sales;


[0m18:55:07.402442 [debug] [Thread-2  ]: On model.ecommerce_dbt.stg_customer_logs: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.stg_customer_logs"} */


  create or replace view `terraform-tutorial-430708`.`ecommerce_data_raw_staging`.`stg_customer_logs`
  OPTIONS()
  as WITH cleaned_customer_logs AS (
    SELECT
        timestamp,
        user_id,
        event_type,
        product_id
    FROM `terraform-tutorial-430708`.`ecommerce_data_raw`.`customer_logs`
    WHERE user_id IS NOT NULL
)
SELECT * FROM cleaned_customer_logs;


[0m18:55:07.403093 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m18:55:07.403442 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m18:55:07.934476 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=terraform-tutorial-430708&j=bq:EU:7da4ea40-43ec-48f0-b71f-af8934b64b50&page=queryresults
[0m18:55:08.156424 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=terraform-tutorial-430708&j=bq:EU:e51a3b05-5fc9-4380-8189-c8acb21923db&page=queryresults
[0m18:55:08.353755 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=terraform-tutorial-430708&j=bq:EU:0db5ebbe-5817-4b3a-9307-d0a040d9de5f&page=queryresults
[0m18:55:08.403412 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c07110c0-c867-4057-8248-720a874c7d14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bbdfeb0>]}
[0m18:55:08.404029 [info ] [Thread-1  ]: 1 of 5 OK created sql view model ecommerce_data_raw_reporting.dim_product ...... [[32mCREATE VIEW (0 processed)[0m in 1.06s]
[0m18:55:08.404494 [debug] [Thread-1  ]: Finished running node model.ecommerce_dbt.dim_product
[0m18:55:08.542138 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c07110c0-c867-4057-8248-720a874c7d14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd4cd30>]}
[0m18:55:08.542863 [info ] [Thread-3  ]: 3 of 5 OK created sql view model ecommerce_data_raw_staging.stg_sales .......... [[32mCREATE VIEW (0 processed)[0m in 1.20s]
[0m18:55:08.543313 [debug] [Thread-3  ]: Finished running node model.ecommerce_dbt.stg_sales
[0m18:55:08.543817 [debug] [Thread-4  ]: Began running node model.ecommerce_dbt.fact_sales
[0m18:55:08.544167 [info ] [Thread-4  ]: 4 of 5 START sql view model ecommerce_data_raw_reporting.fact_sales ............ [RUN]
[0m18:55:08.544546 [debug] [Thread-4  ]: Acquiring new bigquery connection 'model.ecommerce_dbt.fact_sales'
[0m18:55:08.544795 [debug] [Thread-4  ]: Began compiling node model.ecommerce_dbt.fact_sales
[0m18:55:08.547908 [debug] [Thread-4  ]: Writing injected SQL for node "model.ecommerce_dbt.fact_sales"
[0m18:55:08.548615 [debug] [Thread-4  ]: Began executing node model.ecommerce_dbt.fact_sales
[0m18:55:08.551328 [debug] [Thread-4  ]: Writing runtime sql for node "model.ecommerce_dbt.fact_sales"
[0m18:55:08.552138 [debug] [Thread-4  ]: On model.ecommerce_dbt.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.fact_sales"} */


  create or replace view `terraform-tutorial-430708`.`ecommerce_data_raw_reporting`.`fact_sales`
  OPTIONS()
  as SELECT
    sale_date,
    product_id,
    SUM(quantity) AS total_quantity,
    SUM(quantity * price_per_unit) AS total_revenue
FROM `terraform-tutorial-430708`.`ecommerce_data_raw_staging`.`stg_sales`
GROUP BY
sale_date, product_id;


[0m18:55:08.552640 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m18:55:08.710873 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c07110c0-c867-4057-8248-720a874c7d14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bd84fa0>]}
[0m18:55:08.711621 [info ] [Thread-2  ]: 2 of 5 OK created sql view model ecommerce_data_raw_staging.stg_customer_logs .. [[32mCREATE VIEW (0 processed)[0m in 1.37s]
[0m18:55:08.712221 [debug] [Thread-2  ]: Finished running node model.ecommerce_dbt.stg_customer_logs
[0m18:55:08.712750 [debug] [Thread-3  ]: Began running node model.ecommerce_dbt.fact_customer_activity
[0m18:55:08.713263 [info ] [Thread-3  ]: 5 of 5 START sql view model ecommerce_data_raw_reporting.fact_customer_activity  [RUN]
[0m18:55:08.713696 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.ecommerce_dbt.stg_sales, now model.ecommerce_dbt.fact_customer_activity)
[0m18:55:08.714052 [debug] [Thread-3  ]: Began compiling node model.ecommerce_dbt.fact_customer_activity
[0m18:55:08.717172 [debug] [Thread-3  ]: Writing injected SQL for node "model.ecommerce_dbt.fact_customer_activity"
[0m18:55:08.717870 [debug] [Thread-3  ]: Began executing node model.ecommerce_dbt.fact_customer_activity
[0m18:55:08.722095 [debug] [Thread-3  ]: Writing runtime sql for node "model.ecommerce_dbt.fact_customer_activity"
[0m18:55:08.722880 [debug] [Thread-3  ]: On model.ecommerce_dbt.fact_customer_activity: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.fact_customer_activity"} */


  create or replace view `terraform-tutorial-430708`.`ecommerce_data_raw_reporting`.`fact_customer_activity`
  OPTIONS()
  as SELECT
    user_id,
    DATE(timestamp) AS activity_date,
    COUNT(CASE WHEN event_type = 'view' THEN 1) AS views,
    COUNT(CASE WHEN event_type = 'clicks' THEN 1) AS clicks,
    COUNT(CASE WHEN event_type = 'purchases' THEN 1) AS purchases,
FROM `terraform-tutorial-430708`.`ecommerce_data_raw_staging`.`stg_customer_logs`
GROUP BY user_id, product_id, activity_date;


[0m18:55:08.723356 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m18:55:09.592847 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=terraform-tutorial-430708&j=bq:EU:7c987cef-c3d6-4c6a-9052-ff55528c2fa1&page=queryresults
[0m18:55:09.595206 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=terraform-tutorial-430708&j=bq:EU:c9d194f4-6b93-4031-99e1-c7a6dcdb770f&page=queryresults
[0m18:55:09.596977 [error] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=terraform-tutorial-430708&j=bq:EU:c9d194f4-6b93-4031-99e1-c7a6dcdb770f&page=queryresults
[0m18:55:09.638149 [debug] [Thread-3  ]: Database Error in model fact_customer_activity (models/marts/fact_customer_activity.sql)
  Syntax error: Expected keyword ELSE or keyword END but got ")" at [9:47]
  compiled code at target/run/ecommerce_dbt/models/marts/fact_customer_activity.sql
[0m18:55:09.638690 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c07110c0-c867-4057-8248-720a874c7d14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bbdf100>]}
[0m18:55:09.639226 [error] [Thread-3  ]: 5 of 5 ERROR creating sql view model ecommerce_data_raw_reporting.fact_customer_activity  [[31mERROR[0m in 0.92s]
[0m18:55:09.639663 [debug] [Thread-3  ]: Finished running node model.ecommerce_dbt.fact_customer_activity
[0m18:55:09.640117 [debug] [Thread-7  ]: Marking all children of 'model.ecommerce_dbt.fact_customer_activity' to be skipped because of status 'error'.  Reason: Database Error in model fact_customer_activity (models/marts/fact_customer_activity.sql)
  Syntax error: Expected keyword ELSE or keyword END but got ")" at [9:47]
  compiled code at target/run/ecommerce_dbt/models/marts/fact_customer_activity.sql.
[0m18:55:09.996733 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'c07110c0-c867-4057-8248-720a874c7d14', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bb97490>]}
[0m18:55:09.997918 [info ] [Thread-4  ]: 4 of 5 OK created sql view model ecommerce_data_raw_reporting.fact_sales ....... [[32mCREATE VIEW (0 processed)[0m in 1.45s]
[0m18:55:09.998754 [debug] [Thread-4  ]: Finished running node model.ecommerce_dbt.fact_sales
[0m18:55:10.000402 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:55:10.001265 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:55:10.001671 [debug] [MainThread]: Connection 'model.ecommerce_dbt.dim_product' was properly closed.
[0m18:55:10.002061 [debug] [MainThread]: Connection 'model.ecommerce_dbt.stg_customer_logs' was properly closed.
[0m18:55:10.002434 [debug] [MainThread]: Connection 'model.ecommerce_dbt.fact_customer_activity' was properly closed.
[0m18:55:10.002786 [debug] [MainThread]: Connection 'model.ecommerce_dbt.fact_sales' was properly closed.
[0m18:55:10.003220 [info ] [MainThread]: 
[0m18:55:10.003612 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 5.53 seconds (5.53s).
[0m18:55:10.005025 [debug] [MainThread]: Command end result
[0m18:55:10.034723 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jandytenedora/Interview/python-interview-gpt-question/dbt/ecommerce_dbt/target/manifest.json
[0m18:55:10.036341 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jandytenedora/Interview/python-interview-gpt-question/dbt/ecommerce_dbt/target/semantic_manifest.json
[0m18:55:10.041970 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/jandytenedora/Interview/python-interview-gpt-question/dbt/ecommerce_dbt/target/run_results.json
[0m18:55:10.042233 [info ] [MainThread]: 
[0m18:55:10.042509 [info ] [MainThread]: [31mCompleted with 1 error, 0 partial successes, and 0 warnings:[0m
[0m18:55:10.042744 [info ] [MainThread]: 
[0m18:55:10.043024 [error] [MainThread]:   Database Error in model fact_customer_activity (models/marts/fact_customer_activity.sql)
  Syntax error: Expected keyword ELSE or keyword END but got ")" at [9:47]
  compiled code at target/run/ecommerce_dbt/models/marts/fact_customer_activity.sql
[0m18:55:10.043248 [info ] [MainThread]: 
[0m18:55:10.043481 [info ] [MainThread]: Done. PASS=4 WARN=0 ERROR=1 SKIP=0 TOTAL=5
[0m18:55:10.044984 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": false, "command_wall_clock_time": 6.821649, "process_in_blocks": "0", "process_kernel_time": 0.325365, "process_mem_max_rss": "194183168", "process_out_blocks": "0", "process_user_time": 2.100418}
[0m18:55:10.045307 [debug] [MainThread]: Command `dbt run` failed at 18:55:10.045247 after 6.82 seconds
[0m18:55:10.045598 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104923070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10bccc0a0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104aae7c0>]}
[0m18:55:10.045874 [debug] [MainThread]: Flushing usage events
[0m18:55:11.111131 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:55:22.089350 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ba7040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110559e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1105591f0>]}


============================== 18:55:22.093892 | bb455540-62c6-4d73-bcc7-7eefc3636e60 ==============================
[0m18:55:22.093892 [info ] [MainThread]: Running with dbt=1.9.1
[0m18:55:22.094368 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'write_json': 'True', 'log_cache_events': 'False', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jandytenedora/.dbt', 'version_check': 'True', 'debug': 'False', 'log_path': '/Users/jandytenedora/Interview/python-interview-gpt-question/dbt/ecommerce_dbt/logs', 'warn_error': 'None', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'static_parser': 'True', 'invocation_command': 'dbt run', 'introspect': 'True', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m18:55:23.038821 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'bb455540-62c6-4d73-bcc7-7eefc3636e60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105cddaf0>]}
[0m18:55:23.080808 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'bb455540-62c6-4d73-bcc7-7eefc3636e60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x131927400>]}
[0m18:55:23.081289 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m18:55:23.191077 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m18:55:23.366657 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:55:23.367268 [debug] [MainThread]: Partial parsing: updated file: ecommerce_dbt://models/marts/fact_customer_activity.sql
[0m18:55:23.688083 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'bb455540-62c6-4d73-bcc7-7eefc3636e60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x132946130>]}
[0m18:55:23.769821 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jandytenedora/Interview/python-interview-gpt-question/dbt/ecommerce_dbt/target/manifest.json
[0m18:55:23.772499 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jandytenedora/Interview/python-interview-gpt-question/dbt/ecommerce_dbt/target/semantic_manifest.json
[0m18:55:23.786724 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'bb455540-62c6-4d73-bcc7-7eefc3636e60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x132901b80>]}
[0m18:55:23.787139 [info ] [MainThread]: Found 5 models, 7 data tests, 3 sources, 489 macros
[0m18:55:23.787401 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb455540-62c6-4d73-bcc7-7eefc3636e60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x116d64700>]}
[0m18:55:23.788586 [info ] [MainThread]: 
[0m18:55:23.788846 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:55:23.789054 [info ] [MainThread]: 
[0m18:55:23.789430 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:55:23.792925 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_terraform-tutorial-430708'
[0m18:55:23.793319 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_terraform-tutorial-430708'
[0m18:55:23.793564 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:55:23.793828 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:55:26.738574 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_terraform-tutorial-430708, now list_terraform-tutorial-430708_ecommerce_data_raw_staging)
[0m18:55:26.739836 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:55:26.740706 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_terraform-tutorial-430708, now list_terraform-tutorial-430708_ecommerce_data_raw_reporting)
[0m18:55:26.742548 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:55:27.934190 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'bb455540-62c6-4d73-bcc7-7eefc3636e60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105d5fca0>]}
[0m18:55:27.935434 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:55:27.938910 [debug] [Thread-1  ]: Began running node model.ecommerce_dbt.dim_product
[0m18:55:27.939711 [debug] [Thread-2  ]: Began running node model.ecommerce_dbt.stg_customer_logs
[0m18:55:27.940366 [debug] [Thread-3  ]: Began running node model.ecommerce_dbt.stg_sales
[0m18:55:27.941186 [info ] [Thread-1  ]: 1 of 5 START sql view model ecommerce_data_raw_reporting.dim_product ........... [RUN]
[0m18:55:27.941998 [info ] [Thread-2  ]: 2 of 5 START sql view model ecommerce_data_raw_staging.stg_customer_logs ....... [RUN]
[0m18:55:27.942791 [info ] [Thread-3  ]: 3 of 5 START sql view model ecommerce_data_raw_staging.stg_sales ............... [RUN]
[0m18:55:27.943514 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_terraform-tutorial-430708_ecommerce_data_raw_staging, now model.ecommerce_dbt.dim_product)
[0m18:55:27.944010 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_terraform-tutorial-430708_ecommerce_data_raw_reporting, now model.ecommerce_dbt.stg_customer_logs)
[0m18:55:27.944709 [debug] [Thread-3  ]: Acquiring new bigquery connection 'model.ecommerce_dbt.stg_sales'
[0m18:55:27.945252 [debug] [Thread-1  ]: Began compiling node model.ecommerce_dbt.dim_product
[0m18:55:27.945698 [debug] [Thread-2  ]: Began compiling node model.ecommerce_dbt.stg_customer_logs
[0m18:55:27.946154 [debug] [Thread-3  ]: Began compiling node model.ecommerce_dbt.stg_sales
[0m18:55:27.956986 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_dbt.dim_product"
[0m18:55:27.960014 [debug] [Thread-2  ]: Writing injected SQL for node "model.ecommerce_dbt.stg_customer_logs"
[0m18:55:27.962754 [debug] [Thread-3  ]: Writing injected SQL for node "model.ecommerce_dbt.stg_sales"
[0m18:55:27.963695 [debug] [Thread-2  ]: Began executing node model.ecommerce_dbt.stg_customer_logs
[0m18:55:27.964117 [debug] [Thread-3  ]: Began executing node model.ecommerce_dbt.stg_sales
[0m18:55:27.976262 [debug] [Thread-1  ]: Began executing node model.ecommerce_dbt.dim_product
[0m18:55:28.010748 [debug] [Thread-2  ]: Writing runtime sql for node "model.ecommerce_dbt.stg_customer_logs"
[0m18:55:28.012615 [debug] [Thread-3  ]: Writing runtime sql for node "model.ecommerce_dbt.stg_sales"
[0m18:55:28.014401 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_dbt.dim_product"
[0m18:55:28.015031 [debug] [Thread-3  ]: On model.ecommerce_dbt.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.stg_sales"} */


  create or replace view `terraform-tutorial-430708`.`ecommerce_data_raw_staging`.`stg_sales`
  OPTIONS()
  as WITH cleaned_sales AS (
    SELECT
        transaction_id,
        product_id,
        sale_date,
        quantity,
        price_per_unit
    FROM `terraform-tutorial-430708`.`ecommerce_data_raw`.`raw_sales_data`
    WHERE sale_date IS NOT NULL
)
SELECT * FROM cleaned_sales;


[0m18:55:28.015379 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m18:55:28.017868 [debug] [Thread-2  ]: On model.ecommerce_dbt.stg_customer_logs: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.stg_customer_logs"} */


  create or replace view `terraform-tutorial-430708`.`ecommerce_data_raw_staging`.`stg_customer_logs`
  OPTIONS()
  as WITH cleaned_customer_logs AS (
    SELECT
        timestamp,
        user_id,
        event_type,
        product_id
    FROM `terraform-tutorial-430708`.`ecommerce_data_raw`.`customer_logs`
    WHERE user_id IS NOT NULL
)
SELECT * FROM cleaned_customer_logs;


[0m18:55:28.018187 [debug] [Thread-1  ]: On model.ecommerce_dbt.dim_product: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.dim_product"} */


  create or replace view `terraform-tutorial-430708`.`ecommerce_data_raw_reporting`.`dim_product`
  OPTIONS()
  as SELECT
    product_id,
    category,
    device
FROM `terraform-tutorial-430708`.`ecommerce_data_raw`.`product_catalog`;


[0m18:55:28.018550 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m18:55:28.018823 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:55:28.951291 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=terraform-tutorial-430708&j=bq:EU:424bcaad-58ab-42f3-8fe1-04ed0bba05e2&page=queryresults
[0m18:55:28.955012 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=terraform-tutorial-430708&j=bq:EU:103de765-5b9e-4158-a4fc-793bc5278844&page=queryresults
[0m18:55:28.956161 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=terraform-tutorial-430708&j=bq:EU:852e9c5f-91ae-4b98-997a-de2ca3841906&page=queryresults
[0m18:55:29.845553 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb455540-62c6-4d73-bcc7-7eefc3636e60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x132908340>]}
[0m18:55:29.846267 [info ] [Thread-1  ]: 1 of 5 OK created sql view model ecommerce_data_raw_reporting.dim_product ...... [[32mCREATE VIEW (0 processed)[0m in 1.90s]
[0m18:55:29.846749 [debug] [Thread-1  ]: Finished running node model.ecommerce_dbt.dim_product
[0m18:55:30.310965 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb455540-62c6-4d73-bcc7-7eefc3636e60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x132cadaf0>]}
[0m18:55:30.312073 [info ] [Thread-3  ]: 3 of 5 OK created sql view model ecommerce_data_raw_staging.stg_sales .......... [[32mCREATE VIEW (0 processed)[0m in 2.37s]
[0m18:55:30.312909 [debug] [Thread-3  ]: Finished running node model.ecommerce_dbt.stg_sales
[0m18:55:30.313805 [debug] [Thread-4  ]: Began running node model.ecommerce_dbt.fact_sales
[0m18:55:30.314512 [info ] [Thread-4  ]: 4 of 5 START sql view model ecommerce_data_raw_reporting.fact_sales ............ [RUN]
[0m18:55:30.315172 [debug] [Thread-4  ]: Acquiring new bigquery connection 'model.ecommerce_dbt.fact_sales'
[0m18:55:30.315604 [debug] [Thread-4  ]: Began compiling node model.ecommerce_dbt.fact_sales
[0m18:55:30.320661 [debug] [Thread-4  ]: Writing injected SQL for node "model.ecommerce_dbt.fact_sales"
[0m18:55:30.321538 [debug] [Thread-4  ]: Began executing node model.ecommerce_dbt.fact_sales
[0m18:55:30.325230 [debug] [Thread-4  ]: Writing runtime sql for node "model.ecommerce_dbt.fact_sales"
[0m18:55:30.325963 [debug] [Thread-4  ]: On model.ecommerce_dbt.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.fact_sales"} */


  create or replace view `terraform-tutorial-430708`.`ecommerce_data_raw_reporting`.`fact_sales`
  OPTIONS()
  as SELECT
    sale_date,
    product_id,
    SUM(quantity) AS total_quantity,
    SUM(quantity * price_per_unit) AS total_revenue
FROM `terraform-tutorial-430708`.`ecommerce_data_raw_staging`.`stg_sales`
GROUP BY
sale_date, product_id;


[0m18:55:30.326422 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m18:55:30.379497 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb455540-62c6-4d73-bcc7-7eefc3636e60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x132ce9d60>]}
[0m18:55:30.380493 [info ] [Thread-2  ]: 2 of 5 OK created sql view model ecommerce_data_raw_staging.stg_customer_logs .. [[32mCREATE VIEW (0 processed)[0m in 2.44s]
[0m18:55:30.381197 [debug] [Thread-2  ]: Finished running node model.ecommerce_dbt.stg_customer_logs
[0m18:55:30.381916 [debug] [Thread-3  ]: Began running node model.ecommerce_dbt.fact_customer_activity
[0m18:55:30.382447 [info ] [Thread-3  ]: 5 of 5 START sql view model ecommerce_data_raw_reporting.fact_customer_activity  [RUN]
[0m18:55:30.382922 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.ecommerce_dbt.stg_sales, now model.ecommerce_dbt.fact_customer_activity)
[0m18:55:30.383298 [debug] [Thread-3  ]: Began compiling node model.ecommerce_dbt.fact_customer_activity
[0m18:55:30.387166 [debug] [Thread-3  ]: Writing injected SQL for node "model.ecommerce_dbt.fact_customer_activity"
[0m18:55:30.388084 [debug] [Thread-3  ]: Began executing node model.ecommerce_dbt.fact_customer_activity
[0m18:55:30.391117 [debug] [Thread-3  ]: Writing runtime sql for node "model.ecommerce_dbt.fact_customer_activity"
[0m18:55:30.391793 [debug] [Thread-3  ]: On model.ecommerce_dbt.fact_customer_activity: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.fact_customer_activity"} */


  create or replace view `terraform-tutorial-430708`.`ecommerce_data_raw_reporting`.`fact_customer_activity`
  OPTIONS()
  as SELECT
    user_id,
    DATE(timestamp) AS activity_date,
    COUNT(CASE WHEN event_type = 'view' THEN 1 END) AS views,
    COUNT(CASE WHEN event_type = 'clicks' THEN 1 END) AS clicks,
    COUNT(CASE WHEN event_type = 'purchases' THEN 1 END) AS purchases,
FROM `terraform-tutorial-430708`.`ecommerce_data_raw_staging`.`stg_customer_logs`
GROUP BY user_id, product_id, activity_date;


[0m18:55:30.392188 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m18:55:33.461322 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=terraform-tutorial-430708&j=bq:EU:a3b86607-5a99-4a7a-a8e2-2974fc107fe5&page=queryresults
[0m18:55:33.462917 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=terraform-tutorial-430708&j=bq:EU:f07aaeb5-776f-4595-8565-929b1c0bb976&page=queryresults
[0m18:55:34.180121 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb455540-62c6-4d73-bcc7-7eefc3636e60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x132d0dd30>]}
[0m18:55:34.181072 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'bb455540-62c6-4d73-bcc7-7eefc3636e60', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x132d195e0>]}
[0m18:55:34.182234 [info ] [Thread-4  ]: 4 of 5 OK created sql view model ecommerce_data_raw_reporting.fact_sales ....... [[32mCREATE VIEW (0 processed)[0m in 3.87s]
[0m18:55:34.182904 [info ] [Thread-3  ]: 5 of 5 OK created sql view model ecommerce_data_raw_reporting.fact_customer_activity  [[32mCREATE VIEW (0 processed)[0m in 3.80s]
[0m18:55:34.183931 [debug] [Thread-4  ]: Finished running node model.ecommerce_dbt.fact_sales
[0m18:55:34.184699 [debug] [Thread-3  ]: Finished running node model.ecommerce_dbt.fact_customer_activity
[0m18:55:34.186178 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:55:34.186968 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:55:34.187331 [debug] [MainThread]: Connection 'model.ecommerce_dbt.dim_product' was properly closed.
[0m18:55:34.187658 [debug] [MainThread]: Connection 'model.ecommerce_dbt.stg_customer_logs' was properly closed.
[0m18:55:34.187978 [debug] [MainThread]: Connection 'model.ecommerce_dbt.fact_customer_activity' was properly closed.
[0m18:55:34.188284 [debug] [MainThread]: Connection 'model.ecommerce_dbt.fact_sales' was properly closed.
[0m18:55:34.188793 [info ] [MainThread]: 
[0m18:55:34.189170 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 10.40 seconds (10.40s).
[0m18:55:34.190604 [debug] [MainThread]: Command end result
[0m18:55:34.273864 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jandytenedora/Interview/python-interview-gpt-question/dbt/ecommerce_dbt/target/manifest.json
[0m18:55:34.275676 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jandytenedora/Interview/python-interview-gpt-question/dbt/ecommerce_dbt/target/semantic_manifest.json
[0m18:55:34.281519 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/jandytenedora/Interview/python-interview-gpt-question/dbt/ecommerce_dbt/target/run_results.json
[0m18:55:34.281788 [info ] [MainThread]: 
[0m18:55:34.282090 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:55:34.282316 [info ] [MainThread]: 
[0m18:55:34.282549 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m18:55:34.284326 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 12.251141, "process_in_blocks": "0", "process_kernel_time": 0.385024, "process_mem_max_rss": "198410240", "process_out_blocks": "0", "process_user_time": 2.442261}
[0m18:55:34.284691 [debug] [MainThread]: Command `dbt run` succeeded at 18:55:34.284626 after 12.25 seconds
[0m18:55:34.284995 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106ba7040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d271f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105dca1f0>]}
[0m18:55:34.285307 [debug] [MainThread]: Flushing usage events
[0m18:55:35.742383 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:55:40.218636 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105621f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064bef70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1064be220>]}


============================== 18:55:40.222317 | 8d67bd6a-1774-4a89-92e6-18ed5d4c9dc5 ==============================
[0m18:55:40.222317 [info ] [MainThread]: Running with dbt=1.9.1
[0m18:55:40.222761 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'profiles_dir': '/Users/jandytenedora/.dbt', 'debug': 'False', 'warn_error': 'None', 'log_path': '/Users/jandytenedora/Interview/python-interview-gpt-question/dbt/ecommerce_dbt/logs', 'version_check': 'True', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'None', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt test', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:55:40.876731 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': '8d67bd6a-1774-4a89-92e6-18ed5d4c9dc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c343a00>]}
[0m18:55:40.920153 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': '8d67bd6a-1774-4a89-92e6-18ed5d4c9dc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c1331c0>]}
[0m18:55:40.920707 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m18:55:41.028679 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m18:55:41.200641 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:55:41.200989 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:55:41.242944 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': '8d67bd6a-1774-4a89-92e6-18ed5d4c9dc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c87df10>]}
[0m18:55:41.326243 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jandytenedora/Interview/python-interview-gpt-question/dbt/ecommerce_dbt/target/manifest.json
[0m18:55:41.329362 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jandytenedora/Interview/python-interview-gpt-question/dbt/ecommerce_dbt/target/semantic_manifest.json
[0m18:55:41.354128 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': '8d67bd6a-1774-4a89-92e6-18ed5d4c9dc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cac5cd0>]}
[0m18:55:41.354545 [info ] [MainThread]: Found 5 models, 7 data tests, 3 sources, 489 macros
[0m18:55:41.354960 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d67bd6a-1774-4a89-92e6-18ed5d4c9dc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10beba730>]}
[0m18:55:41.356273 [info ] [MainThread]: 
[0m18:55:41.356546 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:55:41.356760 [info ] [MainThread]: 
[0m18:55:41.357104 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:55:41.360579 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_terraform-tutorial-430708_ecommerce_data_raw_reporting'
[0m18:55:41.361815 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_terraform-tutorial-430708_ecommerce_data_raw_staging'
[0m18:55:41.362160 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:55:41.362407 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:55:43.049533 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': '8d67bd6a-1774-4a89-92e6-18ed5d4c9dc5', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cac9a30>]}
[0m18:55:43.050947 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:55:43.053913 [debug] [Thread-1  ]: Began running node test.ecommerce_dbt.not_null_fact_customer_activity_activity_date.412e077efb
[0m18:55:43.054506 [debug] [Thread-2  ]: Began running node test.ecommerce_dbt.not_null_fact_customer_activity_activity_type.0bf9b8fb18
[0m18:55:43.055594 [debug] [Thread-3  ]: Began running node test.ecommerce_dbt.not_null_fact_customer_activity_customer_id.8c4e1c83bf
[0m18:55:43.056285 [debug] [Thread-4  ]: Began running node test.ecommerce_dbt.not_null_fact_sales_product_id.39101802a8
[0m18:55:43.055120 [info ] [Thread-1  ]: 1 of 7 START test not_null_fact_customer_activity_activity_date ................ [RUN]
[0m18:55:43.057001 [info ] [Thread-2  ]: 2 of 7 START test not_null_fact_customer_activity_activity_type ................ [RUN]
[0m18:55:43.057756 [info ] [Thread-3  ]: 3 of 7 START test not_null_fact_customer_activity_customer_id .................. [RUN]
[0m18:55:43.058267 [info ] [Thread-4  ]: 4 of 7 START test not_null_fact_sales_product_id ............................... [RUN]
[0m18:55:43.058835 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_terraform-tutorial-430708_ecommerce_data_raw_reporting, now test.ecommerce_dbt.not_null_fact_customer_activity_activity_date.412e077efb)
[0m18:55:43.059469 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_terraform-tutorial-430708_ecommerce_data_raw_staging, now test.ecommerce_dbt.not_null_fact_customer_activity_activity_type.0bf9b8fb18)
[0m18:55:43.060034 [debug] [Thread-3  ]: Acquiring new bigquery connection 'test.ecommerce_dbt.not_null_fact_customer_activity_customer_id.8c4e1c83bf'
[0m18:55:43.060537 [debug] [Thread-4  ]: Acquiring new bigquery connection 'test.ecommerce_dbt.not_null_fact_sales_product_id.39101802a8'
[0m18:55:43.060975 [debug] [Thread-1  ]: Began compiling node test.ecommerce_dbt.not_null_fact_customer_activity_activity_date.412e077efb
[0m18:55:43.061404 [debug] [Thread-2  ]: Began compiling node test.ecommerce_dbt.not_null_fact_customer_activity_activity_type.0bf9b8fb18
[0m18:55:43.061804 [debug] [Thread-3  ]: Began compiling node test.ecommerce_dbt.not_null_fact_customer_activity_customer_id.8c4e1c83bf
[0m18:55:43.062183 [debug] [Thread-4  ]: Began compiling node test.ecommerce_dbt.not_null_fact_sales_product_id.39101802a8
[0m18:55:43.088928 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_dbt.not_null_fact_customer_activity_activity_date.412e077efb"
[0m18:55:43.089624 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_dbt.not_null_fact_customer_activity_activity_type.0bf9b8fb18"
[0m18:55:43.093278 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_dbt.not_null_fact_customer_activity_customer_id.8c4e1c83bf"
[0m18:55:43.096485 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_dbt.not_null_fact_sales_product_id.39101802a8"
[0m18:55:43.098459 [debug] [Thread-4  ]: Began executing node test.ecommerce_dbt.not_null_fact_sales_product_id.39101802a8
[0m18:55:43.098771 [debug] [Thread-2  ]: Began executing node test.ecommerce_dbt.not_null_fact_customer_activity_activity_type.0bf9b8fb18
[0m18:55:43.099070 [debug] [Thread-1  ]: Began executing node test.ecommerce_dbt.not_null_fact_customer_activity_activity_date.412e077efb
[0m18:55:43.105611 [debug] [Thread-3  ]: Began executing node test.ecommerce_dbt.not_null_fact_customer_activity_customer_id.8c4e1c83bf
[0m18:55:43.120005 [debug] [Thread-2  ]: Writing runtime sql for node "test.ecommerce_dbt.not_null_fact_customer_activity_activity_type.0bf9b8fb18"
[0m18:55:43.121555 [debug] [Thread-4  ]: Writing runtime sql for node "test.ecommerce_dbt.not_null_fact_sales_product_id.39101802a8"
[0m18:55:43.123657 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_dbt.not_null_fact_customer_activity_activity_date.412e077efb"
[0m18:55:43.125637 [debug] [Thread-3  ]: Writing runtime sql for node "test.ecommerce_dbt.not_null_fact_customer_activity_customer_id.8c4e1c83bf"
[0m18:55:43.126821 [debug] [Thread-1  ]: On test.ecommerce_dbt.not_null_fact_customer_activity_activity_date.412e077efb: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "test.ecommerce_dbt.not_null_fact_customer_activity_activity_date.412e077efb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select activity_date
from `terraform-tutorial-430708`.`ecommerce_data_raw_reporting`.`fact_customer_activity`
where activity_date is null



      
    ) dbt_internal_test
[0m18:55:43.127308 [debug] [Thread-4  ]: On test.ecommerce_dbt.not_null_fact_sales_product_id.39101802a8: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "test.ecommerce_dbt.not_null_fact_sales_product_id.39101802a8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_id
from `terraform-tutorial-430708`.`ecommerce_data_raw_reporting`.`fact_sales`
where product_id is null



      
    ) dbt_internal_test
[0m18:55:43.127690 [debug] [Thread-2  ]: On test.ecommerce_dbt.not_null_fact_customer_activity_activity_type.0bf9b8fb18: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "test.ecommerce_dbt.not_null_fact_customer_activity_activity_type.0bf9b8fb18"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select activity_type
from `terraform-tutorial-430708`.`ecommerce_data_raw_reporting`.`fact_customer_activity`
where activity_type is null



      
    ) dbt_internal_test
[0m18:55:43.128053 [debug] [Thread-3  ]: On test.ecommerce_dbt.not_null_fact_customer_activity_customer_id.8c4e1c83bf: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "test.ecommerce_dbt.not_null_fact_customer_activity_customer_id.8c4e1c83bf"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select customer_id
from `terraform-tutorial-430708`.`ecommerce_data_raw_reporting`.`fact_customer_activity`
where customer_id is null



      
    ) dbt_internal_test
[0m18:55:43.128367 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:55:43.128680 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m18:55:43.128928 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m18:55:43.129215 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m18:55:44.470913 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=terraform-tutorial-430708&j=bq:EU:783ff3e6-ab17-4d90-b007-b4b6a0949e3c&page=queryresults
[0m18:55:44.472858 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=terraform-tutorial-430708&j=bq:EU:ec68bced-9974-4ac0-8776-ba12c2e52895&page=queryresults
[0m18:55:44.473362 [error] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=terraform-tutorial-430708&j=bq:EU:783ff3e6-ab17-4d90-b007-b4b6a0949e3c&page=queryresults
[0m18:55:44.474627 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=terraform-tutorial-430708&j=bq:EU:2e979a66-b0a7-4fa3-985d-bb671852f044&page=queryresults
[0m18:55:44.474212 [error] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=terraform-tutorial-430708&j=bq:EU:ec68bced-9974-4ac0-8776-ba12c2e52895&page=queryresults
[0m18:55:44.475162 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=terraform-tutorial-430708&j=bq:EU:5a3b3e70-ff44-4707-a479-5560a11e4f30&page=queryresults
[0m18:55:44.533507 [debug] [Thread-3  ]: Database Error in test not_null_fact_customer_activity_customer_id (models/marts/schema.yml)
  Unrecognized name: customer_id; Did you mean user_id? at [15:7]
  compiled code at target/run/ecommerce_dbt/models/marts/schema.yml/not_null_fact_customer_activity_customer_id.sql
[0m18:55:44.534186 [error] [Thread-3  ]: 3 of 7 ERROR not_null_fact_customer_activity_customer_id ....................... [[31mERROR[0m in 1.47s]
[0m18:55:44.534881 [debug] [Thread-3  ]: Finished running node test.ecommerce_dbt.not_null_fact_customer_activity_customer_id.8c4e1c83bf
[0m18:55:44.535512 [debug] [Thread-2  ]: Database Error in test not_null_fact_customer_activity_activity_type (models/marts/schema.yml)
  Unrecognized name: activity_type; Did you mean activity_date? at [15:7]
  compiled code at target/run/ecommerce_dbt/models/marts/schema.yml/not_null_fact_customer_activity_activity_type.sql
[0m18:55:44.535904 [debug] [Thread-3  ]: Began running node test.ecommerce_dbt.not_null_fact_sales_sale_date.aeb11a016c
[0m18:55:44.537019 [debug] [Thread-7  ]: Marking all children of 'test.ecommerce_dbt.not_null_fact_customer_activity_customer_id.8c4e1c83bf' to be skipped because of status 'error'.  Reason: Database Error in test not_null_fact_customer_activity_customer_id (models/marts/schema.yml)
  Unrecognized name: customer_id; Did you mean user_id? at [15:7]
  compiled code at target/run/ecommerce_dbt/models/marts/schema.yml/not_null_fact_customer_activity_customer_id.sql.
[0m18:55:44.537607 [error] [Thread-2  ]: 2 of 7 ERROR not_null_fact_customer_activity_activity_type ..................... [[31mERROR[0m in 1.48s]
[0m18:55:44.537946 [info ] [Thread-3  ]: 5 of 7 START test not_null_fact_sales_sale_date ................................ [RUN]
[0m18:55:44.538538 [debug] [Thread-2  ]: Finished running node test.ecommerce_dbt.not_null_fact_customer_activity_activity_type.0bf9b8fb18
[0m18:55:44.538996 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_dbt.not_null_fact_customer_activity_customer_id.8c4e1c83bf, now test.ecommerce_dbt.not_null_fact_sales_sale_date.aeb11a016c)
[0m18:55:44.539356 [debug] [Thread-2  ]: Began running node test.ecommerce_dbt.not_null_fact_sales_total_quantity.a24e8f3a97
[0m18:55:44.539800 [debug] [Thread-7  ]: Marking all children of 'test.ecommerce_dbt.not_null_fact_customer_activity_activity_type.0bf9b8fb18' to be skipped because of status 'error'.  Reason: Database Error in test not_null_fact_customer_activity_activity_type (models/marts/schema.yml)
  Unrecognized name: activity_type; Did you mean activity_date? at [15:7]
  compiled code at target/run/ecommerce_dbt/models/marts/schema.yml/not_null_fact_customer_activity_activity_type.sql.
[0m18:55:44.540096 [debug] [Thread-3  ]: Began compiling node test.ecommerce_dbt.not_null_fact_sales_sale_date.aeb11a016c
[0m18:55:44.541464 [info ] [Thread-2  ]: 6 of 7 START test not_null_fact_sales_total_quantity ........................... [RUN]
[0m18:55:44.547784 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_dbt.not_null_fact_sales_sale_date.aeb11a016c"
[0m18:55:44.548268 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly test.ecommerce_dbt.not_null_fact_customer_activity_activity_type.0bf9b8fb18, now test.ecommerce_dbt.not_null_fact_sales_total_quantity.a24e8f3a97)
[0m18:55:44.548761 [debug] [Thread-2  ]: Began compiling node test.ecommerce_dbt.not_null_fact_sales_total_quantity.a24e8f3a97
[0m18:55:44.552454 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_dbt.not_null_fact_sales_total_quantity.a24e8f3a97"
[0m18:55:44.553138 [debug] [Thread-2  ]: Began executing node test.ecommerce_dbt.not_null_fact_sales_total_quantity.a24e8f3a97
[0m18:55:44.553499 [debug] [Thread-3  ]: Began executing node test.ecommerce_dbt.not_null_fact_sales_sale_date.aeb11a016c
[0m18:55:44.555762 [debug] [Thread-2  ]: Writing runtime sql for node "test.ecommerce_dbt.not_null_fact_sales_total_quantity.a24e8f3a97"
[0m18:55:44.558049 [debug] [Thread-3  ]: Writing runtime sql for node "test.ecommerce_dbt.not_null_fact_sales_sale_date.aeb11a016c"
[0m18:55:44.558922 [debug] [Thread-2  ]: On test.ecommerce_dbt.not_null_fact_sales_total_quantity.a24e8f3a97: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "test.ecommerce_dbt.not_null_fact_sales_total_quantity.a24e8f3a97"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select total_quantity
from `terraform-tutorial-430708`.`ecommerce_data_raw_reporting`.`fact_sales`
where total_quantity is null



      
    ) dbt_internal_test
[0m18:55:44.559304 [debug] [Thread-3  ]: On test.ecommerce_dbt.not_null_fact_sales_sale_date.aeb11a016c: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "test.ecommerce_dbt.not_null_fact_sales_sale_date.aeb11a016c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sale_date
from `terraform-tutorial-430708`.`ecommerce_data_raw_reporting`.`fact_sales`
where sale_date is null



      
    ) dbt_internal_test
[0m18:55:44.559627 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m18:55:44.559878 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m18:55:45.094359 [info ] [Thread-4  ]: 4 of 7 PASS not_null_fact_sales_product_id ..................................... [[32mPASS[0m in 2.03s]
[0m18:55:45.095501 [debug] [Thread-4  ]: Finished running node test.ecommerce_dbt.not_null_fact_sales_product_id.39101802a8
[0m18:55:45.096099 [debug] [Thread-4  ]: Began running node test.ecommerce_dbt.not_null_fact_sales_total_revenue.e93f0630dd
[0m18:55:45.096752 [info ] [Thread-4  ]: 7 of 7 START test not_null_fact_sales_total_revenue ............................ [RUN]
[0m18:55:45.097468 [debug] [Thread-4  ]: Re-using an available connection from the pool (formerly test.ecommerce_dbt.not_null_fact_sales_product_id.39101802a8, now test.ecommerce_dbt.not_null_fact_sales_total_revenue.e93f0630dd)
[0m18:55:45.098008 [debug] [Thread-4  ]: Began compiling node test.ecommerce_dbt.not_null_fact_sales_total_revenue.e93f0630dd
[0m18:55:45.104413 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_dbt.not_null_fact_sales_total_revenue.e93f0630dd"
[0m18:55:45.106389 [info ] [Thread-1  ]: 1 of 7 PASS not_null_fact_customer_activity_activity_date ...................... [[32mPASS[0m in 2.05s]
[0m18:55:45.107181 [debug] [Thread-1  ]: Finished running node test.ecommerce_dbt.not_null_fact_customer_activity_activity_date.412e077efb
[0m18:55:45.107687 [debug] [Thread-4  ]: Began executing node test.ecommerce_dbt.not_null_fact_sales_total_revenue.e93f0630dd
[0m18:55:45.111667 [debug] [Thread-4  ]: Writing runtime sql for node "test.ecommerce_dbt.not_null_fact_sales_total_revenue.e93f0630dd"
[0m18:55:45.112551 [debug] [Thread-4  ]: On test.ecommerce_dbt.not_null_fact_sales_total_revenue.e93f0630dd: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "test.ecommerce_dbt.not_null_fact_sales_total_revenue.e93f0630dd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select total_revenue
from `terraform-tutorial-430708`.`ecommerce_data_raw_reporting`.`fact_sales`
where total_revenue is null



      
    ) dbt_internal_test
[0m18:55:45.113012 [debug] [Thread-4  ]: Opening a new connection, currently in state closed
[0m18:55:45.947326 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=terraform-tutorial-430708&j=bq:EU:e60c4b76-1fd0-47b6-8e40-0195152fa6bb&page=queryresults
[0m18:55:45.949477 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=terraform-tutorial-430708&j=bq:EU:464319de-12ac-40fe-9d23-3525e7740aa3&page=queryresults
[0m18:55:46.146430 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=terraform-tutorial-430708&j=bq:EU:39d932a4-1f3d-4b2d-b426-22761c192ee7&page=queryresults
[0m18:55:46.590010 [info ] [Thread-3  ]: 5 of 7 PASS not_null_fact_sales_sale_date ...................................... [[32mPASS[0m in 2.05s]
[0m18:55:46.590764 [info ] [Thread-2  ]: 6 of 7 PASS not_null_fact_sales_total_quantity ................................. [[32mPASS[0m in 2.04s]
[0m18:55:46.593829 [debug] [Thread-3  ]: Finished running node test.ecommerce_dbt.not_null_fact_sales_sale_date.aeb11a016c
[0m18:55:46.594678 [debug] [Thread-2  ]: Finished running node test.ecommerce_dbt.not_null_fact_sales_total_quantity.a24e8f3a97
[0m18:55:46.827518 [info ] [Thread-4  ]: 7 of 7 PASS not_null_fact_sales_total_revenue .................................. [[32mPASS[0m in 1.73s]
[0m18:55:46.828591 [debug] [Thread-4  ]: Finished running node test.ecommerce_dbt.not_null_fact_sales_total_revenue.e93f0630dd
[0m18:55:46.830154 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:55:46.830972 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:55:46.831376 [debug] [MainThread]: Connection 'test.ecommerce_dbt.not_null_fact_customer_activity_activity_date.412e077efb' was properly closed.
[0m18:55:46.831707 [debug] [MainThread]: Connection 'test.ecommerce_dbt.not_null_fact_sales_total_quantity.a24e8f3a97' was properly closed.
[0m18:55:46.832016 [debug] [MainThread]: Connection 'test.ecommerce_dbt.not_null_fact_sales_sale_date.aeb11a016c' was properly closed.
[0m18:55:46.832326 [debug] [MainThread]: Connection 'test.ecommerce_dbt.not_null_fact_sales_total_revenue.e93f0630dd' was properly closed.
[0m18:55:46.832712 [info ] [MainThread]: 
[0m18:55:46.833084 [info ] [MainThread]: Finished running 7 data tests in 0 hours 0 minutes and 5.48 seconds (5.48s).
[0m18:55:46.834826 [debug] [MainThread]: Command end result
[0m18:55:46.862288 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jandytenedora/Interview/python-interview-gpt-question/dbt/ecommerce_dbt/target/manifest.json
[0m18:55:46.864051 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jandytenedora/Interview/python-interview-gpt-question/dbt/ecommerce_dbt/target/semantic_manifest.json
[0m18:55:46.870997 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/jandytenedora/Interview/python-interview-gpt-question/dbt/ecommerce_dbt/target/run_results.json
[0m18:55:46.871309 [info ] [MainThread]: 
[0m18:55:46.871621 [info ] [MainThread]: [31mCompleted with 2 errors, 0 partial successes, and 0 warnings:[0m
[0m18:55:46.871855 [info ] [MainThread]: 
[0m18:55:46.872121 [error] [MainThread]:   Database Error in test not_null_fact_customer_activity_customer_id (models/marts/schema.yml)
  Unrecognized name: customer_id; Did you mean user_id? at [15:7]
  compiled code at target/run/ecommerce_dbt/models/marts/schema.yml/not_null_fact_customer_activity_customer_id.sql
[0m18:55:46.872341 [info ] [MainThread]: 
[0m18:55:46.872624 [error] [MainThread]:   Database Error in test not_null_fact_customer_activity_activity_type (models/marts/schema.yml)
  Unrecognized name: activity_type; Did you mean activity_date? at [15:7]
  compiled code at target/run/ecommerce_dbt/models/marts/schema.yml/not_null_fact_customer_activity_activity_type.sql
[0m18:55:46.872895 [info ] [MainThread]: 
[0m18:55:46.873346 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=2 SKIP=0 TOTAL=7
[0m18:55:46.874809 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": false, "command_wall_clock_time": 6.7164006, "process_in_blocks": "0", "process_kernel_time": 0.314049, "process_mem_max_rss": "192495616", "process_out_blocks": "0", "process_user_time": 2.131473}
[0m18:55:46.875123 [debug] [MainThread]: Command `dbt test` failed at 18:55:46.875061 after 6.72 seconds
[0m18:55:46.875413 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x105621f70>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10c1331c0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x10cbe1610>]}
[0m18:55:46.875697 [debug] [MainThread]: Flushing usage events
[0m18:55:47.630907 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:57:08.167014 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d6f070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1119cac40>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1119cadf0>]}


============================== 18:57:08.171011 | b02b92ce-0e1a-4d87-a605-b6b394b8bc95 ==============================
[0m18:57:08.171011 [info ] [MainThread]: Running with dbt=1.9.1
[0m18:57:08.171459 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/jandytenedora/.dbt', 'log_path': '/Users/jandytenedora/Interview/python-interview-gpt-question/dbt/ecommerce_dbt/logs', 'fail_fast': 'False', 'debug': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'invocation_command': 'dbt test', 'introspect': 'True', 'static_parser': 'True', 'target_path': 'None', 'log_format': 'default', 'send_anonymous_usage_stats': 'True'}
[0m18:57:09.019599 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'b02b92ce-0e1a-4d87-a605-b6b394b8bc95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1211186d0>]}
[0m18:57:09.062682 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'b02b92ce-0e1a-4d87-a605-b6b394b8bc95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121118490>]}
[0m18:57:09.063298 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m18:57:09.172071 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m18:57:09.348351 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 1 files changed.
[0m18:57:09.349006 [debug] [MainThread]: Partial parsing: updated file: ecommerce_dbt://models/marts/schema.yml
[0m18:57:09.671410 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'b02b92ce-0e1a-4d87-a605-b6b394b8bc95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1218c8130>]}
[0m18:57:09.753659 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jandytenedora/Interview/python-interview-gpt-question/dbt/ecommerce_dbt/target/manifest.json
[0m18:57:09.756985 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jandytenedora/Interview/python-interview-gpt-question/dbt/ecommerce_dbt/target/semantic_manifest.json
[0m18:57:09.784747 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'b02b92ce-0e1a-4d87-a605-b6b394b8bc95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x121c19a00>]}
[0m18:57:09.785246 [info ] [MainThread]: Found 5 models, 6 data tests, 3 sources, 489 macros
[0m18:57:09.785543 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b02b92ce-0e1a-4d87-a605-b6b394b8bc95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1200f32b0>]}
[0m18:57:09.786856 [info ] [MainThread]: 
[0m18:57:09.787129 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:57:09.787339 [info ] [MainThread]: 
[0m18:57:09.787713 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:57:09.791286 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_terraform-tutorial-430708_ecommerce_data_raw_staging'
[0m18:57:09.791765 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_terraform-tutorial-430708_ecommerce_data_raw_reporting'
[0m18:57:09.792157 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:57:09.792500 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:57:11.586331 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'b02b92ce-0e1a-4d87-a605-b6b394b8bc95', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1217a1e80>]}
[0m18:57:11.587143 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:57:11.588804 [debug] [Thread-1  ]: Began running node test.ecommerce_dbt.not_null_fact_customer_activity_activity_date.412e077efb
[0m18:57:11.589144 [debug] [Thread-2  ]: Began running node test.ecommerce_dbt.not_null_fact_customer_activity_user_id.e90a97f1ce
[0m18:57:11.589760 [debug] [Thread-3  ]: Began running node test.ecommerce_dbt.not_null_fact_sales_product_id.39101802a8
[0m18:57:11.590069 [debug] [Thread-4  ]: Began running node test.ecommerce_dbt.not_null_fact_sales_sale_date.aeb11a016c
[0m18:57:11.589484 [info ] [Thread-1  ]: 1 of 6 START test not_null_fact_customer_activity_activity_date ................ [RUN]
[0m18:57:11.590452 [info ] [Thread-2  ]: 2 of 6 START test not_null_fact_customer_activity_user_id ...................... [RUN]
[0m18:57:11.590986 [info ] [Thread-3  ]: 3 of 6 START test not_null_fact_sales_product_id ............................... [RUN]
[0m18:57:11.591452 [info ] [Thread-4  ]: 4 of 6 START test not_null_fact_sales_sale_date ................................ [RUN]
[0m18:57:11.591930 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_terraform-tutorial-430708_ecommerce_data_raw_staging, now test.ecommerce_dbt.not_null_fact_customer_activity_activity_date.412e077efb)
[0m18:57:11.592257 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_terraform-tutorial-430708_ecommerce_data_raw_reporting, now test.ecommerce_dbt.not_null_fact_customer_activity_user_id.e90a97f1ce)
[0m18:57:11.592735 [debug] [Thread-3  ]: Acquiring new bigquery connection 'test.ecommerce_dbt.not_null_fact_sales_product_id.39101802a8'
[0m18:57:11.593069 [debug] [Thread-4  ]: Acquiring new bigquery connection 'test.ecommerce_dbt.not_null_fact_sales_sale_date.aeb11a016c'
[0m18:57:11.593355 [debug] [Thread-1  ]: Began compiling node test.ecommerce_dbt.not_null_fact_customer_activity_activity_date.412e077efb
[0m18:57:11.593620 [debug] [Thread-2  ]: Began compiling node test.ecommerce_dbt.not_null_fact_customer_activity_user_id.e90a97f1ce
[0m18:57:11.593866 [debug] [Thread-3  ]: Began compiling node test.ecommerce_dbt.not_null_fact_sales_product_id.39101802a8
[0m18:57:11.594108 [debug] [Thread-4  ]: Began compiling node test.ecommerce_dbt.not_null_fact_sales_sale_date.aeb11a016c
[0m18:57:11.609015 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_dbt.not_null_fact_customer_activity_activity_date.412e077efb"
[0m18:57:11.613696 [debug] [Thread-2  ]: Writing injected SQL for node "test.ecommerce_dbt.not_null_fact_customer_activity_user_id.e90a97f1ce"
[0m18:57:11.617202 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_dbt.not_null_fact_sales_product_id.39101802a8"
[0m18:57:11.620486 [debug] [Thread-4  ]: Writing injected SQL for node "test.ecommerce_dbt.not_null_fact_sales_sale_date.aeb11a016c"
[0m18:57:11.621218 [debug] [Thread-2  ]: Began executing node test.ecommerce_dbt.not_null_fact_customer_activity_user_id.e90a97f1ce
[0m18:57:11.639723 [debug] [Thread-4  ]: Began executing node test.ecommerce_dbt.not_null_fact_sales_sale_date.aeb11a016c
[0m18:57:11.647554 [debug] [Thread-2  ]: Writing runtime sql for node "test.ecommerce_dbt.not_null_fact_customer_activity_user_id.e90a97f1ce"
[0m18:57:11.650069 [debug] [Thread-4  ]: Writing runtime sql for node "test.ecommerce_dbt.not_null_fact_sales_sale_date.aeb11a016c"
[0m18:57:11.651306 [debug] [Thread-4  ]: On test.ecommerce_dbt.not_null_fact_sales_sale_date.aeb11a016c: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "test.ecommerce_dbt.not_null_fact_sales_sale_date.aeb11a016c"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select sale_date
from `terraform-tutorial-430708`.`ecommerce_data_raw_reporting`.`fact_sales`
where sale_date is null



      
    ) dbt_internal_test
[0m18:57:11.651741 [debug] [Thread-1  ]: Began executing node test.ecommerce_dbt.not_null_fact_customer_activity_activity_date.412e077efb
[0m18:57:11.652115 [debug] [Thread-3  ]: Began executing node test.ecommerce_dbt.not_null_fact_sales_product_id.39101802a8
[0m18:57:11.653218 [debug] [Thread-2  ]: On test.ecommerce_dbt.not_null_fact_customer_activity_user_id.e90a97f1ce: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "test.ecommerce_dbt.not_null_fact_customer_activity_user_id.e90a97f1ce"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select user_id
from `terraform-tutorial-430708`.`ecommerce_data_raw_reporting`.`fact_customer_activity`
where user_id is null



      
    ) dbt_internal_test
[0m18:57:11.662391 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m18:57:11.653987 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m18:57:11.657538 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_dbt.not_null_fact_customer_activity_activity_date.412e077efb"
[0m18:57:11.661029 [debug] [Thread-3  ]: Writing runtime sql for node "test.ecommerce_dbt.not_null_fact_sales_product_id.39101802a8"
[0m18:57:11.664988 [debug] [Thread-1  ]: On test.ecommerce_dbt.not_null_fact_customer_activity_activity_date.412e077efb: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "test.ecommerce_dbt.not_null_fact_customer_activity_activity_date.412e077efb"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select activity_date
from `terraform-tutorial-430708`.`ecommerce_data_raw_reporting`.`fact_customer_activity`
where activity_date is null



      
    ) dbt_internal_test
[0m18:57:11.667278 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:57:11.666742 [debug] [Thread-3  ]: On test.ecommerce_dbt.not_null_fact_sales_product_id.39101802a8: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "test.ecommerce_dbt.not_null_fact_sales_product_id.39101802a8"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select product_id
from `terraform-tutorial-430708`.`ecommerce_data_raw_reporting`.`fact_sales`
where product_id is null



      
    ) dbt_internal_test
[0m18:57:11.668617 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m18:57:12.954550 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=terraform-tutorial-430708&j=bq:EU:592721a6-a566-4761-8794-6cd6c141819e&page=queryresults
[0m18:57:12.955873 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=terraform-tutorial-430708&j=bq:EU:a25df306-0e54-47d2-a02a-15f1e7f07d3e&page=queryresults
[0m18:57:12.956942 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=terraform-tutorial-430708&j=bq:EU:1b1d3eb7-c974-4e54-8f07-92bed82349b9&page=queryresults
[0m18:57:13.029328 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=terraform-tutorial-430708&j=bq:EU:f700c184-0642-4a39-b31a-dfddb639aca4&page=queryresults
[0m18:57:13.912245 [info ] [Thread-1  ]: 1 of 6 PASS not_null_fact_customer_activity_activity_date ...................... [[32mPASS[0m in 2.32s]
[0m18:57:13.913447 [info ] [Thread-3  ]: 3 of 6 PASS not_null_fact_sales_product_id ..................................... [[32mPASS[0m in 2.32s]
[0m18:57:13.914013 [info ] [Thread-4  ]: 4 of 6 PASS not_null_fact_sales_sale_date ...................................... [[32mPASS[0m in 2.32s]
[0m18:57:13.914546 [info ] [Thread-2  ]: 2 of 6 PASS not_null_fact_customer_activity_user_id ............................ [[32mPASS[0m in 2.32s]
[0m18:57:13.915172 [debug] [Thread-1  ]: Finished running node test.ecommerce_dbt.not_null_fact_customer_activity_activity_date.412e077efb
[0m18:57:13.915674 [debug] [Thread-3  ]: Finished running node test.ecommerce_dbt.not_null_fact_sales_product_id.39101802a8
[0m18:57:13.916127 [debug] [Thread-4  ]: Finished running node test.ecommerce_dbt.not_null_fact_sales_sale_date.aeb11a016c
[0m18:57:13.916590 [debug] [Thread-2  ]: Finished running node test.ecommerce_dbt.not_null_fact_customer_activity_user_id.e90a97f1ce
[0m18:57:13.916954 [debug] [Thread-1  ]: Began running node test.ecommerce_dbt.not_null_fact_sales_total_quantity.a24e8f3a97
[0m18:57:13.917285 [debug] [Thread-3  ]: Began running node test.ecommerce_dbt.not_null_fact_sales_total_revenue.e93f0630dd
[0m18:57:13.917849 [info ] [Thread-1  ]: 5 of 6 START test not_null_fact_sales_total_quantity ........................... [RUN]
[0m18:57:13.918249 [info ] [Thread-3  ]: 6 of 6 START test not_null_fact_sales_total_revenue ............................ [RUN]
[0m18:57:13.918943 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly test.ecommerce_dbt.not_null_fact_customer_activity_activity_date.412e077efb, now test.ecommerce_dbt.not_null_fact_sales_total_quantity.a24e8f3a97)
[0m18:57:13.919437 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly test.ecommerce_dbt.not_null_fact_sales_product_id.39101802a8, now test.ecommerce_dbt.not_null_fact_sales_total_revenue.e93f0630dd)
[0m18:57:13.919800 [debug] [Thread-1  ]: Began compiling node test.ecommerce_dbt.not_null_fact_sales_total_quantity.a24e8f3a97
[0m18:57:13.920128 [debug] [Thread-3  ]: Began compiling node test.ecommerce_dbt.not_null_fact_sales_total_revenue.e93f0630dd
[0m18:57:13.924181 [debug] [Thread-1  ]: Writing injected SQL for node "test.ecommerce_dbt.not_null_fact_sales_total_quantity.a24e8f3a97"
[0m18:57:13.927733 [debug] [Thread-3  ]: Writing injected SQL for node "test.ecommerce_dbt.not_null_fact_sales_total_revenue.e93f0630dd"
[0m18:57:13.928492 [debug] [Thread-3  ]: Began executing node test.ecommerce_dbt.not_null_fact_sales_total_revenue.e93f0630dd
[0m18:57:13.928870 [debug] [Thread-1  ]: Began executing node test.ecommerce_dbt.not_null_fact_sales_total_quantity.a24e8f3a97
[0m18:57:13.931332 [debug] [Thread-3  ]: Writing runtime sql for node "test.ecommerce_dbt.not_null_fact_sales_total_revenue.e93f0630dd"
[0m18:57:13.934026 [debug] [Thread-1  ]: Writing runtime sql for node "test.ecommerce_dbt.not_null_fact_sales_total_quantity.a24e8f3a97"
[0m18:57:13.934578 [debug] [Thread-3  ]: On test.ecommerce_dbt.not_null_fact_sales_total_revenue.e93f0630dd: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "test.ecommerce_dbt.not_null_fact_sales_total_revenue.e93f0630dd"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select total_revenue
from `terraform-tutorial-430708`.`ecommerce_data_raw_reporting`.`fact_sales`
where total_revenue is null



      
    ) dbt_internal_test
[0m18:57:13.934912 [debug] [Thread-1  ]: On test.ecommerce_dbt.not_null_fact_sales_total_quantity.a24e8f3a97: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "test.ecommerce_dbt.not_null_fact_sales_total_quantity.a24e8f3a97"} */
select
      count(*) as failures,
      count(*) != 0 as should_warn,
      count(*) != 0 as should_error
    from (
      
    
    



select total_quantity
from `terraform-tutorial-430708`.`ecommerce_data_raw_reporting`.`fact_sales`
where total_quantity is null



      
    ) dbt_internal_test
[0m18:57:13.935261 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:57:13.935526 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m18:57:15.035654 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=terraform-tutorial-430708&j=bq:EU:c17d218a-210c-45e6-bca7-3c09354710c0&page=queryresults
[0m18:57:15.038576 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=terraform-tutorial-430708&j=bq:EU:c91223ea-07f7-4ebe-a5bb-2b4ee97ea272&page=queryresults
[0m18:57:15.853787 [info ] [Thread-3  ]: 6 of 6 PASS not_null_fact_sales_total_revenue .................................. [[32mPASS[0m in 1.93s]
[0m18:57:15.854396 [info ] [Thread-1  ]: 5 of 6 PASS not_null_fact_sales_total_quantity ................................. [[32mPASS[0m in 1.94s]
[0m18:57:15.854841 [debug] [Thread-3  ]: Finished running node test.ecommerce_dbt.not_null_fact_sales_total_revenue.e93f0630dd
[0m18:57:15.855346 [debug] [Thread-1  ]: Finished running node test.ecommerce_dbt.not_null_fact_sales_total_quantity.a24e8f3a97
[0m18:57:15.856397 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:57:15.856932 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:57:15.857166 [debug] [MainThread]: Connection 'test.ecommerce_dbt.not_null_fact_sales_total_quantity.a24e8f3a97' was properly closed.
[0m18:57:15.857378 [debug] [MainThread]: Connection 'test.ecommerce_dbt.not_null_fact_customer_activity_user_id.e90a97f1ce' was properly closed.
[0m18:57:15.857595 [debug] [MainThread]: Connection 'test.ecommerce_dbt.not_null_fact_sales_total_revenue.e93f0630dd' was properly closed.
[0m18:57:15.857798 [debug] [MainThread]: Connection 'test.ecommerce_dbt.not_null_fact_sales_sale_date.aeb11a016c' was properly closed.
[0m18:57:15.858044 [info ] [MainThread]: 
[0m18:57:15.858281 [info ] [MainThread]: Finished running 6 data tests in 0 hours 0 minutes and 6.07 seconds (6.07s).
[0m18:57:15.859263 [debug] [MainThread]: Command end result
[0m18:57:15.881514 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jandytenedora/Interview/python-interview-gpt-question/dbt/ecommerce_dbt/target/manifest.json
[0m18:57:15.882882 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jandytenedora/Interview/python-interview-gpt-question/dbt/ecommerce_dbt/target/semantic_manifest.json
[0m18:57:15.888768 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/jandytenedora/Interview/python-interview-gpt-question/dbt/ecommerce_dbt/target/run_results.json
[0m18:57:15.889100 [info ] [MainThread]: 
[0m18:57:15.889393 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:57:15.889620 [info ] [MainThread]: 
[0m18:57:15.889865 [info ] [MainThread]: Done. PASS=6 WARN=0 ERROR=0 SKIP=0 TOTAL=6
[0m18:57:15.891312 [debug] [MainThread]: Resource report: {"command_name": "test", "command_success": true, "command_wall_clock_time": 7.779064, "process_in_blocks": "0", "process_kernel_time": 0.382016, "process_mem_max_rss": "199720960", "process_out_blocks": "0", "process_user_time": 2.394688}
[0m18:57:15.891629 [debug] [MainThread]: Command `dbt test` succeeded at 18:57:15.891567 after 7.78 seconds
[0m18:57:15.891912 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106d6f070>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x106b587f0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1216cb280>]}
[0m18:57:15.892207 [debug] [MainThread]: Flushing usage events
[0m18:57:17.057275 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m18:57:38.094745 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079f9f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a99d60>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x110a99f40>]}


============================== 18:57:38.098515 | fc55e98b-00dc-4009-b29c-e802fba7d18d ==============================
[0m18:57:38.098515 [info ] [MainThread]: Running with dbt=1.9.1
[0m18:57:38.098957 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'version_check': 'True', 'profiles_dir': '/Users/jandytenedora/.dbt', 'log_path': '/Users/jandytenedora/Interview/python-interview-gpt-question/dbt/ecommerce_dbt/logs', 'debug': 'False', 'fail_fast': 'False', 'use_colors': 'True', 'use_experimental_parser': 'False', 'no_print': 'None', 'quiet': 'False', 'empty': 'False', 'log_format': 'default', 'introspect': 'True', 'invocation_command': 'dbt run', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'target_path': 'None', 'static_parser': 'True', 'send_anonymous_usage_stats': 'True'}
[0m18:57:38.948444 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'fc55e98b-00dc-4009-b29c-e802fba7d18d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104e6ff70>]}
[0m18:57:38.990766 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'fc55e98b-00dc-4009-b29c-e802fba7d18d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117728ac0>]}
[0m18:57:38.991270 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m18:57:39.103539 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m18:57:39.279296 [debug] [MainThread]: Partial parsing enabled: 0 files deleted, 0 files added, 0 files changed.
[0m18:57:39.279680 [debug] [MainThread]: Partial parsing enabled, no changes found, skipping parsing
[0m18:57:39.323172 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'fc55e98b-00dc-4009-b29c-e802fba7d18d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117b67130>]}
[0m18:57:39.404207 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jandytenedora/Interview/python-interview-gpt-question/dbt/ecommerce_dbt/target/manifest.json
[0m18:57:39.407007 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jandytenedora/Interview/python-interview-gpt-question/dbt/ecommerce_dbt/target/semantic_manifest.json
[0m18:57:39.421560 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'fc55e98b-00dc-4009-b29c-e802fba7d18d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11777ba90>]}
[0m18:57:39.421960 [info ] [MainThread]: Found 5 models, 6 data tests, 3 sources, 489 macros
[0m18:57:39.422230 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fc55e98b-00dc-4009-b29c-e802fba7d18d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11774c760>]}
[0m18:57:39.423383 [info ] [MainThread]: 
[0m18:57:39.423647 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m18:57:39.423859 [info ] [MainThread]: 
[0m18:57:39.424194 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m18:57:39.427559 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_terraform-tutorial-430708'
[0m18:57:39.427924 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:57:39.428235 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_terraform-tutorial-430708'
[0m18:57:39.428590 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m18:57:41.441780 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_terraform-tutorial-430708, now list_terraform-tutorial-430708_ecommerce_data_raw_staging)
[0m18:57:41.442555 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_terraform-tutorial-430708, now list_terraform-tutorial-430708_ecommerce_data_raw_reporting)
[0m18:57:41.442924 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:57:41.443228 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m18:57:41.873958 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'fc55e98b-00dc-4009-b29c-e802fba7d18d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11741e0d0>]}
[0m18:57:41.874664 [debug] [MainThread]: Opening a new connection, currently in state init
[0m18:57:41.885855 [debug] [Thread-1  ]: Began running node model.ecommerce_dbt.dim_product
[0m18:57:41.886624 [debug] [Thread-2  ]: Began running node model.ecommerce_dbt.stg_customer_logs
[0m18:57:41.887151 [info ] [Thread-1  ]: 1 of 5 START sql view model ecommerce_data_raw_reporting.dim_product ........... [RUN]
[0m18:57:41.888475 [info ] [Thread-2  ]: 2 of 5 START sql view model ecommerce_data_raw_staging.stg_customer_logs ....... [RUN]
[0m18:57:41.889272 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_terraform-tutorial-430708_ecommerce_data_raw_staging, now model.ecommerce_dbt.dim_product)
[0m18:57:41.889680 [debug] [Thread-3  ]: Began running node model.ecommerce_dbt.stg_sales
[0m18:57:41.890199 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_terraform-tutorial-430708_ecommerce_data_raw_reporting, now model.ecommerce_dbt.stg_customer_logs)
[0m18:57:41.890542 [debug] [Thread-1  ]: Began compiling node model.ecommerce_dbt.dim_product
[0m18:57:41.891000 [info ] [Thread-3  ]: 3 of 5 START sql view model ecommerce_data_raw_staging.stg_sales ............... [RUN]
[0m18:57:41.891443 [debug] [Thread-2  ]: Began compiling node model.ecommerce_dbt.stg_customer_logs
[0m18:57:41.899759 [debug] [Thread-3  ]: Acquiring new bigquery connection 'model.ecommerce_dbt.stg_sales'
[0m18:57:41.906286 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_dbt.dim_product"
[0m18:57:41.912012 [debug] [Thread-2  ]: Writing injected SQL for node "model.ecommerce_dbt.stg_customer_logs"
[0m18:57:41.915076 [debug] [Thread-3  ]: Began compiling node model.ecommerce_dbt.stg_sales
[0m18:57:41.926269 [debug] [Thread-3  ]: Writing injected SQL for node "model.ecommerce_dbt.stg_sales"
[0m18:57:41.928160 [debug] [Thread-1  ]: Began executing node model.ecommerce_dbt.dim_product
[0m18:57:41.943438 [debug] [Thread-2  ]: Began executing node model.ecommerce_dbt.stg_customer_logs
[0m18:57:41.950616 [debug] [Thread-3  ]: Began executing node model.ecommerce_dbt.stg_sales
[0m18:57:41.991308 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_dbt.dim_product"
[0m18:57:41.992756 [debug] [Thread-2  ]: Writing runtime sql for node "model.ecommerce_dbt.stg_customer_logs"
[0m18:57:41.994458 [debug] [Thread-3  ]: Writing runtime sql for node "model.ecommerce_dbt.stg_sales"
[0m18:57:41.995729 [debug] [Thread-1  ]: On model.ecommerce_dbt.dim_product: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.dim_product"} */


  create or replace view `terraform-tutorial-430708`.`ecommerce_data_raw_reporting`.`dim_product`
  OPTIONS()
  as SELECT
    product_id,
    category,
    device
FROM `terraform-tutorial-430708`.`ecommerce_data_raw`.`product_catalog`;


[0m18:57:41.996150 [debug] [Thread-3  ]: On model.ecommerce_dbt.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.stg_sales"} */


  create or replace view `terraform-tutorial-430708`.`ecommerce_data_raw_staging`.`stg_sales`
  OPTIONS()
  as WITH cleaned_sales AS (
    SELECT
        transaction_id,
        product_id,
        sale_date,
        quantity,
        price_per_unit
    FROM `terraform-tutorial-430708`.`ecommerce_data_raw`.`raw_sales_data`
    WHERE sale_date IS NOT NULL
)
SELECT * FROM cleaned_sales;


[0m18:57:41.996504 [debug] [Thread-2  ]: On model.ecommerce_dbt.stg_customer_logs: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.stg_customer_logs"} */


  create or replace view `terraform-tutorial-430708`.`ecommerce_data_raw_staging`.`stg_customer_logs`
  OPTIONS()
  as WITH cleaned_customer_logs AS (
    SELECT
        timestamp,
        user_id,
        event_type,
        product_id
    FROM `terraform-tutorial-430708`.`ecommerce_data_raw`.`customer_logs`
    WHERE user_id IS NOT NULL
)
SELECT * FROM cleaned_customer_logs;


[0m18:57:41.997037 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m18:57:41.997368 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m18:57:41.997837 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m18:57:42.703221 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=terraform-tutorial-430708&j=bq:EU:6d69f3d4-787e-40b0-ae8d-9e5ee4689fec&page=queryresults
[0m18:57:42.764508 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=terraform-tutorial-430708&j=bq:EU:62dc632c-9812-4a82-8800-4d17c2174b03&page=queryresults
[0m18:57:42.769701 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=terraform-tutorial-430708&j=bq:EU:c4aaa17c-7f80-47fc-bf83-97477e1df4da&page=queryresults
[0m18:57:43.280140 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc55e98b-00dc-4009-b29c-e802fba7d18d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117715bb0>]}
[0m18:57:43.280490 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc55e98b-00dc-4009-b29c-e802fba7d18d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117c4e490>]}
[0m18:57:43.280769 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc55e98b-00dc-4009-b29c-e802fba7d18d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x104ef7bb0>]}
[0m18:57:43.281593 [info ] [Thread-3  ]: 3 of 5 OK created sql view model ecommerce_data_raw_staging.stg_sales .......... [[32mCREATE VIEW (0 processed)[0m in 1.38s]
[0m18:57:43.282197 [info ] [Thread-2  ]: 2 of 5 OK created sql view model ecommerce_data_raw_staging.stg_customer_logs .. [[32mCREATE VIEW (0 processed)[0m in 1.39s]
[0m18:57:43.282952 [info ] [Thread-1  ]: 1 of 5 OK created sql view model ecommerce_data_raw_reporting.dim_product ...... [[32mCREATE VIEW (0 processed)[0m in 1.39s]
[0m18:57:43.283520 [debug] [Thread-3  ]: Finished running node model.ecommerce_dbt.stg_sales
[0m18:57:43.283948 [debug] [Thread-2  ]: Finished running node model.ecommerce_dbt.stg_customer_logs
[0m18:57:43.284340 [debug] [Thread-1  ]: Finished running node model.ecommerce_dbt.dim_product
[0m18:57:43.285092 [debug] [Thread-4  ]: Began running node model.ecommerce_dbt.fact_sales
[0m18:57:43.285460 [debug] [Thread-2  ]: Began running node model.ecommerce_dbt.fact_customer_activity
[0m18:57:43.285857 [info ] [Thread-4  ]: 4 of 5 START sql view model ecommerce_data_raw_reporting.fact_sales ............ [RUN]
[0m18:57:43.286446 [info ] [Thread-2  ]: 5 of 5 START sql view model ecommerce_data_raw_reporting.fact_customer_activity  [RUN]
[0m18:57:43.287023 [debug] [Thread-4  ]: Acquiring new bigquery connection 'model.ecommerce_dbt.fact_sales'
[0m18:57:43.287433 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly model.ecommerce_dbt.stg_customer_logs, now model.ecommerce_dbt.fact_customer_activity)
[0m18:57:43.287854 [debug] [Thread-4  ]: Began compiling node model.ecommerce_dbt.fact_sales
[0m18:57:43.288325 [debug] [Thread-2  ]: Began compiling node model.ecommerce_dbt.fact_customer_activity
[0m18:57:43.292229 [debug] [Thread-4  ]: Writing injected SQL for node "model.ecommerce_dbt.fact_sales"
[0m18:57:43.294756 [debug] [Thread-2  ]: Writing injected SQL for node "model.ecommerce_dbt.fact_customer_activity"
[0m18:57:43.296625 [debug] [Thread-4  ]: Began executing node model.ecommerce_dbt.fact_sales
[0m18:57:43.297087 [debug] [Thread-2  ]: Began executing node model.ecommerce_dbt.fact_customer_activity
[0m18:57:43.300779 [debug] [Thread-4  ]: Writing runtime sql for node "model.ecommerce_dbt.fact_sales"
[0m18:57:43.308009 [debug] [Thread-2  ]: Writing runtime sql for node "model.ecommerce_dbt.fact_customer_activity"
[0m18:57:43.309717 [debug] [Thread-2  ]: On model.ecommerce_dbt.fact_customer_activity: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.fact_customer_activity"} */


  create or replace view `terraform-tutorial-430708`.`ecommerce_data_raw_reporting`.`fact_customer_activity`
  OPTIONS()
  as SELECT
    user_id,
    DATE(timestamp) AS activity_date,
    COUNT(CASE WHEN event_type = 'view' THEN 1 END) AS views,
    COUNT(CASE WHEN event_type = 'clicks' THEN 1 END) AS clicks,
    COUNT(CASE WHEN event_type = 'purchases' THEN 1 END) AS purchases,
FROM `terraform-tutorial-430708`.`ecommerce_data_raw_staging`.`stg_customer_logs`
GROUP BY user_id, product_id, activity_date;


[0m18:57:43.310544 [debug] [Thread-4  ]: On model.ecommerce_dbt.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.fact_sales"} */


  create or replace view `terraform-tutorial-430708`.`ecommerce_data_raw_reporting`.`fact_sales`
  OPTIONS()
  as SELECT
    sale_date,
    product_id,
    SUM(quantity) AS total_quantity,
    SUM(quantity * price_per_unit) AS total_revenue
FROM `terraform-tutorial-430708`.`ecommerce_data_raw_staging`.`stg_sales`
GROUP BY
sale_date, product_id;


[0m18:57:43.311840 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m18:57:43.312513 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m18:57:44.029809 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=terraform-tutorial-430708&j=bq:EU:f6d90b3a-08bf-4a2b-8dde-b2b6c2147086&page=queryresults
[0m18:57:44.163662 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=terraform-tutorial-430708&j=bq:EU:fb2d4b52-9e65-4812-a44b-0d64cdf2cc40&page=queryresults
[0m18:57:44.337059 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc55e98b-00dc-4009-b29c-e802fba7d18d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1067e5be0>]}
[0m18:57:44.337631 [info ] [Thread-4  ]: 4 of 5 OK created sql view model ecommerce_data_raw_reporting.fact_sales ....... [[32mCREATE VIEW (0 processed)[0m in 1.05s]
[0m18:57:44.338088 [debug] [Thread-4  ]: Finished running node model.ecommerce_dbt.fact_sales
[0m18:57:44.441804 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'fc55e98b-00dc-4009-b29c-e802fba7d18d', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x123545a30>]}
[0m18:57:44.442502 [info ] [Thread-2  ]: 5 of 5 OK created sql view model ecommerce_data_raw_reporting.fact_customer_activity  [[32mCREATE VIEW (0 processed)[0m in 1.15s]
[0m18:57:44.442962 [debug] [Thread-2  ]: Finished running node model.ecommerce_dbt.fact_customer_activity
[0m18:57:44.444706 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m18:57:44.445846 [debug] [MainThread]: Connection 'master' was properly closed.
[0m18:57:44.446326 [debug] [MainThread]: Connection 'model.ecommerce_dbt.dim_product' was properly closed.
[0m18:57:44.446723 [debug] [MainThread]: Connection 'model.ecommerce_dbt.fact_customer_activity' was properly closed.
[0m18:57:44.447100 [debug] [MainThread]: Connection 'model.ecommerce_dbt.stg_sales' was properly closed.
[0m18:57:44.447466 [debug] [MainThread]: Connection 'model.ecommerce_dbt.fact_sales' was properly closed.
[0m18:57:44.447989 [info ] [MainThread]: 
[0m18:57:44.448506 [info ] [MainThread]: Finished running 5 view models in 0 hours 0 minutes and 5.02 seconds (5.02s).
[0m18:57:44.450204 [debug] [MainThread]: Command end result
[0m18:57:44.475412 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jandytenedora/Interview/python-interview-gpt-question/dbt/ecommerce_dbt/target/manifest.json
[0m18:57:44.477855 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jandytenedora/Interview/python-interview-gpt-question/dbt/ecommerce_dbt/target/semantic_manifest.json
[0m18:57:44.484001 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/jandytenedora/Interview/python-interview-gpt-question/dbt/ecommerce_dbt/target/run_results.json
[0m18:57:44.484348 [info ] [MainThread]: 
[0m18:57:44.484708 [info ] [MainThread]: [32mCompleted successfully[0m
[0m18:57:44.484942 [info ] [MainThread]: 
[0m18:57:44.485217 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m18:57:44.487069 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 6.4467864, "process_in_blocks": "0", "process_kernel_time": 0.39097, "process_mem_max_rss": "187858944", "process_out_blocks": "0", "process_user_time": 2.099809}
[0m18:57:44.487562 [debug] [MainThread]: Command `dbt run` succeeded at 18:57:44.487480 after 6.45 seconds
[0m18:57:44.487908 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1079f9f10>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117728ac0>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x117b8a5b0>]}
[0m18:57:44.488208 [debug] [MainThread]: Flushing usage events
[0m18:57:45.166350 [debug] [MainThread]: An error was encountered while trying to flush usage events
[0m19:02:59.042840 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'start', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065f3040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107699e20>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1076991f0>]}


============================== 19:02:59.047091 | d38e4cca-397e-4148-a8e7-6414f05221ca ==============================
[0m19:02:59.047091 [info ] [MainThread]: Running with dbt=1.9.1
[0m19:02:59.047681 [debug] [MainThread]: running dbt with arguments {'printer_width': '80', 'indirect_selection': 'eager', 'log_cache_events': 'False', 'write_json': 'True', 'partial_parse': 'True', 'cache_selected_only': 'False', 'warn_error': 'None', 'debug': 'False', 'fail_fast': 'False', 'log_path': '/Users/jandytenedora/Interview/python-interview-gpt-question/dbt/ecommerce_dbt/logs', 'profiles_dir': '/Users/jandytenedora/.dbt', 'version_check': 'True', 'use_colors': 'True', 'use_experimental_parser': 'False', 'empty': 'False', 'quiet': 'False', 'no_print': 'None', 'log_format': 'default', 'introspect': 'True', 'static_parser': 'True', 'invocation_command': 'dbt run', 'target_path': 'None', 'warn_error_options': 'WarnErrorOptions(include=[], exclude=[])', 'send_anonymous_usage_stats': 'True'}
[0m19:03:00.460798 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'project_id', 'label': 'd38e4cca-397e-4148-a8e7-6414f05221ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1186f0040>]}
[0m19:03:00.515820 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'adapter_info', 'label': 'd38e4cca-397e-4148-a8e7-6414f05221ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1186f0610>]}
[0m19:03:00.516421 [info ] [MainThread]: Registered adapter: bigquery=1.9.1
[0m19:03:00.640281 [debug] [MainThread]: checksum: 5e8d1596cf4eae33c11286bbb248a722d21b9f00d8a7ced8137c642517055418, vars: {}, profile: , target: , version: 1.9.1
[0m19:03:00.806757 [info ] [MainThread]: Unable to do partial parsing because a project config has changed
[0m19:03:00.807163 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'partial_parser', 'label': 'd38e4cca-397e-4148-a8e7-6414f05221ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1071324c0>]}
[0m19:03:01.791052 [warn ] [MainThread]: [[33mWARNING[0m]: Did not find matching node for patch with name 'dim_products' in the 'models' section of file 'models/marts/schema.yml'
[0m19:03:01.872443 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.ecommerce_dbt.not_null_dim_products_product_id.c8aba288d1' (models/marts/schema.yml) depends on a node named 'dim_products' in package '' which was not found
[0m19:03:01.872893 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.ecommerce_dbt.unique_dim_products_product_id.ef7b2a9985' (models/marts/schema.yml) depends on a node named 'dim_products' in package '' which was not found
[0m19:03:01.873160 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.ecommerce_dbt.not_null_dim_products_product_name.991aec73f3' (models/marts/schema.yml) depends on a node named 'dim_products' in package '' which was not found
[0m19:03:01.873414 [warn ] [MainThread]: [[33mWARNING[0m]: Test 'test.ecommerce_dbt.not_null_dim_products_price.93519fc0ed' (models/marts/schema.yml) depends on a node named 'dim_products' in package '' which was not found
[0m19:03:01.971526 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'load_project', 'label': 'd38e4cca-397e-4148-a8e7-6414f05221ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1192b6130>]}
[0m19:03:02.054181 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jandytenedora/Interview/python-interview-gpt-question/dbt/ecommerce_dbt/target/manifest.json
[0m19:03:02.057315 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jandytenedora/Interview/python-interview-gpt-question/dbt/ecommerce_dbt/target/semantic_manifest.json
[0m19:03:02.071702 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'resource_counts', 'label': 'd38e4cca-397e-4148-a8e7-6414f05221ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119397a60>]}
[0m19:03:02.072155 [info ] [MainThread]: Found 5 models, 6 data tests, 3 sources, 489 macros
[0m19:03:02.072421 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd38e4cca-397e-4148-a8e7-6414f05221ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118163c40>]}
[0m19:03:02.073608 [info ] [MainThread]: 
[0m19:03:02.073886 [info ] [MainThread]: Concurrency: 4 threads (target='dev')
[0m19:03:02.074098 [info ] [MainThread]: 
[0m19:03:02.074453 [debug] [MainThread]: Acquiring new bigquery connection 'master'
[0m19:03:02.078126 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_terraform-tutorial-430708'
[0m19:03:02.078672 [debug] [ThreadPool]: Acquiring new bigquery connection 'list_terraform-tutorial-430708'
[0m19:03:02.079023 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:03:02.079354 [debug] [ThreadPool]: Opening a new connection, currently in state init
[0m19:03:04.892929 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_terraform-tutorial-430708, now list_terraform-tutorial-430708_ecommerce_data_raw_reporting)
[0m19:03:04.894331 [debug] [ThreadPool]: Re-using an available connection from the pool (formerly list_terraform-tutorial-430708, now list_terraform-tutorial-430708_ecommerce_data_raw_staging)
[0m19:03:04.895004 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:03:04.895548 [debug] [ThreadPool]: Opening a new connection, currently in state closed
[0m19:03:05.564281 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'runnable_timing', 'label': 'd38e4cca-397e-4148-a8e7-6414f05221ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118d27880>]}
[0m19:03:05.565249 [debug] [MainThread]: Opening a new connection, currently in state init
[0m19:03:05.567899 [debug] [Thread-1  ]: Began running node model.ecommerce_dbt.dim_product
[0m19:03:05.568475 [debug] [Thread-2  ]: Began running node model.ecommerce_dbt.stg_customer_logs
[0m19:03:05.569553 [debug] [Thread-3  ]: Began running node model.ecommerce_dbt.stg_sales
[0m19:03:05.569140 [info ] [Thread-1  ]: 1 of 5 START sql table model ecommerce_data_raw_reporting.dim_product .......... [RUN]
[0m19:03:05.570229 [info ] [Thread-2  ]: 2 of 5 START sql table model ecommerce_data_raw_staging.stg_customer_logs ...... [RUN]
[0m19:03:05.570817 [info ] [Thread-3  ]: 3 of 5 START sql table model ecommerce_data_raw_staging.stg_sales .............. [RUN]
[0m19:03:05.571372 [debug] [Thread-1  ]: Re-using an available connection from the pool (formerly list_terraform-tutorial-430708_ecommerce_data_raw_reporting, now model.ecommerce_dbt.dim_product)
[0m19:03:05.571833 [debug] [Thread-2  ]: Re-using an available connection from the pool (formerly list_terraform-tutorial-430708_ecommerce_data_raw_staging, now model.ecommerce_dbt.stg_customer_logs)
[0m19:03:05.572363 [debug] [Thread-3  ]: Acquiring new bigquery connection 'model.ecommerce_dbt.stg_sales'
[0m19:03:05.572791 [debug] [Thread-1  ]: Began compiling node model.ecommerce_dbt.dim_product
[0m19:03:05.573172 [debug] [Thread-2  ]: Began compiling node model.ecommerce_dbt.stg_customer_logs
[0m19:03:05.573546 [debug] [Thread-3  ]: Began compiling node model.ecommerce_dbt.stg_sales
[0m19:03:05.584598 [debug] [Thread-1  ]: Writing injected SQL for node "model.ecommerce_dbt.dim_product"
[0m19:03:05.587596 [debug] [Thread-2  ]: Writing injected SQL for node "model.ecommerce_dbt.stg_customer_logs"
[0m19:03:05.590221 [debug] [Thread-3  ]: Writing injected SQL for node "model.ecommerce_dbt.stg_sales"
[0m19:03:05.592346 [debug] [Thread-1  ]: Began executing node model.ecommerce_dbt.dim_product
[0m19:03:05.592744 [debug] [Thread-3  ]: Began executing node model.ecommerce_dbt.stg_sales
[0m19:03:05.653017 [debug] [Thread-2  ]: Began executing node model.ecommerce_dbt.stg_customer_logs
[0m19:03:05.670945 [debug] [Thread-1  ]: Opening a new connection, currently in state closed
[0m19:03:05.673372 [debug] [Thread-3  ]: Opening a new connection, currently in state init
[0m19:03:05.675449 [debug] [Thread-2  ]: Opening a new connection, currently in state closed
[0m19:03:06.354123 [debug] [Thread-3  ]: Writing runtime sql for node "model.ecommerce_dbt.stg_sales"
[0m19:03:06.355374 [debug] [Thread-2  ]: Writing runtime sql for node "model.ecommerce_dbt.stg_customer_logs"
[0m19:03:06.356404 [debug] [Thread-2  ]: On model.ecommerce_dbt.stg_customer_logs: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.stg_customer_logs"} */

  
    

    create or replace table `terraform-tutorial-430708`.`ecommerce_data_raw_staging`.`stg_customer_logs`
      
    
    

    OPTIONS()
    as (
      WITH cleaned_customer_logs AS (
    SELECT
        timestamp,
        user_id,
        event_type,
        product_id
    FROM `terraform-tutorial-430708`.`ecommerce_data_raw`.`customer_logs`
    WHERE user_id IS NOT NULL
)
SELECT * FROM cleaned_customer_logs
    );
  
[0m19:03:06.356781 [debug] [Thread-3  ]: On model.ecommerce_dbt.stg_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.stg_sales"} */

  
    

    create or replace table `terraform-tutorial-430708`.`ecommerce_data_raw_staging`.`stg_sales`
      
    
    

    OPTIONS()
    as (
      WITH cleaned_sales AS (
    SELECT
        transaction_id,
        product_id,
        sale_date,
        quantity,
        price_per_unit
    FROM `terraform-tutorial-430708`.`ecommerce_data_raw`.`raw_sales_data`
    WHERE sale_date IS NOT NULL
)
SELECT * FROM cleaned_sales
    );
  
[0m19:03:06.385689 [debug] [Thread-1  ]: Writing runtime sql for node "model.ecommerce_dbt.dim_product"
[0m19:03:06.386525 [debug] [Thread-1  ]: On model.ecommerce_dbt.dim_product: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.dim_product"} */

  
    

    create or replace table `terraform-tutorial-430708`.`ecommerce_data_raw_reporting`.`dim_product`
      
    
    

    OPTIONS()
    as (
      SELECT
    product_id,
    category,
    device
FROM `terraform-tutorial-430708`.`ecommerce_data_raw`.`product_catalog`
    );
  
[0m19:03:06.828524 [debug] [Thread-2  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=terraform-tutorial-430708&j=bq:EU:aafe066c-aa7a-473f-bcb3-fb9302152cb2&page=queryresults
[0m19:03:06.846003 [debug] [Thread-1  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=terraform-tutorial-430708&j=bq:EU:cbbcf51d-9faa-4ae5-a293-435286499540&page=queryresults
[0m19:03:06.872873 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=terraform-tutorial-430708&j=bq:EU:45d11664-3b87-4547-b7ec-afaad90f0841&page=queryresults
[0m19:03:09.696107 [debug] [Thread-1  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd38e4cca-397e-4148-a8e7-6414f05221ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119349100>]}
[0m19:03:09.696532 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd38e4cca-397e-4148-a8e7-6414f05221ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118163c40>]}
[0m19:03:09.697177 [info ] [Thread-1  ]: 1 of 5 OK created sql table model ecommerce_data_raw_reporting.dim_product ..... [[32mCREATE TABLE (15.0k rows, 385.4 KiB processed)[0m in 4.12s]
[0m19:03:09.697812 [info ] [Thread-3  ]: 3 of 5 OK created sql table model ecommerce_data_raw_staging.stg_sales ......... [[32mCREATE TABLE (40.0k rows, 1.5 MiB processed)[0m in 4.12s]
[0m19:03:09.698459 [debug] [Thread-1  ]: Finished running node model.ecommerce_dbt.dim_product
[0m19:03:09.698891 [debug] [Thread-3  ]: Finished running node model.ecommerce_dbt.stg_sales
[0m19:03:09.699520 [debug] [Thread-4  ]: Began running node model.ecommerce_dbt.fact_sales
[0m19:03:09.700009 [info ] [Thread-4  ]: 4 of 5 START sql table model ecommerce_data_raw_reporting.fact_sales ........... [RUN]
[0m19:03:09.700477 [debug] [Thread-4  ]: Acquiring new bigquery connection 'model.ecommerce_dbt.fact_sales'
[0m19:03:09.700780 [debug] [Thread-4  ]: Began compiling node model.ecommerce_dbt.fact_sales
[0m19:03:09.703752 [debug] [Thread-4  ]: Writing injected SQL for node "model.ecommerce_dbt.fact_sales"
[0m19:03:09.704751 [debug] [Thread-4  ]: Began executing node model.ecommerce_dbt.fact_sales
[0m19:03:09.706937 [debug] [Thread-4  ]: Opening a new connection, currently in state init
[0m19:03:09.779062 [debug] [Thread-2  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd38e4cca-397e-4148-a8e7-6414f05221ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118da9700>]}
[0m19:03:09.779787 [info ] [Thread-2  ]: 2 of 5 OK created sql table model ecommerce_data_raw_staging.stg_customer_logs . [[32mCREATE TABLE (25.0k rows, 724.8 KiB processed)[0m in 4.21s]
[0m19:03:09.780328 [debug] [Thread-2  ]: Finished running node model.ecommerce_dbt.stg_customer_logs
[0m19:03:09.780858 [debug] [Thread-3  ]: Began running node model.ecommerce_dbt.fact_customer_activity
[0m19:03:09.781287 [info ] [Thread-3  ]: 5 of 5 START sql table model ecommerce_data_raw_reporting.fact_customer_activity  [RUN]
[0m19:03:09.781673 [debug] [Thread-3  ]: Re-using an available connection from the pool (formerly model.ecommerce_dbt.stg_sales, now model.ecommerce_dbt.fact_customer_activity)
[0m19:03:09.781991 [debug] [Thread-3  ]: Began compiling node model.ecommerce_dbt.fact_customer_activity
[0m19:03:09.785199 [debug] [Thread-3  ]: Writing injected SQL for node "model.ecommerce_dbt.fact_customer_activity"
[0m19:03:09.786989 [debug] [Thread-3  ]: Began executing node model.ecommerce_dbt.fact_customer_activity
[0m19:03:09.789300 [debug] [Thread-3  ]: Opening a new connection, currently in state closed
[0m19:03:10.866946 [debug] [Thread-3  ]: Writing runtime sql for node "model.ecommerce_dbt.fact_customer_activity"
[0m19:03:10.868474 [debug] [Thread-3  ]: On model.ecommerce_dbt.fact_customer_activity: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.fact_customer_activity"} */

  
    

    create or replace table `terraform-tutorial-430708`.`ecommerce_data_raw_reporting`.`fact_customer_activity`
      
    
    

    OPTIONS()
    as (
      SELECT
    user_id,
    DATE(timestamp) AS activity_date,
    COUNT(CASE WHEN event_type = 'view' THEN 1 END) AS views,
    COUNT(CASE WHEN event_type = 'clicks' THEN 1 END) AS clicks,
    COUNT(CASE WHEN event_type = 'purchases' THEN 1 END) AS purchases,
FROM `terraform-tutorial-430708`.`ecommerce_data_raw_staging`.`stg_customer_logs`
GROUP BY user_id, product_id, activity_date
    );
  
[0m19:03:10.890593 [debug] [Thread-4  ]: Writing runtime sql for node "model.ecommerce_dbt.fact_sales"
[0m19:03:10.891580 [debug] [Thread-4  ]: On model.ecommerce_dbt.fact_sales: /* {"app": "dbt", "dbt_version": "1.9.1", "profile_name": "ecommerce_dbt", "target_name": "dev", "node_id": "model.ecommerce_dbt.fact_sales"} */

  
    

    create or replace table `terraform-tutorial-430708`.`ecommerce_data_raw_reporting`.`fact_sales`
      
    
    

    OPTIONS()
    as (
      SELECT
    sale_date,
    product_id,
    SUM(quantity) AS total_quantity,
    SUM(quantity * price_per_unit) AS total_revenue
FROM `terraform-tutorial-430708`.`ecommerce_data_raw_staging`.`stg_sales`
GROUP BY
sale_date, product_id
    );
  
[0m19:03:11.702434 [debug] [Thread-3  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=terraform-tutorial-430708&j=bq:EU:1843d6ca-c04e-400a-87a8-0a624b70a8c4&page=queryresults
[0m19:03:11.703735 [debug] [Thread-4  ]: BigQuery adapter: https://console.cloud.google.com/bigquery?project=terraform-tutorial-430708&j=bq:EU:e370db04-1732-46e5-8ac0-95a6a9dd96be&page=queryresults
[0m19:03:14.186931 [debug] [Thread-4  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd38e4cca-397e-4148-a8e7-6414f05221ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x118fc9fd0>]}
[0m19:03:14.188475 [info ] [Thread-4  ]: 4 of 5 OK created sql table model ecommerce_data_raw_reporting.fact_sales ...... [[32mCREATE TABLE (341.0 rows, 1.2 MiB processed)[0m in 4.49s]
[0m19:03:14.189533 [debug] [Thread-4  ]: Finished running node model.ecommerce_dbt.fact_sales
[0m19:03:14.353595 [debug] [Thread-3  ]: Sending event: {'category': 'dbt', 'action': 'run_model', 'label': 'd38e4cca-397e-4148-a8e7-6414f05221ca', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x119401df0>]}
[0m19:03:14.354600 [info ] [Thread-3  ]: 5 of 5 OK created sql table model ecommerce_data_raw_reporting.fact_customer_activity  [[32mCREATE TABLE (4.7k rows, 724.8 KiB processed)[0m in 4.57s]
[0m19:03:14.355287 [debug] [Thread-3  ]: Finished running node model.ecommerce_dbt.fact_customer_activity
[0m19:03:14.356652 [debug] [MainThread]: Opening a new connection, currently in state closed
[0m19:03:14.357393 [debug] [MainThread]: Connection 'master' was properly closed.
[0m19:03:14.357755 [debug] [MainThread]: Connection 'model.ecommerce_dbt.dim_product' was properly closed.
[0m19:03:14.358085 [debug] [MainThread]: Connection 'model.ecommerce_dbt.stg_customer_logs' was properly closed.
[0m19:03:14.358414 [debug] [MainThread]: Connection 'model.ecommerce_dbt.fact_customer_activity' was properly closed.
[0m19:03:14.358718 [debug] [MainThread]: Connection 'model.ecommerce_dbt.fact_sales' was properly closed.
[0m19:03:14.359156 [info ] [MainThread]: 
[0m19:03:14.359524 [info ] [MainThread]: Finished running 5 table models in 0 hours 0 minutes and 12.28 seconds (12.28s).
[0m19:03:14.360964 [debug] [MainThread]: Command end result
[0m19:03:14.390550 [debug] [MainThread]: Wrote artifact WritableManifest to /Users/jandytenedora/Interview/python-interview-gpt-question/dbt/ecommerce_dbt/target/manifest.json
[0m19:03:14.391941 [debug] [MainThread]: Wrote artifact SemanticManifest to /Users/jandytenedora/Interview/python-interview-gpt-question/dbt/ecommerce_dbt/target/semantic_manifest.json
[0m19:03:14.397022 [debug] [MainThread]: Wrote artifact RunExecutionResult to /Users/jandytenedora/Interview/python-interview-gpt-question/dbt/ecommerce_dbt/target/run_results.json
[0m19:03:14.397284 [info ] [MainThread]: 
[0m19:03:14.397581 [info ] [MainThread]: [32mCompleted successfully[0m
[0m19:03:14.397810 [info ] [MainThread]: 
[0m19:03:14.398051 [info ] [MainThread]: Done. PASS=5 WARN=0 ERROR=0 SKIP=0 TOTAL=5
[0m19:03:14.399503 [debug] [MainThread]: Resource report: {"command_name": "run", "command_success": true, "command_wall_clock_time": 15.410845, "process_in_blocks": "0", "process_kernel_time": 0.464545, "process_mem_max_rss": "194969600", "process_out_blocks": "0", "process_user_time": 3.328622}
[0m19:03:14.399827 [debug] [MainThread]: Command `dbt run` succeeded at 19:03:14.399761 after 15.41 seconds
[0m19:03:14.400114 [debug] [MainThread]: Sending event: {'category': 'dbt', 'action': 'invocation', 'label': 'end', 'context': [<snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x1065f3040>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x11900e850>, <snowplow_tracker.self_describing_json.SelfDescribingJson object at 0x107109370>]}
[0m19:03:14.400395 [debug] [MainThread]: Flushing usage events
[0m19:03:15.635756 [debug] [MainThread]: An error was encountered while trying to flush usage events
